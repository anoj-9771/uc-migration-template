{"source":2,"revision":5,"description":null,"createdBy":{"displayName":"Willem Van Aswegen","url":"https://spsprodeau1.vssps.visualstudio.com/Ab7cd627d-f32f-49e7-9c5a-1af48013664e/_apis/Identities/64ca43af-eba1-6a80-926e-c90828da18e6","_links":{"avatar":{"href":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"}},"id":"64ca43af-eba1-6a80-926e-c90828da18e6","uniqueName":"Willem.VanAswegen@venueswest.wa.gov.au","imageUrl":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2","descriptor":"aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"},"createdOn":"2019-10-03T00:49:57.243Z","modifiedBy":{"displayName":"Saad Khatib","url":"https://spsprodeau1.vssps.visualstudio.com/Ab7cd627d-f32f-49e7-9c5a-1af48013664e/_apis/Identities/e6791701-281d-695b-8644-a4c9a726e01d","_links":{"avatar":{"href":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.ZTY3OTE3MDEtMjgxZC03OTViLTg2NDQtYTRjOWE3MjZlMDFk"}},"id":"e6791701-281d-695b-8644-a4c9a726e01d","uniqueName":"Saad.Khatib@venueswest.wa.gov.au","imageUrl":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.ZTY3OTE3MDEtMjgxZC03OTViLTg2NDQtYTRjOWE3MjZlMDFk","descriptor":"aad.ZTY3OTE3MDEtMjgxZC03OTViLTg2NDQtYTRjOWE3MjZlMDFk"},"modifiedOn":"2019-10-13T04:12:35.007Z","isDeleted":false,"lastRelease":{"id":199,"name":"Release-16","artifacts":[],"_links":{},"description":"Triggered by VW-DataPlatform-Databricks 20191023.1.","releaseDefinition":{"id":6,"projectReference":null,"_links":{}},"createdOn":"2019-10-23T03:06:31.550Z","createdBy":{"displayName":"Willem Van Aswegen","url":"https://spsprodeau1.vssps.visualstudio.com/Ab7cd627d-f32f-49e7-9c5a-1af48013664e/_apis/Identities/64ca43af-eba1-6a80-926e-c90828da18e6","_links":{"avatar":{"href":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"}},"id":"64ca43af-eba1-6a80-926e-c90828da18e6","uniqueName":"Willem.VanAswegen@venueswest.wa.gov.au","imageUrl":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2","descriptor":"aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"}},"variables":{},"variableGroups":[2],"environments":[{"id":10,"name":"NPE","rank":1,"owner":{"displayName":"Willem Van Aswegen","url":"https://spsprodeau1.vssps.visualstudio.com/Ab7cd627d-f32f-49e7-9c5a-1af48013664e/_apis/Identities/64ca43af-eba1-6a80-926e-c90828da18e6","_links":{"avatar":{"href":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"}},"id":"64ca43af-eba1-6a80-926e-c90828da18e6","uniqueName":"Willem.VanAswegen@venueswest.wa.gov.au","imageUrl":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2","descriptor":"aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"},"variables":{},"variableGroups":[1],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":38}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":39},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":40}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"ubuntu-16.04"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"33c63b11-352b-45a2-ba1b-54cb568a29ca","version":"0.*","name":"Use Python 3.x","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"versionSpec":"3.x","addToPath":"true","architecture":"x64"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Install Tools","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"python -m pip install --upgrade pip setuptools wheel databricks-cli","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Authenticate with Databricks CLI","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks configure --token <<EOF\nhttps://$(location).azuredatabricks.net\n$(databricks-token-npe)\nEOF\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Remove Notebooks in /build","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks workspace mkdirs /build/Util;\ndatabricks workspace mkdirs /build/DataProcessing;\n\ndatabricks workspace rm -r /build/Util;\ndatabricks workspace rm -r /build/DataProcessing;\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Upload Notebooks to Databricks","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks workspace mkdirs /build/Util;\ndatabricks workspace mkdirs /build/DataProcessing;\n\nfor filename in _Databricks/notebook/*-dp.py; \ndo\n    databricks workspace import --language PYTHON --format SOURCE --overwrite \"${filename}\" \"/build/DataProcessing/${filename##*/}\"\ndone;\nfor filename in _Databricks/notebook/*-dp.scala; \ndo\n    databricks workspace import --language SCALA --format SOURCE --overwrite \"${filename}\" \"/build/DataProcessing/${filename##*/}\"\ndone;\n\nfor filename in _Databricks/notebook/*-ut.py; \ndo\n    databricks workspace import --language PYTHON --format SOURCE --overwrite \"${filename}\" \"/build/Util/${filename##*/}\"\ndone;\nfor filename in _Databricks/notebook/*-ut.scala; \ndo\n    databricks workspace import --language SCALA --format SOURCE --overwrite \"${filename}\" \"/build/Util/${filename##*/}\"\ndone;\n\necho","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""},{"name":"_Databricks","conditionType":4,"value":"{\"sourceBranch\":\"develop\",\"tags\":[],\"useBuildDefinitionBranch\":false,\"createReleaseOnBuildTagging\":false}"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":199,"url":"https://vsrm.dev.azure.com/vwteams/ee9649e8-55df-43be-9496-9289141d27c4/_apis/Release/releases/199","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/vwteams/_apis/public/Release/badge/ee9649e8-55df-43be-9496-9289141d27c4/6/10"},{"id":16,"name":"PRD","rank":2,"owner":{"displayName":"Willem Van Aswegen","url":"https://spsprodeau1.vssps.visualstudio.com/Ab7cd627d-f32f-49e7-9c5a-1af48013664e/_apis/Identities/64ca43af-eba1-6a80-926e-c90828da18e6","_links":{"avatar":{"href":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"}},"id":"64ca43af-eba1-6a80-926e-c90828da18e6","uniqueName":"Willem.VanAswegen@venueswest.wa.gov.au","imageUrl":"https://dev.azure.com/vwteams/_apis/GraphProfile/MemberAvatars/aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2","descriptor":"aad.NjRjYTQzYWYtZWJhMS03YTgwLTkyNmUtYzkwODI4ZGExOGU2"},"variables":{},"variableGroups":[3],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":56}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":57},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":58}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"ubuntu-16.04"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"33c63b11-352b-45a2-ba1b-54cb568a29ca","version":"0.*","name":"Use Python 3.x","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"versionSpec":"3.x","addToPath":"true","architecture":"x64"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Install Tools","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"python -m pip install --upgrade pip setuptools wheel databricks-cli","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Authenticate with Databricks CLI","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks configure --token <<EOF\nhttps://$(location).azuredatabricks.net\n$(databricks-token-prd)\nEOF\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Remove Notebooks in /build","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks workspace mkdirs /build/Util;\ndatabricks workspace mkdirs /build/DataProcessing;\n\ndatabricks workspace rm -r /build/Util;\ndatabricks workspace rm -r /build/DataProcessing;\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Upload Notebooks to Databricks","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"databricks workspace mkdirs /build/Util;\ndatabricks workspace mkdirs /build/DataProcessing;\n\nfor filename in _Databricks/notebook/*-dp.py; \ndo\n    databricks workspace import --language PYTHON --format SOURCE --overwrite \"${filename}\" \"/build/DataProcessing/${filename##*/}\"\ndone;\nfor filename in _Databricks/notebook/*-dp.scala; \ndo\n    databricks workspace import --language SCALA --format SOURCE --overwrite \"${filename}\" \"/build/DataProcessing/${filename##*/}\"\ndone;\n\nfor filename in _Databricks/notebook/*-ut.py; \ndo\n    databricks workspace import --language PYTHON --format SOURCE --overwrite \"${filename}\" \"/build/Util/${filename##*/}\"\ndone;\nfor filename in _Databricks/notebook/*-ut.scala; \ndo\n    databricks workspace import --language SCALA --format SOURCE --overwrite \"${filename}\" \"/build/Util/${filename##*/}\"\ndone;\n\necho","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""},{"name":"_Databricks","conditionType":4,"value":"{\"sourceBranch\":\"master\",\"tags\":[],\"useBuildDefinitionBranch\":false,\"createReleaseOnBuildTagging\":false}"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":197,"url":"https://vsrm.dev.azure.com/vwteams/ee9649e8-55df-43be-9496-9289141d27c4/_apis/Release/releases/197","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"BoardsEnvironmentType":{"$type":"System.String","$value":"unmapped"},"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/vwteams/_apis/public/Release/badge/ee9649e8-55df-43be-9496-9289141d27c4/6/16"}],"artifacts":[{"sourceId":"ee9649e8-55df-43be-9496-9289141d27c4:14","type":"Build","alias":"_Databricks","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://dev.azure.com/vwteams/_permalink/_build/index?collectionId=5e66b444-edc4-4c4c-bd1e-bb7fbd8b1424&projectId=ee9649e8-55df-43be-9496-9289141d27c4&definitionId=14","name":""},"defaultVersionBranch":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionTags":{"id":"","name":""},"defaultVersionType":{"id":"latestType","name":"Latest"},"definition":{"id":"14","name":"VW-DataPlatform-Databricks"},"definitions":{"id":"","name":""},"IsMultiDefinitionType":{"id":"False","name":"False"},"project":{"id":"ee9649e8-55df-43be-9496-9289141d27c4","name":"VenuesWest"},"repository":{"id":"","name":""}},"isPrimary":true,"isRetained":false}],"triggers":[{"artifactAlias":"_Databricks","triggerConditions":[{"sourceBranch":"develop","tags":[],"tagFilter":null,"useBuildDefinitionBranch":false,"createReleaseOnBuildTagging":false},{"sourceBranch":"master","tags":[],"tagFilter":null,"useBuildDefinitionBranch":false,"createReleaseOnBuildTagging":false}],"triggerType":1}],"releaseNameFormat":"Release-$(rev:r)","tags":[],"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"ReleaseNew"},"IntegrateJiraWorkItems":{"$type":"System.String","$value":"false"},"IntegrateBoardsWorkItems":{"$type":"System.String","$value":"False"}},"id":6,"name":"ADS Databricks_CD","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/vwteams/ee9649e8-55df-43be-9496-9289141d27c4/_apis/Release/definitions/6","_links":{"self":{"href":"https://vsrm.dev.azure.com/vwteams/ee9649e8-55df-43be-9496-9289141d27c4/_apis/Release/definitions/6"},"web":{"href":"https://dev.azure.com/vwteams/ee9649e8-55df-43be-9496-9289141d27c4/_release?definitionId=6"}}}