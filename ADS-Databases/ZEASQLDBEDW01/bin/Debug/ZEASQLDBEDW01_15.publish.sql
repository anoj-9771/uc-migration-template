/*
Deployment script for ZEASQLDBEDW01

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "ZEASQLDBEDW01"
:setvar DefaultFilePrefix "ZEASQLDBEDW01"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (QUERY_CAPTURE_MODE = ALL, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367), MAX_STORAGE_SIZE_MB = 100) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE = OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
PRINT N'Creating Schema [banking]...';


GO
CREATE SCHEMA [banking]
    AUTHORIZATION [dbo];


GO
PRINT N'Creating Schema [qsu]...';


GO
CREATE SCHEMA [qsu]
    AUTHORIZATION [dbo];


GO
PRINT N'Creating Schema [taleo]...';


GO
CREATE SCHEMA [taleo]
    AUTHORIZATION [dbo];


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_ATTAINMENTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [DATE_AWARDED] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [DATE_CONFERRED] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPIRY_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPORTED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPORTED_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [DATE_PRINTED] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [FEE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INTERNAL_INVOICE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INV_RUN_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [TRANSACTION_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [Z_READ_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INTERNAL_INVOICE_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_OFFERED] NUMERIC (7, 3) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_USED] NUMERIC (7, 3) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [COMMITMENT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [COOLING_OFF_PERIOD_END] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [DATE_ECAF_RECEIVED] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [DATE_OFFER_MADE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [LAST_AUTO_COMPLETION_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [PROGRESS_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [RECORD_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_COMMITMENT_EXPIRY_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_EXPORT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUP_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_USED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_COMMITMENT_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_EXPORT_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [AIM_END] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [AIM_START] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [END_POINT_ASSESSMENT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [ESF_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_EXPIRY_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [NVQ_ACHIEVE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [ORIG_LEARN_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [PLANNED_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [ACTUAL_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [ACTUAL_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [PLANNED_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [PLANNED_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [ENDDATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [REISSUED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [STARTDATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_SLOTS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [BOOKABLE_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FEE_DUE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_ACTIVE_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_END_TIME] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_FINISHED_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_MIN_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_NON_STARTER_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_START_TIME] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_TRANSFERRED_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_TRIGGER_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FES_WITHDRAWN_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [FULLY_REFUNDED_WITHDRAWAL_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [PAYMENT_DUE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [PLACES_BOOKED] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [QUAL_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [QUAL_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [RE_ROLL_FORWARD_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [SELECTION_CLOSING_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [SELECTION_OPENING_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [SUP_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [TARGET_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [TOTAL_PLACES] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [TOTAL_PLACES_APPS] NUMERIC (6) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [VERSION_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [VFH_ADMIN_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [VFH_CENSUS_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [PAYMENT_DUE_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [tsEChecklist].[ChecklistActions]...';


GO
ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [DOB] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [LastName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [VTO] ADD MASKED WITH (FUNCTION = 'default()');


GO
ALTER TABLE [tsEChecklist].[ChecklistActions]
    ADD [Year]  NVARCHAR (MAX) NULL,
        [Month] NVARCHAR (MAX) NULL,
        [Day]   NVARCHAR (MAX) NULL;


GO
PRINT N'Altering Table [tsEChecklist].[ChecklistActionsInvalidRecords]...';


GO
ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [DOB] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [LastName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [VTO] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Creating Table [dbo].[Configuration]...';


GO
CREATE TABLE [dbo].[Configuration] (
    [ConfigurationId]   INT             NOT NULL,
    [ProjectName]       VARCHAR (50)    NULL,
    [ConfigurationName] VARCHAR (50)    NULL,
    [TextValue]         VARCHAR (50)    NULL,
    [NumericValue]      BIGINT          NULL,
    [DecimalValue]      DECIMAL (18, 4) NULL,
    [DateValue]         DATETIME        NULL,
    CONSTRAINT [PK_AvetmissConfiguration] PRIMARY KEY CLUSTERED ([ConfigurationId] ASC)
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_COLLEGES]...';


GO
CREATE TABLE [edw].[Prada_dbo_COLLEGES] (
    [LOCATION_CODE]           NVARCHAR (3)  NULL,
    [COLLEGE_NAME]            NVARCHAR (75) NULL,
    [POSTCODE]                NUMERIC (38)  NULL,
    [INSTITUTE]               NUMERIC (38)  NULL,
    [REGION]                  VARCHAR (30)  NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_COURSE_ENROLMENTS_CY2019_Weekly]...';


GO
CREATE TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS_CY2019_Weekly] (
    [ID_PC]                        NUMERIC (18)    NULL,
    [ID_UIO]                       NUMERIC (18)    NULL,
    [ID_CPU]                       NUMERIC (18)    NULL,
    [ID_FAC]                       NUMERIC (18)    NULL,
    [INSTITUTE]                    NUMERIC (18)    NULL,
    [CALOCC_CODE]                  VARCHAR (10)    NULL,
    [COMMITMENT_IDENTIFIER]        VARCHAR (12)    NULL,
    [DATE_OFFER_START]             DATE            NULL,
    [DATE_OFFER_END]               DATE            NULL,
    [DATE_AWARDED]                 DATE            NULL,
    [FES_MOA_CODE]                 VARCHAR (10)    NULL,
    [FES_UNIT_INSTANCE_CODE]       VARCHAR (25)    NULL,
    [FES_YEAR_ACHIEVED]            NUMERIC (18)    NULL,
    [NZ_FUNDING]                   VARCHAR (5)     NULL,
    [OFFERING_TYPE]                VARCHAR (10)    NULL,
    [PROGRESS_CODE]                VARCHAR (10)    NULL,
    [PROGRESS_REASON]              VARCHAR (60)    NULL,
    [PROGRESS_STATUS]              VARCHAR (1)     NULL,
    [YEAR_GRADUATED]               NUMERIC (18)    NULL,
    [client_id_pu]                 VARCHAR (10)    NULL,
    [delivery_loc]                 VARCHAR (10)    NULL,
    [program_id]                   VARCHAR (10)    NULL,
    [COURSE10]                     VARCHAR (10)    NULL,
    [year_award_completed]         NUMERIC (18)    NULL,
    [award_flag]                   VARCHAR (1)     NULL,
    [enrolcountpu]                 NUMERIC (18)    NULL,
    [progress_rank]                NUMERIC (18)    NULL,
    [CLIENT_ID]                    VARCHAR (10)    NULL,
    [FUNDING_NAT]                  VARCHAR (2)     NULL,
    [ENROLCOUNT]                   NUMERIC (18)    NULL,
    [validtot]                     NUMERIC (18)    NULL,
    [validunitflag]                NUMERIC (18)    NULL,
    [STARTYY]                      VARCHAR (10)    NULL,
    [ENDYY]                        VARCHAR (10)    NULL,
    [RES_COUNTRY]                  VARCHAR (50)    NULL,
    [hqual]                        NUMERIC (18)    NULL,
    [NUM]                          NUMERIC (18)    NULL,
    [AGEGRP]                       VARCHAR (17)    NULL,
    [course_code]                  VARCHAR (10)    NULL,
    [UNIT_CATEGORY]                VARCHAR (8)     NULL,
    [STATUS]                       VARCHAR (14)    NULL,
    [RAM_CATEGORY]                 VARCHAR (4)     NULL,
    [TRAINING_PACKAGE_NUM]         VARCHAR (10)    NULL,
    [PM]                           NUMERIC (18)    NULL,
    [HIGHED]                       NUMERIC (18)    NULL,
    [SL15V2FLAG]                   VARCHAR (1)     NULL,
    [AWARD]                        VARCHAR (2)     NULL,
    [AWDNM]                        VARCHAR (48)    NULL,
    [CSENM]                        VARCHAR (100)   NULL,
    [FOE4]                         VARCHAR (4)     NULL,
    [RAM]                          NUMERIC (18)    NULL,
    [ANZSCO]                       VARCHAR (6)     NULL,
    [ISC]                          VARCHAR (34)    NULL,
    [NEWCSE]                       VARCHAR (10)    NULL,
    [ORDER]                        NUMERIC (18)    NULL,
    [trnghrs]                      NUMERIC (18)    NULL,
    [rplhrs]                       NUMERIC (18)    NULL,
    [totalhrs]                     NUMERIC (18)    NULL,
    [out71hrs]                     NUMERIC (18)    NULL,
    [GRADTOT]                      NUMERIC (18)    NULL,
    [ENRFLAG]                      NUMERIC (18)    NULL,
    [ENROLMENT_YEAR]               VARCHAR (4)     NULL,
    [GRAD]                         NUMERIC (18)    NULL,
    [res_postcode]                 NUMERIC (18)    NULL,
    [RESLGA]                       NUMERIC (18)    NULL,
    [pcnam]                        VARCHAR (43)    NULL,
    [lganam]                       VARCHAR (20)    NULL,
    [FUND]                         VARCHAR (5)     NULL,
    [COREFND]                      VARCHAR (1)     NULL,
    [functional_unit]              VARCHAR (30)    NULL,
    [SKILLSLIST]                   VARCHAR (1)     NULL,
    [CITIZENSHIP]                  NUMERIC (18)    NULL,
    [apprtrainee]                  VARCHAR (1)     NULL,
    [at_school]                    VARCHAR (1)     NULL,
    [labour_force]                 VARCHAR (4)     NULL,
    [res_suburb]                   VARCHAR (50)    NULL,
    [res_state]                    VARCHAR (3)     NULL,
    [prior_ed]                     VARCHAR (1)     NULL,
    [year_commence]                NUMERIC (18)    NULL,
    [year_complete]                NUMERIC (18)    NULL,
    [month_complete]               NUMERIC (18)    NULL,
    [COMMENCE_FLAG]                VARCHAR (1)     NULL,
    [REENROL_END]                  VARCHAR (5)     NULL,
    [fee_type]                     VARCHAR (1)     NULL,
    [LOCALITY]                     VARCHAR (50)    NULL,
    [LPC]                          VARCHAR (54)    NULL,
    [SA_STATE]                     VARCHAR (3)     NULL,
    [SA2_CODE]                     VARCHAR (10)    NULL,
    [SA2_NAME]                     VARCHAR (35)    NULL,
    [LGA_CODE]                     VARCHAR (10)    NULL,
    [LGA_NAME]                     VARCHAR (35)    NULL,
    [LGA4]                         NUMERIC (18)    NULL,
    [LGANM]                        VARCHAR (35)    NULL,
    [SA4_CODE]                     NUMERIC (18)    NULL,
    [SA4_NAME]                     VARCHAR (38)    NULL,
    [SSREGION]                     VARCHAR (40)    NULL,
    [ARIA11]                       VARCHAR (25)    NULL,
    [ARIA11B]                      VARCHAR (15)    NULL,
    [REGIONAL11]                   NUMERIC (18)    NULL,
    [RIND11]                       VARCHAR (19)    NULL,
    [HQUALN]                       VARCHAR (25)    NULL,
    [SECED]                        VARCHAR (20)    NULL,
    [DELIVERY_MODE_CSE]            VARCHAR (10)    NULL,
    [AVFUND]                       NUMERIC (18)    NULL,
    [JOB]                          VARCHAR (26)    NULL,
    [STSFUND]                      VARCHAR (3)     NULL,
    [STSFUNDGROUP]                 VARCHAR (3)     NULL,
    [LOADING]                      NUMERIC (18, 2) NULL,
    [EXTRACT_DATE]                 VARCHAR (10)    NULL,
    [SL15V3FLAG]                   VARCHAR (1)     NULL,
    [ID_NCC]                       VARCHAR (25)    NULL,
    [AGE]                          NUMERIC (18)    NULL,
    [FEE_ORIGINAL]                 SMALLMONEY      NULL,
    [FEE_ACTUAL]                   SMALLMONEY      NULL,
    [FEE_PAID]                     SMALLMONEY      NULL,
    [WAIVER_CODES]                 VARCHAR (50)    NULL,
    [AWARD_DESCRIPTION]            VARCHAR (75)    NULL,
    [AWARD_ID]                     NUMERIC (18)    NULL,
    [WHO_TO_PAY]                   VARCHAR (20)    NULL,
    [FINALTOT]                     NUMERIC (18)    NULL,
    [UNITTOT]                      NUMERIC (18)    NULL,
    [FINALENROL]                   VARCHAR (3)     NULL,
    [SHELL_ENROL]                  VARCHAR (1)     NULL,
    [PROGRESS_DATE]                DATE            NULL,
    [PASSTOT]                      NUMERIC (18)    NULL,
    [FAILTOT]                      NUMERIC (18)    NULL,
    [WDRAWTOT]                     NUMERIC (18)    NULL,
    [REPORT_DATE]                  VARCHAR (10)    NULL,
    [avetcount]                    NUMERIC (18)    NULL,
    [POPULATION]                   NUMERIC (18)    NULL,
    [SCORE]                        NUMERIC (18)    NULL,
    [RANK]                         NUMERIC (18)    NULL,
    [DECILE]                       NUMERIC (18)    NULL,
    [PERCENTILE]                   NUMERIC (18)    NULL,
    [SL16V4FLAG]                   VARCHAR (1)     NULL,
    [LOAD_DATE]                    DATE            NULL,
    [MIN_CORE]                     NUMERIC (18)    NULL,
    [MIN_UOC]                      NUMERIC (18)    NULL,
    [SPONSOR_ORG_CODE]             VARCHAR (50)    NULL,
    [CTONLY]                       VARCHAR (1)     NULL,
    [RPLONLY]                      VARCHAR (1)     NULL,
    [SS_STATUS]                    VARCHAR (20)    NULL,
    [SS_SUBSIDY_AMOUNT]            SMALLMONEY      NULL,
    [SS_STANDARD_SUBSIDY_AMOUNT]   SMALLMONEY      NULL,
    [SS_LOADING_NEEDS]             SMALLMONEY      NULL,
    [SS_LOADING_LOC]               SMALLMONEY      NULL,
    [TRAINING_CONTRACT_IDENTIFIER] VARCHAR (10)    NULL,
    [SS_PROGRAM_STREAM]            VARCHAR (70)    NULL,
    [FEE_INSTALMENT]               SMALLMONEY      NULL,
    [FEE_ADJUSTMENT]               SMALLMONEY      NULL,
    [FEE_OUTSTANDING]              SMALLMONEY      NULL,
    [DATE_COMMENCE_SEMESTER]       VARCHAR (10)    NULL,
    [sem1totunit]                  NUMERIC (8)     NULL,
    [sem2totunit]                  NUMERIC (8)     NULL,
    [sem3totunit]                  NUMERIC (8)     NULL,
    [sem1totash]                   NUMERIC (8)     NULL,
    [sem2totash]                   NUMERIC (8)     NULL,
    [DELIVERY_MODE_UNIT]           VARCHAR (4)     NULL,
    [AVETMISS_FLAG]                VARCHAR (1)     NULL,
    [LTU_EVIDENCE]                 VARCHAR (1)     NULL,
    [WELFARE_STATUS]               VARCHAR (1)     NULL,
    [TOL]                          VARCHAR (1)     NULL,
    [TNW]                          VARCHAR (1)     NULL,
    [TAFE_DIGITAL]                 VARCHAR (1)     NULL,
    [STUDCTR]                      VARCHAR (1)     NULL,
    [VFH_COURSE]                   VARCHAR (1)     NULL,
    [FEE_HELP_FLAG]                VARCHAR (1)     NULL,
    [VSL_FLAG]                     VARCHAR (1)     NULL,
    [SUBSIDY_ADJUSTMENT]           NUMERIC (18)    NULL,
    [TRANSITIONED_FROM_ID]         NUMERIC (18)    NULL,
    [TRANSITIONED_FROM]            VARCHAR (20)    NULL,
    [TRANSITIONED_FROM_CALOCC]     VARCHAR (10)    NULL,
    [ORIGINAL_START_DATE]          DATE            NULL,
    [REGION]                       VARCHAR (25)    NULL,
    [OPEN]                         VARCHAR (1)     NULL,
    [OTEN]                         VARCHAR (1)     NULL,
    [overseas]                     VARCHAR (1)     NULL,
    [AWARD_STATUS]                 VARCHAR (20)    NULL,
    [FY]                           VARCHAR (1)     NULL,
    [CY]                           VARCHAR (1)     NULL,
    [SKILLSPOINT]                  VARCHAR (4)     NULL,
    [TRANSITION_FLAG]              VARCHAR (1)     NULL,
    [TRANCOUNT]                    VARCHAR (1)     NULL,
    [STUDY_REASON]                 VARCHAR (5)     NULL,
    [FUNDING_VFH]                  VARCHAR (35)    NULL,
    [WORKS_IN_NSW]                 VARCHAR (240)   NULL,
    [EMP_ALT_ORG_NAME]             VARCHAR (100)   NULL,
    [EMP_ALT_EMPLOYER_SUBURB]      VARCHAR (20)    NULL,
    [EMP_POSTCODE]                 VARCHAR (4)     NULL,
    [EMP_ORG_CODE]                 VARCHAR (30)    NULL,
    [EMP_ORG_TYPE]                 VARCHAR (100)   NULL,
    [EMPLOYER]                     VARCHAR (100)   NULL,
    [SEM]                          VARCHAR (1)     NULL,
    [ONLMTOTUNIT]                  NUMERIC (8)     NULL,
    [SBI_GROUP]                    VARCHAR (50)    NULL,
    [SBI_CATEGORY]                 VARCHAR (75)    NULL,
    [SBI_SUBCATEGORY]              VARCHAR (100)   NULL,
    [year]                         NVARCHAR (1000) NULL,
    [month]                        NVARCHAR (1000) NULL,
    [day]                          NVARCHAR (1000) NULL,
    [_DLRawZoneTimeStamp]          DATETIME        NULL,
    [_DLTrustedZoneTimeStamp]      DATETIME        NULL,
    [_RecordStart]                 DATETIME        NULL,
    [_RecordEnd]                   DATETIME        NULL,
    [_RecordDeleted]               INT             NULL,
    [_RecordCurrent]               INT             NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_CURRENT_COURSE_MAPPING2]...';


GO
CREATE TABLE [edw].[Prada_dbo_CURRENT_COURSE_MAPPING2] (
    [NATIONAL_COURSE_CODE]    VARCHAR (25)  NULL,
    [COURSE_NAME]             VARCHAR (100) NULL,
    [SKILLS_LIST_2015]        VARCHAR (1)   NULL,
    [SKILLS_LIST_2014]        VARCHAR (1)   NULL,
    [DELIVERY_2013]           VARCHAR (1)   NULL,
    [DELIVERY_2014]           VARCHAR (1)   NULL,
    [VERSION_ON_SKILLS_LIST]  VARCHAR (20)  NULL,
    [CURRENT_COURSE_CODE]     VARCHAR (25)  NULL,
    [CURRENT_COURSE_ON_SL]    VARCHAR (1)   NULL,
    [SL_FLAG]                 VARCHAR (1)   NULL,
    [ID_NCC]                  VARCHAR (25)  NULL,
    [SKILLS_LIST_2016]        VARCHAR (1)   NULL,
    [LOAD_DATE]               DATE          NULL,
    [SKILLS_LIST_2017]        VARCHAR (1)   NULL,
    [CURRENT_COURSE_NAME]     VARCHAR (100) NULL,
    [SKILLS_LIST_2018]        VARCHAR (1)   NULL,
    [SKILLS_LIST_2019]        VARCHAR (1)   NULL,
    [SKILLS_LIST_2020]        VARCHAR (1)   NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_INSTITUTES]...';


GO
CREATE TABLE [edw].[Prada_dbo_INSTITUTES] (
    [INSTITUTE_NUM]           NUMERIC (18)  NULL,
    [INSTITUTE_CODE]          NVARCHAR (4)  NULL,
    [NAME]                    NVARCHAR (25) NULL,
    [RTO_CODE]                VARCHAR (5)   NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_PEOPLE]...';


GO
CREATE TABLE [edw].[Prada_dbo_PEOPLE] (
    [ID_PC]                           NUMERIC (18)  NULL,
    [PERSON_CODE]                     NUMERIC (8)   NULL,
    [REGISTRATION_NO]                 VARCHAR (10)  NULL,
    [USI]                             VARCHAR (20)  NULL,
    [ABORIGINAL_GROUP]                VARCHAR (3)   NULL,
    [ABORIGINAL_GROUP_DESCRIPTION]    VARCHAR (50)  NULL,
    [AGE]                             NUMERIC (8)   NULL,
    [APPRENTICE_TRAINEE]              VARCHAR (15)  NULL,
    [ATSI_CD]                         VARCHAR (3)   NULL,
    [ATSI_CD_DESCRIPTION]             VARCHAR (50)  NULL,
    [INTERNATIONAL_FLAG]              VARCHAR (2)   NULL,
    [BIRTHDAY]                        DATE          NULL,
    [COMPLETED_QUALS]                 VARCHAR (1)   NULL,
    [COUNTRY_OF_BIRTH]                VARCHAR (20)  NULL,
    [COUNTRY_OF_BIRTH_DESCRIPTION]    VARCHAR (50)  NULL,
    [DISAB_ACQUIRED_BRAIN_IMPAIRMENT] VARCHAR (4)   NULL,
    [DISAB_HEARING]                   VARCHAR (4)   NULL,
    [DISAB_INTELLECTUAL]              VARCHAR (4)   NULL,
    [DISAB_LEARNING]                  VARCHAR (4)   NULL,
    [DISAB_MEDICAL_CONDITION]         VARCHAR (4)   NULL,
    [DISAB_MENTAL_ILLNESS]            VARCHAR (4)   NULL,
    [DISAB_OTHER]                     VARCHAR (4)   NULL,
    [DISAB_PHYSICAL]                  VARCHAR (4)   NULL,
    [DISAB_TYPE_DERIVED]              VARCHAR (3)   NULL,
    [DISAB_VISUAL]                    VARCHAR (4)   NULL,
    [DISABILITY_COUNT_FLAG]           VARCHAR (3)   NULL,
    [DISABILITY_FLAG]                 VARCHAR (1)   NULL,
    [DISABILITY_NEED_HELP]            VARCHAR (3)   NULL,
    [DISABILITY_TYPE_ORIG]            VARCHAR (5)   NULL,
    [DISABILITY_TYPE]                 VARCHAR (30)  NULL,
    [EMAIL_ADDRESS]                   VARCHAR (100) NULL,
    [EMPLOYMENT_STATUS]               VARCHAR (4)   NULL,
    [EMPLOYMENT_STATUS_DESCRIPTION]   VARCHAR (75)  NULL,
    [ENGLISH_HELP_FLAG]               VARCHAR (1)   NULL,
    [ENGLISH_LEVEL]                   NUMERIC (8)   NULL,
    [ENGLISH_LEVEL_DESCRIPTION]       VARCHAR (50)  NULL,
    [FORENAME]                        VARCHAR (50)  NULL,
    [GENDER]                          VARCHAR (3)   NULL,
    [HIGHEST_SCHOOL_LEVEL]            VARCHAR (20)  NULL,
    [HOME_LGA]                        VARCHAR (50)  NULL,
    [HOME_POSTCODE]                   VARCHAR (4)   NULL,
    [HOME_POSTCODE_NAM]               VARCHAR (50)  NULL,
    [INSTITUTE]                       VARCHAR (4)   NULL,
    [LANGUAGE_GROUP]                  VARCHAR (20)  NULL,
    [LANGUAGE_GROUP_DESCRIPTION]      VARCHAR (75)  NULL,
    [LANGUAGE_SPOKEN]                 VARCHAR (20)  NULL,
    [LANGUAGE_SPOKEN_DESCRIPTION]     VARCHAR (75)  NULL,
    [MIDDLE_NAMES]                    VARCHAR (240) NULL,
    [MULTI_PRIOR_EDUCATION_LOCATION]  VARCHAR (5)   NULL,
    [POS_ADDRESS_LINE_1]              VARCHAR (75)  NULL,
    [POS_ADDRESS_LINE_2]              VARCHAR (75)  NULL,
    [POS_ADDRESS_LINE_3]              VARCHAR (75)  NULL,
    [POS_ADDRESS_LINE_4]              VARCHAR (75)  NULL,
    [POS_ADDRESS_LINE_5]              VARCHAR (75)  NULL,
    [POS_COUNTRY]                     VARCHAR (50)  NULL,
    [POS_POSTCODE]                    VARCHAR (4)   NULL,
    [POS_POSTCODE_NAM]                VARCHAR (75)  NULL,
    [POS_REGION]                      VARCHAR (3)   NULL,
    [QUAL_ADV_CERT]                   VARCHAR (5)   NULL,
    [QUAL_ADV_CERT_LOCATION]          VARCHAR (50)  NULL,
    [QUAL_ADV_DIP]                    VARCHAR (5)   NULL,
    [QUAL_ADV_DIP_LOCATION]           VARCHAR (50)  NULL,
    [QUAL_ASSOC_DIPLOMA]              VARCHAR (5)   NULL,
    [QUAL_ASSOC_DIPLOMA_LOCATION]     VARCHAR (50)  NULL,
    [QUAL_CERT_I]                     VARCHAR (5)   NULL,
    [QUAL_CERT_I_LOCATION]            VARCHAR (50)  NULL,
    [QUAL_CERT_II]                    VARCHAR (5)   NULL,
    [QUAL_CERT_II_LOCATION]           VARCHAR (50)  NULL,
    [QUAL_DEGREE]                     VARCHAR (5)   NULL,
    [QUAL_DEGREE_LOCATION]            VARCHAR (50)  NULL,
    [QUAL_OTHER_CERT]                 VARCHAR (5)   NULL,
    [QUAL_OTHER_CERT_LOCATION]        VARCHAR (50)  NULL,
    [QUAL_TRADE_CERT]                 VARCHAR (5)   NULL,
    [QUAL_TRADE_CERT_LOCATION]        VARCHAR (50)  NULL,
    [RES_ADDRESS_LINE_1]              VARCHAR (75)  NULL,
    [RES_ADDRESS_LINE_2]              VARCHAR (75)  NULL,
    [RES_ADDRESS_LINE_3]              VARCHAR (75)  NULL,
    [RES_ADDRESS_LINE_4]              VARCHAR (75)  NULL,
    [RES_ADDRESS_LINE_5]              VARCHAR (75)  NULL,
    [RES_COUNTRY]                     VARCHAR (50)  NULL,
    [RES_REGION]                      VARCHAR (3)   NULL,
    [STILL_ATTEND_SCHOOL]             VARCHAR (1)   NULL,
    [SURNAME]                         VARCHAR (50)  NULL,
    [TITLE]                           VARCHAR (10)  NULL,
    [VISA_CLASS_NAM]                  VARCHAR (50)  NULL,
    [VISA_CLASS_NUM]                  NUMERIC (8)   NULL,
    [YEAR_OF_ARRIVAL]                 NUMERIC (8)   NULL,
    [YEAR_SCHOOL_COMPLETED]           NUMERIC (8)   NULL,
    [EXTRACT_DATE]                    NUMERIC (18)  NULL,
    [DATE_USI_VERIFIED]               DATE          NULL,
    [USI_MANUALLY_VERIFIED]           VARCHAR (1)   NULL,
    [VISA_TYPE]                       VARCHAR (5)   NULL,
    [VISA_TYPE_DESCRIPTION]           VARCHAR (75)  NULL,
    [VISA_SUB_CLASS]                  VARCHAR (10)  NULL,
    [VISA_SUB_CLASS_DESCRIPTION]      VARCHAR (75)  NULL,
    [VISA_HOLDER_CODE]                VARCHAR (10)  NULL,
    [VISA_HOLDER_DESCRIPTION]         VARCHAR (75)  NULL,
    [IS_TEMPORARY_VISA_HOLDER]        VARCHAR (1)   NULL,
    [VISA_ISSUE_DATE]                 DATE          NULL,
    [VISA_EXPIRY_DATE]                DATE          NULL,
    [STUDENT_STATUS_CODE]             VARCHAR (50)  NULL,
    [_DLRawZoneTimeStamp]             DATETIME      NULL,
    [_DLTrustedZoneTimeStamp]         DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_REFERENCE_DATA]...';


GO
CREATE TABLE [edw].[Prada_dbo_REFERENCE_DATA] (
    [DOMAIN]                  VARCHAR (50)  NULL,
    [VALUE]                   VARCHAR (50)  NULL,
    [DESCRIPTION]             VARCHAR (100) NULL,
    [ACTIVE]                  VARCHAR (1)   NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL
);


GO
PRINT N'Creating Column Store Index [edw].[Prada_dbo_REFERENCE_DATA].[CCI_edw_Prada_dbo_REFERENCE_DATA]...';


GO
CREATE CLUSTERED INDEX [CCI_edw_Prada_dbo_REFERENCE_DATA]
    ON [edw].[Prada_dbo_REFERENCE_DATA]([DOMAIN]);

CREATE CLUSTERED COLUMNSTORE INDEX [CCI_edw_Prada_dbo_REFERENCE_DATA]
    ON [edw].[Prada_dbo_REFERENCE_DATA] WITH (DROP_EXISTING = ON);


GO
PRINT N'Creating Table [edw].[Prada_dbo_REPORT_DATE]...';


GO
CREATE TABLE [edw].[Prada_dbo_REPORT_DATE] (
    [REPORT_DATE]             NUMERIC (18) NULL,
    [REPORTING_YEAR]          NUMERIC (18) NULL,
    [QUARTER]                 NUMERIC (18) NULL,
    [MONTH_NUM]               NUMERIC (18) NULL,
    [MONTH_NAME]              VARCHAR (20) NULL,
    [WEEK]                    VARCHAR (3)  NULL,
    [EXTRACT_DATE]            NUMERIC (18) NULL,
    [WEEK_LAST_YEAR]          NUMERIC (18) NULL,
    [FY]                      VARCHAR (1)  NULL,
    [_DLRawZoneTimeStamp]     DATETIME     NULL,
    [_DLTrustedZoneTimeStamp] DATETIME     NULL
);


GO
PRINT N'Creating Table [edw].[Prada_dbo_SKILLS_TEAM_MAPPING]...';


GO
CREATE TABLE [edw].[Prada_dbo_SKILLS_TEAM_MAPPING] (
    [COST_CENTRE]             VARCHAR (30)  NULL,
    [Cost_Centre_Name]        VARCHAR (100) NULL,
    [Cost_Centre_with_Name]   VARCHAR (100) NULL,
    [Region_-_iPlan]          VARCHAR (100) NULL,
    [Head_Teacher]            VARCHAR (100) NULL,
    [Teaching_Section]        VARCHAR (100) NULL,
    [Activity_Level_3]        VARCHAR (100) NULL,
    [Skills_Team]             VARCHAR (150) NULL,
    [load_date]               DATE          NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL,
    [_RecordStart]            DATETIME      NULL,
    [_RecordEnd]              DATETIME      NULL,
    [_RecordCurrent]          INT           NULL,
    [_RecordDeleted]          INT           NULL
);


GO
PRINT N'Creating Column Store Index [edw].[Prada_dbo_SKILLS_TEAM_MAPPING].[CCI_edw_Prada_dbo_skills_team_mapping]...';


GO
CREATE CLUSTERED INDEX [CCI_edw_Prada_dbo_skills_team_mapping]
    ON [edw].[Prada_dbo_SKILLS_TEAM_MAPPING]([COST_CENTRE]);

CREATE CLUSTERED COLUMNSTORE INDEX [CCI_edw_Prada_dbo_skills_team_mapping]
    ON [edw].[Prada_dbo_SKILLS_TEAM_MAPPING] WITH (DROP_EXISTING = ON);


GO
PRINT N'Creating Table [edw].[Prada_dbo_STS_DATA]...';


GO
CREATE TABLE [edw].[Prada_dbo_STS_DATA] (
    [ID_CPU]                     NUMERIC (18)  NULL,
    [INST]                       NUMERIC (18)  NULL,
    [COMMITMENT_ID]              VARCHAR (12)  NULL,
    [PRODUCT_CODE]               VARCHAR (18)  NULL,
    [ENROLMENT_STATUS]           VARCHAR (16)  NULL,
    [STREAM_GROUP]               VARCHAR (53)  NULL,
    [STREAM]                     VARCHAR (50)  NULL,
    [COURSE10]                   VARCHAR (10)  NULL,
    [COURSE_PU_ID]               NUMERIC (18)  NULL,
    [STS_REPORT_DATE]            DATE          NULL,
    [MAX_STAGE_LOAD]             NUMERIC (18)  NULL,
    [SUM_STAGE_LOAD]             SMALLMONEY    NULL,
    [DATE_STAGE_LOAD]            DATE          NULL,
    [MAX_LOCATION_LOAD]          NUMERIC (18)  NULL,
    [SUM_LOCATION_LOAD]          SMALLMONEY    NULL,
    [DATE_LOCATION_LOAD]         DATE          NULL,
    [MAX_NEEDS_LOAD]             NUMERIC (18)  NULL,
    [SUM_NEED_LOAD]              SMALLMONEY    NULL,
    [DATE_NEED_LOAD]             DATE          NULL,
    [REGION]                     VARCHAR (100) NULL,
    [PROPOSED_COMMENCEMENT_DATE] DATE          NULL,
    [ESTIMATED_END_DATE]         DATE          NULL,
    [_DLRawZoneTimeStamp]        DATETIME      NULL,
    [_DLTrustedZoneTimeStamp]    DATETIME      NULL,
    [_RecordStart]               DATETIME      NULL,
    [_RecordEnd]                 DATETIME      NULL,
    [_RecordCurrent]             INT           NULL,
    [_RecordDeleted]             INT           NULL
);


GO
PRINT N'Creating Column Store Index [edw].[Prada_dbo_STS_DATA].[CCI_edw_Prada_dbo_STS_DATA]...';


GO
CREATE CLUSTERED INDEX [CCI_edw_Prada_dbo_STS_DATA]
    ON [edw].[Prada_dbo_STS_DATA]([ID_CPU]);

CREATE CLUSTERED COLUMNSTORE INDEX [CCI_edw_Prada_dbo_STS_DATA]
    ON [edw].[Prada_dbo_STS_DATA] WITH (DROP_EXISTING = ON);


GO
PRINT N'Creating Table [edw].[Prada_dbo_UNIT_INSTANCE_OCCURRENCES]...';


GO
CREATE TABLE [edw].[Prada_dbo_UNIT_INSTANCE_OCCURRENCES] (
    [ID_UIO]                     NUMERIC (18)  NULL,
    [ID_UI]                      VARCHAR (40)  NULL,
    [INSTITUTE]                  VARCHAR (4)   NULL,
    [CALOCC_CALENDAR_TYPE_CODE]  VARCHAR (15)  NULL,
    [CALOCC_OCCURRENCE_CODE]     VARCHAR (15)  NULL,
    [FES_START_DATE]             DATE          NULL,
    [FES_END_DATE]               DATE          NULL,
    [FES_UINS_INSTANCE_CODE]     VARCHAR (25)  NULL,
    [OFFERING_CODE]              VARCHAR (75)  NULL,
    [UIO_ID]                     NUMERIC (18)  NULL,
    [FES_ACTIVE]                 VARCHAR (3)   NULL,
    [OWNING_ORGANISATION]        VARCHAR (10)  NULL,
    [OFFERING_ORGANISATION]      VARCHAR (10)  NULL,
    [SLOC_LOCATION_CODE]         VARCHAR (10)  NULL,
    [FES_MOA_CODE]               VARCHAR (10)  NULL,
    [STATUS]                     VARCHAR (12)  NULL,
    [UIO_TYPE]                   VARCHAR (12)  NULL,
    [NZ_FUNDING]                 VARCHAR (10)  NULL,
    [FES_USER_8]                 VARCHAR (20)  NULL,
    [FES_USER_26]                VARCHAR (20)  NULL,
    [VERSION_NUMBER]             NUMERIC (18)  NULL,
    [MAXIMUM_HOURS]              NUMERIC (18)  NULL,
    [OFFERING_TYPE]              VARCHAR (15)  NULL,
    [VFH_DELIVERY_MODE]          VARCHAR (2)   NULL,
    [PROSP_USER_19]              VARCHAR (2)   NULL,
    [OFFERING_STATUS]            VARCHAR (15)  NULL,
    [DELIVERY_LOCATION]          VARCHAR (75)  NULL,
    [AWARD_CODE]                 VARCHAR (25)  NULL,
    [AWARD_RULESET_ID]           NUMERIC (18)  NULL,
    [UNIT_OF_STUDY_CODE]         VARCHAR (15)  NULL,
    [COURSE_EFTSL_FACTOR]        NUMERIC (18)  NULL,
    [WAIVER_CODE]                VARCHAR (10)  NULL,
    [IS_GOVT_SUBSID_COURSE]      VARCHAR (5)   NULL,
    [OFFERING_ORGANISATION_DESC] VARCHAR (75)  NULL,
    [OWNING_ORGANISATION_DESC]   VARCHAR (75)  NULL,
    [EXTRACT_DATE]               NUMERIC (18)  NULL,
    [_DLRawZoneTimeStamp]        DATETIME2 (7) NULL,
    [_DLTrustedZoneTimeStamp]    DATETIME2 (7) NULL
);


GO
PRINT N'Creating Column Store Index [edw].[Prada_dbo_UNIT_INSTANCE_OCCURRENCES].[CCI_edw_Prada_dbo_UNIT_INSTANCE_OCCURRENCES]...';


GO
CREATE CLUSTERED INDEX [CCI_edw_Prada_dbo_UNIT_INSTANCE_OCCURRENCES]
    ON [edw].[Prada_dbo_UNIT_INSTANCE_OCCURRENCES]([ID_UIO]);

CREATE CLUSTERED COLUMNSTORE INDEX [CCI_edw_Prada_dbo_UNIT_INSTANCE_OCCURRENCES]
    ON [edw].[Prada_dbo_UNIT_INSTANCE_OCCURRENCES] WITH (DROP_EXISTING = ON);


GO
PRINT N'Creating Table [edw].[Prada_dbo_UNIT_INSTANCES]...';


GO
CREATE TABLE [edw].[Prada_dbo_UNIT_INSTANCES] (
    [ID_UI]                      VARCHAR (40)  NULL,
    [INSTITUTE]                  VARCHAR (4)   NULL,
    [UNIT_CATEGORY]              VARCHAR (10)  NULL,
    [CTYPE_CALENDAR_TYPE_CODE]   VARCHAR (10)  NULL,
    [FES_UNIT_INSTANCE_CODE]     VARCHAR (25)  NULL,
    [FES_ACTIVE]                 VARCHAR (3)   NULL,
    [FES_ENROL_FLAG]             VARCHAR (3)   NULL,
    [FES_SHORT_DESCRIPTION]      VARCHAR (50)  NULL,
    [FES_LONG_DESCRIPTION]       VARCHAR (200) NULL,
    [FES_STATUS]                 VARCHAR (15)  NULL,
    [FES_MOA_CODE]               VARCHAR (2)   NULL,
    [RELEASE_NUM]                VARCHAR (4)   NULL,
    [ANIMAL_USE]                 NUMERIC (18)  NULL,
    [ANIMAL_USE_DESCRIPTION]     VARCHAR (50)  NULL,
    [PRODUCT_SUBJECT]            VARCHAR (200) NULL,
    [UI_ID]                      NUMERIC (18)  NULL,
    [UI_TYPE]                    VARCHAR (3)   NULL,
    [NZSCED]                     VARCHAR (8)   NULL,
    [GRADING_SCHEME_ID]          NUMERIC (18)  NULL,
    [AWARD_CATEGORY_CODE]        VARCHAR (5)   NULL,
    [VERSION_NUMBER]             NUMERIC (18)  NULL,
    [MAXIMUM_HOURS]              NUMERIC (18)  NULL,
    [STEM_VALUE]                 VARCHAR (25)  NULL,
    [UI_LEVEL]                   VARCHAR (10)  NULL,
    [RAM_CATEGORY]               VARCHAR (4)   NULL,
    [IS_VET_FEE_HELP]            VARCHAR (3)   NULL,
    [IS_FEE_HELP]                VARCHAR (3)   NULL,
    [IS_BOS_COURSE]              VARCHAR (3)   NULL,
    [ANZSIC_NUM]                 VARCHAR (8)   NULL,
    [QUALIFICATION_LEVEL]        VARCHAR (5)   NULL,
    [COURSE_OCCUPATION]          VARCHAR (10)  NULL,
    [INTERNATIONAL_COURSE_CODE]  VARCHAR (20)  NULL,
    [NATIONAL_COURSE_CODE]       VARCHAR (25)  NULL,
    [COURSE_CODE]                VARCHAR (25)  NULL,
    [TAFE_COURSE_CODE]           VARCHAR (25)  NULL,
    [COURSE_EFTSL_FACTOR]        NUMERIC (18)  NULL,
    [IS_VOCATIONAL]              VARCHAR (3)   NULL,
    [ANZSIC_NAM]                 VARCHAR (100) NULL,
    [ANZSCO_NAM]                 VARCHAR (100) NULL,
    [FIELD_OF_EDUCATION_NAM]     VARCHAR (100) NULL,
    [RAM_NAM]                    VARCHAR (30)  NULL,
    [AWARD_CATEGORY_NAM]         VARCHAR (50)  NULL,
    [AVETMISS_QUALIFICATION_NUM] VARCHAR (6)   NULL,
    [TRAINING_PACKAGE_NUM]       VARCHAR (10)  NULL,
    [PROGRAM_AREA_NUM]           VARCHAR (4)   NULL,
    [SPONSOR_NUM]                VARCHAR (4)   NULL,
    [TRAINING_PACKAGE_NAM]       VARCHAR (75)  NULL,
    [PROGRAM_AREA_NAM]           VARCHAR (50)  NULL,
    [SPONSOR_NAM]                VARCHAR (50)  NULL,
    [EXTRACT_DATE]               NUMERIC (18)  NULL,
    [TGA_COURSE_NAME]            VARCHAR (200) NULL,
    [ID_CSE]                     VARCHAR (30)  NULL,
    [RECOMMENDED_USAGE]          VARCHAR (20)  NULL,
    [SCOPE_APPROVED]             VARCHAR (1)   NULL,
    [_DLRawZoneTimeStamp]        DATETIME2 (7) NULL,
    [_DLTrustedZoneTimeStamp]    DATETIME2 (7) NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_COURSE_ENROLMENTS]...';


GO
CREATE TABLE [edw].[Prada_Unit_COURSE_ENROLMENTS] (
    [ID_PC]                        NUMERIC (18)    NULL,
    [ID_UIO]                       NUMERIC (18)    NULL,
    [ID_CPU]                       NUMERIC (18)    NULL,
    [ID_FAC]                       NUMERIC (18)    NULL,
    [INSTITUTE]                    NUMERIC (18)    NULL,
    [CALOCC_CODE]                  VARCHAR (10)    NULL,
    [COMMITMENT_IDENTIFIER]        VARCHAR (12)    NULL,
    [DATE_OFFER_START]             DATE            NULL,
    [DATE_OFFER_END]               DATE            NULL,
    [DATE_AWARDED]                 DATE            NULL,
    [FES_MOA_CODE]                 VARCHAR (10)    NULL,
    [FES_UNIT_INSTANCE_CODE]       VARCHAR (25)    NULL,
    [FES_YEAR_ACHIEVED]            NUMERIC (18)    NULL,
    [NZ_FUNDING]                   VARCHAR (5)     NULL,
    [OFFERING_TYPE]                VARCHAR (10)    NULL,
    [PROGRESS_CODE]                VARCHAR (10)    NULL,
    [PROGRESS_REASON]              VARCHAR (60)    NULL,
    [PROGRESS_STATUS]              VARCHAR (1)     NULL,
    [YEAR_GRADUATED]               NUMERIC (18)    NULL,
    [client_id_pu]                 VARCHAR (10)    NULL,
    [delivery_loc]                 VARCHAR (10)    NULL,
    [program_id]                   VARCHAR (10)    NULL,
    [COURSE10]                     VARCHAR (10)    NULL,
    [year_award_completed]         NUMERIC (18)    NULL,
    [award_flag]                   VARCHAR (1)     NULL,
    [enrolcountpu]                 NUMERIC (18)    NULL,
    [progress_rank]                NUMERIC (18)    NULL,
    [CLIENT_ID]                    VARCHAR (10)    NULL,
    [FUNDING_NAT]                  VARCHAR (2)     NULL,
    [ENROLCOUNT]                   NUMERIC (18)    NULL,
    [validtot]                     NUMERIC (18)    NULL,
    [validunitflag]                NUMERIC (18)    NULL,
    [STARTYY]                      VARCHAR (10)    NULL,
    [ENDYY]                        VARCHAR (10)    NULL,
    [RES_COUNTRY]                  VARCHAR (50)    NULL,
    [hqual]                        NUMERIC (18)    NULL,
    [NUM]                          NUMERIC (18)    NULL,
    [AGEGRP]                       VARCHAR (17)    NULL,
    [course_code]                  VARCHAR (10)    NULL,
    [UNIT_CATEGORY]                VARCHAR (8)     NULL,
    [STATUS]                       VARCHAR (14)    NULL,
    [RAM_CATEGORY]                 VARCHAR (4)     NULL,
    [TRAINING_PACKAGE_NUM]         VARCHAR (10)    NULL,
    [PM]                           NUMERIC (18)    NULL,
    [HIGHED]                       NUMERIC (18)    NULL,
    [SL15V2FLAG]                   VARCHAR (1)     NULL,
    [AWARD]                        VARCHAR (2)     NULL,
    [AWDNM]                        VARCHAR (48)    NULL,
    [CSENM]                        VARCHAR (100)   NULL,
    [FOE4]                         VARCHAR (4)     NULL,
    [RAM]                          NUMERIC (18)    NULL,
    [ANZSCO]                       VARCHAR (6)     NULL,
    [ISC]                          VARCHAR (34)    NULL,
    [NEWCSE]                       VARCHAR (10)    NULL,
    [ORDER]                        NUMERIC (18)    NULL,
    [trnghrs]                      NUMERIC (18)    NULL,
    [rplhrs]                       NUMERIC (18)    NULL,
    [totalhrs]                     NUMERIC (18)    NULL,
    [out71hrs]                     NUMERIC (18)    NULL,
    [GRADTOT]                      NUMERIC (18)    NULL,
    [ENRFLAG]                      NUMERIC (18)    NULL,
    [ENROLMENT_YEAR]               VARCHAR (4)     NULL,
    [GRAD]                         NUMERIC (18)    NULL,
    [res_postcode]                 NUMERIC (18)    NULL,
    [RESLGA]                       NUMERIC (18)    NULL,
    [pcnam]                        VARCHAR (43)    NULL,
    [lganam]                       VARCHAR (20)    NULL,
    [FUND]                         VARCHAR (5)     NULL,
    [COREFND]                      VARCHAR (1)     NULL,
    [functional_unit]              VARCHAR (30)    NULL,
    [SKILLSLIST]                   VARCHAR (1)     NULL,
    [CITIZENSHIP]                  NUMERIC (18)    NULL,
    [apprtrainee]                  VARCHAR (1)     NULL,
    [at_school]                    VARCHAR (1)     NULL,
    [labour_force]                 VARCHAR (4)     NULL,
    [res_suburb]                   VARCHAR (50)    NULL,
    [res_state]                    VARCHAR (3)     NULL,
    [prior_ed]                     VARCHAR (1)     NULL,
    [year_commence]                NUMERIC (18)    NULL,
    [year_complete]                NUMERIC (18)    NULL,
    [month_complete]               NUMERIC (18)    NULL,
    [COMMENCE_FLAG]                VARCHAR (1)     NULL,
    [REENROL_END]                  VARCHAR (5)     NULL,
    [fee_type]                     VARCHAR (1)     NULL,
    [LOCALITY]                     VARCHAR (50)    NULL,
    [LPC]                          VARCHAR (54)    NULL,
    [SA_STATE]                     VARCHAR (3)     NULL,
    [SA2_CODE]                     VARCHAR (10)    NULL,
    [SA2_NAME]                     VARCHAR (35)    NULL,
    [LGA_CODE]                     VARCHAR (10)    NULL,
    [LGA_NAME]                     VARCHAR (35)    NULL,
    [LGA4]                         NUMERIC (18)    NULL,
    [LGANM]                        VARCHAR (35)    NULL,
    [SA4_CODE]                     NUMERIC (18)    NULL,
    [SA4_NAME]                     VARCHAR (38)    NULL,
    [SSREGION]                     VARCHAR (40)    NULL,
    [ARIA11]                       VARCHAR (25)    NULL,
    [ARIA11B]                      VARCHAR (15)    NULL,
    [REGIONAL11]                   NUMERIC (18)    NULL,
    [RIND11]                       VARCHAR (19)    NULL,
    [HQUALN]                       VARCHAR (25)    NULL,
    [SECED]                        VARCHAR (20)    NULL,
    [DELIVERY_MODE_CSE]            VARCHAR (10)    NULL,
    [AVFUND]                       NUMERIC (18)    NULL,
    [JOB]                          VARCHAR (26)    NULL,
    [STSFUND]                      VARCHAR (3)     NULL,
    [STSFUNDGROUP]                 VARCHAR (3)     NULL,
    [LOADING]                      NUMERIC (18, 2) NULL,
    [EXTRACT_DATE]                 VARCHAR (10)    NULL,
    [SL15V3FLAG]                   VARCHAR (1)     NULL,
    [ID_NCC]                       VARCHAR (25)    NULL,
    [AGE]                          NUMERIC (18)    NULL,
    [FEE_ORIGINAL]                 SMALLMONEY      NULL,
    [FEE_ACTUAL]                   SMALLMONEY      NULL,
    [FEE_PAID]                     SMALLMONEY      NULL,
    [WAIVER_CODES]                 VARCHAR (50)    NULL,
    [AWARD_DESCRIPTION]            VARCHAR (75)    NULL,
    [AWARD_ID]                     NUMERIC (18)    NULL,
    [WHO_TO_PAY]                   VARCHAR (20)    NULL,
    [FINALTOT]                     NUMERIC (18)    NULL,
    [UNITTOT]                      NUMERIC (18)    NULL,
    [FINALENROL]                   VARCHAR (3)     NULL,
    [SHELL_ENROL]                  VARCHAR (1)     NULL,
    [PROGRESS_DATE]                DATE            NULL,
    [PASSTOT]                      NUMERIC (18)    NULL,
    [FAILTOT]                      NUMERIC (18)    NULL,
    [WDRAWTOT]                     NUMERIC (18)    NULL,
    [REPORT_DATE]                  VARCHAR (10)    NULL,
    [avetcount]                    NUMERIC (18)    NULL,
    [POPULATION]                   NUMERIC (18)    NULL,
    [SCORE]                        NUMERIC (18)    NULL,
    [RANK]                         NUMERIC (18)    NULL,
    [DECILE]                       NUMERIC (18)    NULL,
    [PERCENTILE]                   NUMERIC (18)    NULL,
    [SL16V4FLAG]                   VARCHAR (1)     NULL,
    [LOAD_DATE]                    DATE            NULL,
    [MIN_CORE]                     NUMERIC (18)    NULL,
    [MIN_UOC]                      NUMERIC (18)    NULL,
    [SPONSOR_ORG_CODE]             VARCHAR (50)    NULL,
    [CTONLY]                       VARCHAR (1)     NULL,
    [RPLONLY]                      VARCHAR (1)     NULL,
    [SS_STATUS]                    VARCHAR (20)    NULL,
    [SS_SUBSIDY_AMOUNT]            SMALLMONEY      NULL,
    [SS_STANDARD_SUBSIDY_AMOUNT]   SMALLMONEY      NULL,
    [SS_LOADING_NEEDS]             SMALLMONEY      NULL,
    [SS_LOADING_LOC]               SMALLMONEY      NULL,
    [TRAINING_CONTRACT_IDENTIFIER] VARCHAR (10)    NULL,
    [SS_PROGRAM_STREAM]            VARCHAR (70)    NULL,
    [FEE_INSTALMENT]               SMALLMONEY      NULL,
    [FEE_ADJUSTMENT]               SMALLMONEY      NULL,
    [FEE_OUTSTANDING]              SMALLMONEY      NULL,
    [DATE_COMMENCE_SEMESTER]       VARCHAR (10)    NULL,
    [sem1totunit]                  NUMERIC (8)     NULL,
    [sem2totunit]                  NUMERIC (8)     NULL,
    [sem3totunit]                  NUMERIC (8)     NULL,
    [sem1totash]                   NUMERIC (8)     NULL,
    [sem2totash]                   NUMERIC (8)     NULL,
    [DELIVERY_MODE_UNIT]           VARCHAR (4)     NULL,
    [AVETMISS_FLAG]                VARCHAR (1)     NULL,
    [LTU_EVIDENCE]                 VARCHAR (1)     NULL,
    [WELFARE_STATUS]               VARCHAR (1)     NULL,
    [TOL]                          VARCHAR (1)     NULL,
    [TNW]                          VARCHAR (1)     NULL,
    [TAFE_DIGITAL]                 VARCHAR (1)     NULL,
    [STUDCTR]                      VARCHAR (1)     NULL,
    [VFH_COURSE]                   VARCHAR (1)     NULL,
    [FEE_HELP_FLAG]                VARCHAR (1)     NULL,
    [VSL_FLAG]                     VARCHAR (1)     NULL,
    [SUBSIDY_ADJUSTMENT]           NUMERIC (18)    NULL,
    [TRANSITIONED_FROM_ID]         NUMERIC (18)    NULL,
    [TRANSITIONED_FROM]            VARCHAR (20)    NULL,
    [TRANSITIONED_FROM_CALOCC]     VARCHAR (10)    NULL,
    [ORIGINAL_START_DATE]          DATE            NULL,
    [REGION]                       VARCHAR (25)    NULL,
    [OPEN]                         VARCHAR (1)     NULL,
    [OTEN]                         VARCHAR (1)     NULL,
    [overseas]                     VARCHAR (1)     NULL,
    [AWARD_STATUS]                 VARCHAR (20)    NULL,
    [FY]                           VARCHAR (1)     NULL,
    [CY]                           VARCHAR (1)     NULL,
    [SKILLSPOINT]                  VARCHAR (4)     NULL,
    [TRANSITION_FLAG]              VARCHAR (1)     NULL,
    [TRANCOUNT]                    VARCHAR (1)     NULL,
    [STUDY_REASON]                 VARCHAR (5)     NULL,
    [FUNDING_VFH]                  VARCHAR (35)    NULL,
    [WORKS_IN_NSW]                 VARCHAR (240)   NULL,
    [EMP_ALT_ORG_NAME]             VARCHAR (100)   NULL,
    [EMP_ALT_EMPLOYER_SUBURB]      VARCHAR (20)    NULL,
    [EMP_POSTCODE]                 VARCHAR (4)     NULL,
    [EMP_ORG_CODE]                 VARCHAR (30)    NULL,
    [EMP_ORG_TYPE]                 VARCHAR (100)   NULL,
    [EMPLOYER]                     VARCHAR (100)   NULL,
    [SEM]                          VARCHAR (1)     NULL,
    [ONLMTOTUNIT]                  NUMERIC (8)     NULL,
    [SBI_GROUP]                    VARCHAR (50)    NULL,
    [SBI_CATEGORY]                 VARCHAR (75)    NULL,
    [SBI_SUBCATEGORY]              VARCHAR (100)   NULL,
    [_DLRawZoneTimeStamp]          DATETIME        NULL,
    [_DLTrustedZoneTimeStamp]      DATETIME        NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_COURSE_UI]...';


GO
CREATE TABLE [edw].[Prada_Unit_COURSE_UI] (
    [ID_UI]                   VARCHAR (40)  NULL,
    [TRAINING_PACKAGE_NUM]    VARCHAR (10)  NULL,
    [TRAINING_PACKAGE_NAM]    VARCHAR (75)  NULL,
    [RECOMMENDED_USAGE]       VARCHAR (20)  NULL,
    [FES_STATUS]              VARCHAR (15)  NULL,
    [UNIT_CATEGORY_DESC]      VARCHAR (100) NULL,
    [_DLRawZoneTimeStamp]     DATETIME      NULL,
    [_DLTrustedZoneTimeStamp] DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_COURSE_UIO]...';


GO
CREATE TABLE [edw].[Prada_Unit_COURSE_UIO] (
    [ID_UIO]                   NUMERIC (18)  NULL,
    [ID_UI]                    VARCHAR (40)  NULL,
    [OFFERING_CODE]            VARCHAR (75)  NULL,
    [DELIVERY_LOCATION]        VARCHAR (75)  NULL,
    [OFFERING_STATUS]          VARCHAR (15)  NULL,
    [OWNING_ORGANISATION_DESC] VARCHAR (75)  NULL,
    [ATTENDANCE_CODE]          VARCHAR (100) NULL,
    [COLLEGE_NAME]             NVARCHAR (75) NULL,
    [DELIVERY_MODE]            VARCHAR (100) NULL,
    [_DLRawZoneTimeStamp]      DATETIME      NULL,
    [_DLTrustedZoneTimeStamp]  DATETIME      NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_UNIT_ENROLMENTS]...';


GO
CREATE TABLE [edw].[Prada_Unit_UNIT_ENROLMENTS] (
    [ID_PC]                          NUMERIC (18) NULL,
    [ID_UUIO]                        NUMERIC (18) NULL,
    [ID_CUIO]                        NUMERIC (18) NULL,
    [ID_CPU]                         VARCHAR (50) NULL,
    [ID_UPU]                         NUMERIC (18) NULL,
    [INSTITUTE]                      NUMERIC (18) NULL,
    [DELIVERY_LOC]                   VARCHAR (10) NULL,
    [CLIENT_ID]                      VARCHAR (10) NULL,
    [SUBJECT_ID]                     VARCHAR (12) NULL,
    [PROGRAM_ID]                     VARCHAR (15) NULL,
    [START_DATE]                     DATE         NULL,
    [END_DATE]                       DATE         NULL,
    [DELIVERY_MODE]                  NUMERIC (18) NULL,
    [OUTCOME_NATIONAL]               VARCHAR (2)  NULL,
    [SCHED_HOURS]                    NUMERIC (18) NULL,
    [FUNDING_NAT]                    VARCHAR (2)  NULL,
    [COMMEN_PROG]                    VARCHAR (1)  NULL,
    [TRAINING_CONTRACT]              VARCHAR (10) NULL,
    [CLIENT_ID_APPREN]               VARCHAR (10) NULL,
    [STUDY_REASON]                   NUMERIC (18) NULL,
    [VET_IN_SCHOOL_FLAG]             VARCHAR (1)  NULL,
    [FUNDING_SPECIFIC]               VARCHAR (10) NULL,
    [OUTCOME_ID_TRAINING]            VARCHAR (3)  NULL,
    [UNIT_PU_ID]                     NUMERIC (18) NULL,
    [FUNDING_SOURCE]                 VARCHAR (12) NULL,
    [RECOGNITION_TYPE]               VARCHAR (3)  NULL,
    [COURSE_PU_ID]                   NUMERIC (18) NULL,
    [PERSON_CODE]                    NUMERIC (18) NULL,
    [DATE_AWARDED]                   DATE         NULL,
    [COMMITMENT_ID]                  VARCHAR (12) NULL,
    [PURCHASING_CONTRACT_ID]         VARCHAR (12) NULL,
    [PURCHASING_CONTRACT_SCHED]      VARCHAR (3)  NULL,
    [HOURS_ATTENDED]                 NUMERIC (18) NULL,
    [CALOCC_CODE]                    VARCHAR (10) NULL,
    [PARENT_ID]                      NUMERIC (18) NULL,
    [SPONSOR_ORG_CODE]               VARCHAR (50) NULL,
    [UNIT_OFFERING_TYPE]             VARCHAR (10) NULL,
    [UNIT_OFFERING_TYPE_DESC]        VARCHAR (50) NULL,
    [PROGRESS_STATUS]                VARCHAR (2)  NULL,
    [PROGRESS_CODE]                  VARCHAR (10) NULL,
    [PROGRESS_REASON]                VARCHAR (20) NULL,
    [PROGRESS_DATE]                  DATE         NULL,
    [COURSE_PROGRESS_STATUS]         VARCHAR (2)  NULL,
    [COURSE_PROGRESS_CODE]           VARCHAR (10) NULL,
    [COURSE_PROGRESS_REASON]         VARCHAR (20) NULL,
    [COURSE_PROGRESS_DATE]           DATE         NULL,
    [COURSE_FUNDING_SOURCE]          VARCHAR (12) NULL,
    [COURSE_DATE_AWARDED]            VARCHAR (10) NULL,
    [TAFE_DELIVERY_MODE]             VARCHAR (15) NULL,
    [COURSE_UIO_ID]                  NUMERIC (18) NULL,
    [UNIT_UIO_ID]                    NUMERIC (18) NULL,
    [AWARD_STATUS]                   VARCHAR (20) NULL,
    [NO_ACA_HISTORY]                 VARCHAR (1)  NULL,
    [CLIENTID_MISS]                  VARCHAR (1)  NULL,
    [COURSE10]                       VARCHAR (10) NULL,
    [ENROLCOUNT]                     NUMERIC (18) NULL,
    [YEAR_CSEAWARDED]                NUMERIC (18) NULL,
    [VALIDUNIT]                      NUMERIC (18) NULL,
    [FINALUNIT]                      NUMERIC (18) NULL,
    [PASSUNIT]                       NUMERIC (18) NULL,
    [FAILUNIT]                       NUMERIC (18) NULL,
    [WDRAWUNIT]                      NUMERIC (18) NULL,
    [RPLUNIT]                        NUMERIC (18) NULL,
    [NONASSUNIT]                     NUMERIC (18) NULL,
    [CTUNIT]                         NUMERIC (18) NULL,
    [OUT70UNIT]                      NUMERIC (18) NULL,
    [OUT51UNIT]                      NUMERIC (18) NULL,
    [OUT52UNIT]                      NUMERIC (18) NULL,
    [OUT81UNIT]                      NUMERIC (18) NULL,
    [OUT82UNIT]                      NUMERIC (18) NULL,
    [OUT61UNIT]                      NUMERIC (18) NULL,
    [OUT60UNIT]                      NUMERIC (18) NULL,
    [ASH]                            NUMERIC (18) NULL,
    [RPLASH]                         NUMERIC (18) NULL,
    [TRNGASH]                        NUMERIC (18) NULL,
    [ASH71]                          NUMERIC (18) NULL,
    [FINALASH]                       NUMERIC (18) NULL,
    [COUNTUNIT]                      NUMERIC (18) NULL,
    [REPORT_DATE]                    VARCHAR (10) NULL,
    [EXTRACT_DATE]                   VARCHAR (10) NULL,
    [LOAD_DATE]                      DATE         NULL,
    [ENROLMENT_YEAR]                 NUMERIC (18) NULL,
    [TRAINEE_CODE_INTERSTATE]        VARCHAR (12) NULL,
    [MAXIMUM_HOURS_INTERSTATE]       NUMERIC (18) NULL,
    [CLIENT_TUITION_FEE_INTERSTATE]  NUMERIC (18) NULL,
    [FEE_CONCESSION_TYPE_INTERSTATE] VARCHAR (10) NULL,
    [SEM1]                           VARCHAR (1)  NULL,
    [SEM2]                           VARCHAR (1)  NULL,
    [SEM3]                           VARCHAR (1)  NULL,
    [SEM1HRS]                        NUMERIC (6)  NULL,
    [SEM2HRS]                        NUMERIC (6)  NULL,
    [YRHRS1]                         NUMERIC (8)  NULL,
    [YRHRSINT]                       NUMERIC (8)  NULL,
    [YRHRS]                          NUMERIC (8)  NULL,
    [ADVD]                           VARCHAR (1)  NULL,
    [CLAS]                           VARCHAR (1)  NULL,
    [SELF]                           VARCHAR (1)  NULL,
    [ELEC]                           VARCHAR (1)  NULL,
    [BLND]                           VARCHAR (1)  NULL,
    [DIST]                           VARCHAR (1)  NULL,
    [ONJB]                           VARCHAR (1)  NULL,
    [ONJD]                           VARCHAR (1)  NULL,
    [SIMU]                           VARCHAR (1)  NULL,
    [MISD]                           VARCHAR (1)  NULL,
    [OTHD]                           VARCHAR (1)  NULL,
    [DELU]                           VARCHAR (1)  NULL,
    [_DLRawZoneTimeStamp]            DATETIME     NULL,
    [_DLTrustedZoneTimeStamp]        DATETIME     NULL,
    [_RecordStart]                   DATETIME     NULL,
    [_RecordEnd]                     DATETIME     NULL,
    [_RecordCurrent]                 INT          NULL,
    [_RecordDeleted]                 INT          NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_UNIT_ENROLMENTS_FINALS]...';


GO
CREATE TABLE [edw].[Prada_Unit_UNIT_ENROLMENTS_FINALS] (
    [ID_PC]                          NUMERIC (18)   NULL,
    [ID_UUIO]                        NUMERIC (18)   NULL,
    [ID_CUIO]                        NUMERIC (18)   NULL,
    [ID_CPU]                         VARCHAR (50)   NULL,
    [ID_UPU]                         NUMERIC (18)   NULL,
    [INSTITUTE]                      NUMERIC (18)   NULL,
    [DELIVERY_LOC]                   VARCHAR (10)   NULL,
    [CLIENT_ID]                      VARCHAR (10)   NULL,
    [SUBJECT_ID]                     VARCHAR (12)   NULL,
    [PROGRAM_ID]                     VARCHAR (15)   NULL,
    [START_DATE]                     DATE           NULL,
    [END_DATE]                       DATE           NULL,
    [DELIVERY_MODE]                  NUMERIC (18)   NULL,
    [OUTCOME_NATIONAL]               VARCHAR (2)    NULL,
    [SCHED_HOURS]                    NUMERIC (18)   NULL,
    [FUNDING_NAT]                    VARCHAR (2)    NULL,
    [COMMEN_PROG]                    VARCHAR (1)    NULL,
    [TRAINING_CONTRACT]              VARCHAR (10)   NULL,
    [CLIENT_ID_APPREN]               VARCHAR (10)   NULL,
    [STUDY_REASON]                   NUMERIC (18)   NULL,
    [VET_IN_SCHOOL_FLAG]             VARCHAR (1)    NULL,
    [FUNDING_SPECIFIC]               VARCHAR (10)   NULL,
    [OUTCOME_ID_TRAINING]            VARCHAR (3)    NULL,
    [UNIT_PU_ID]                     NUMERIC (18)   NULL,
    [FUNDING_SOURCE]                 VARCHAR (12)   NULL,
    [RECOGNITION_TYPE]               VARCHAR (3)    NULL,
    [COURSE_PU_ID]                   NUMERIC (18)   NULL,
    [PERSON_CODE]                    NUMERIC (18)   NULL,
    [DATE_AWARDED]                   DATE           NULL,
    [COMMITMENT_ID]                  VARCHAR (12)   NULL,
    [PURCHASING_CONTRACT_ID]         VARCHAR (12)   NULL,
    [PURCHASING_CONTRACT_SCHED]      VARCHAR (3)    NULL,
    [HOURS_ATTENDED]                 NUMERIC (18)   NULL,
    [CALOCC_CODE]                    VARCHAR (10)   NULL,
    [PARENT_ID]                      NUMERIC (18)   NULL,
    [SPONSOR_ORG_CODE]               VARCHAR (50)   NULL,
    [UNIT_OFFERING_TYPE]             VARCHAR (10)   NULL,
    [UNIT_OFFERING_TYPE_DESC]        VARCHAR (50)   NULL,
    [PROGRESS_STATUS]                VARCHAR (2)    NULL,
    [PROGRESS_CODE]                  VARCHAR (10)   NULL,
    [PROGRESS_REASON]                VARCHAR (20)   NULL,
    [PROGRESS_DATE]                  DATE           NULL,
    [COURSE_PROGRESS_STATUS]         VARCHAR (2)    NULL,
    [COURSE_PROGRESS_CODE]           VARCHAR (10)   NULL,
    [COURSE_PROGRESS_REASON]         VARCHAR (20)   NULL,
    [COURSE_PROGRESS_DATE]           DATE           NULL,
    [COURSE_FUNDING_SOURCE]          VARCHAR (12)   NULL,
    [COURSE_DATE_AWARDED]            VARCHAR (10)   NULL,
    [TAFE_DELIVERY_MODE]             VARCHAR (15)   NULL,
    [COURSE_UIO_ID]                  NUMERIC (18)   NULL,
    [UNIT_UIO_ID]                    NUMERIC (18)   NULL,
    [AWARD_STATUS]                   VARCHAR (20)   NULL,
    [NO_ACA_HISTORY]                 VARCHAR (1)    NULL,
    [CLIENTID_MISS]                  VARCHAR (1)    NULL,
    [COURSE10]                       VARCHAR (10)   NULL,
    [ENROLCOUNT]                     NUMERIC (18)   NULL,
    [YEAR_CSEAWARDED]                NUMERIC (18)   NULL,
    [VALIDUNIT]                      NUMERIC (18)   NULL,
    [FINALUNIT]                      NUMERIC (18)   NULL,
    [PASSUNIT]                       NUMERIC (18)   NULL,
    [FAILUNIT]                       NUMERIC (18)   NULL,
    [WDRAWUNIT]                      NUMERIC (18)   NULL,
    [RPLUNIT]                        NUMERIC (18)   NULL,
    [NONASSUNIT]                     NUMERIC (18)   NULL,
    [CTUNIT]                         NUMERIC (18)   NULL,
    [OUT70UNIT]                      NUMERIC (18)   NULL,
    [OUT51UNIT]                      NUMERIC (18)   NULL,
    [OUT52UNIT]                      NUMERIC (18)   NULL,
    [OUT81UNIT]                      NUMERIC (18)   NULL,
    [OUT82UNIT]                      NUMERIC (18)   NULL,
    [OUT61UNIT]                      NUMERIC (18)   NULL,
    [OUT60UNIT]                      NUMERIC (18)   NULL,
    [ASH]                            NUMERIC (18)   NULL,
    [RPLASH]                         NUMERIC (18)   NULL,
    [TRNGASH]                        NUMERIC (18)   NULL,
    [ASH71]                          NUMERIC (18)   NULL,
    [FINALASH]                       NUMERIC (18)   NULL,
    [COUNTUNIT]                      NUMERIC (18)   NULL,
    [REPORT_DATE]                    VARCHAR (10)   NULL,
    [EXTRACT_DATE]                   VARCHAR (10)   NULL,
    [LOAD_DATE]                      DATE           NULL,
    [ENROLMENT_YEAR]                 NUMERIC (18)   NULL,
    [TRAINEE_CODE_INTERSTATE]        VARCHAR (12)   NULL,
    [MAXIMUM_HOURS_INTERSTATE]       NUMERIC (18)   NULL,
    [CLIENT_TUITION_FEE_INTERSTATE]  NUMERIC (18)   NULL,
    [FEE_CONCESSION_TYPE_INTERSTATE] VARCHAR (10)   NULL,
    [SEM1]                           VARCHAR (1)    NULL,
    [SEM2]                           VARCHAR (1)    NULL,
    [SEM3]                           VARCHAR (1)    NULL,
    [SEM1HRS]                        NUMERIC (6)    NULL,
    [SEM2HRS]                        NUMERIC (6)    NULL,
    [YRHRS1]                         NUMERIC (8)    NULL,
    [YRHRSINT]                       NUMERIC (8)    NULL,
    [YRHRS]                          NUMERIC (8)    NULL,
    [ADVD]                           VARCHAR (1)    NULL,
    [CLAS]                           VARCHAR (1)    NULL,
    [SELF]                           VARCHAR (1)    NULL,
    [ELEC]                           VARCHAR (1)    NULL,
    [BLND]                           VARCHAR (1)    NULL,
    [DIST]                           VARCHAR (1)    NULL,
    [ONJB]                           VARCHAR (1)    NULL,
    [ONJD]                           VARCHAR (1)    NULL,
    [SIMU]                           VARCHAR (1)    NULL,
    [MISD]                           VARCHAR (1)    NULL,
    [OTHD]                           VARCHAR (1)    NULL,
    [DELU]                           VARCHAR (1)    NULL,
    [year]                           NVARCHAR (MAX) NULL,
    [month]                          NVARCHAR (MAX) NULL,
    [day]                            NVARCHAR (MAX) NULL,
    [_DLRawZoneTimeStamp]            DATETIME       NULL,
    [_DLTrustedZoneTimeStamp]        DATETIME       NULL,
    [_RecordStart]                   DATETIME       NULL,
    [_RecordEnd]                     DATETIME       NULL,
    [_RecordDeleted]                 INT            NULL,
    [_RecordCurrent]                 INT            NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_UNIT_INSTANCE_OCCURRENCES]...';


GO
CREATE TABLE [edw].[Prada_Unit_UNIT_INSTANCE_OCCURRENCES] (
    [ID_UUIO]                    NUMERIC (18) NULL,
    [ID_UUI]                     VARCHAR (40) NULL,
    [INSTITUTE]                  VARCHAR (4)  NULL,
    [CALOCC_CALENDAR_TYPE_CODE]  VARCHAR (15) NULL,
    [CALOCC_OCCURRENCE_CODE]     VARCHAR (15) NULL,
    [FES_START_DATE]             DATE         NULL,
    [FES_END_DATE]               DATE         NULL,
    [FES_UINS_INSTANCE_CODE]     VARCHAR (25) NULL,
    [OFFERING_CODE]              VARCHAR (75) NULL,
    [UIO_ID]                     NUMERIC (18) NULL,
    [FES_ACTIVE]                 VARCHAR (3)  NULL,
    [OWNING_ORGANISATION]        VARCHAR (10) NULL,
    [OFFERING_ORGANISATION]      VARCHAR (10) NULL,
    [SLOC_LOCATION_CODE]         VARCHAR (10) NULL,
    [FES_MOA_CODE]               VARCHAR (10) NULL,
    [STATUS]                     VARCHAR (12) NULL,
    [UIO_TYPE]                   VARCHAR (12) NULL,
    [NZ_FUNDING]                 VARCHAR (10) NULL,
    [FES_USER_8]                 VARCHAR (20) NULL,
    [FES_USER_26]                VARCHAR (20) NULL,
    [VERSION_NUMBER]             NUMERIC (18) NULL,
    [MAXIMUM_HOURS]              NUMERIC (18) NULL,
    [OFFERING_TYPE]              VARCHAR (15) NULL,
    [VFH_DELIVERY_MODE]          VARCHAR (2)  NULL,
    [PROSP_USER_19]              VARCHAR (2)  NULL,
    [OFFERING_STATUS]            VARCHAR (15) NULL,
    [DELIVERY_LOCATION]          VARCHAR (75) NULL,
    [AWARD_CODE]                 VARCHAR (25) NULL,
    [AWARD_RULESET_ID]           NUMERIC (18) NULL,
    [UNIT_OF_STUDY_CODE]         VARCHAR (15) NULL,
    [COURSE_EFTSL_FACTOR]        NUMERIC (18) NULL,
    [WAIVER_CODE]                VARCHAR (10) NULL,
    [IS_GOVT_SUBSID_COURSE]      VARCHAR (5)  NULL,
    [OFFERING_ORGANISATION_DESC] VARCHAR (75) NULL,
    [OWNING_ORGANISATION_DESC]   VARCHAR (75) NULL,
    [EXTRACT_DATE]               NUMERIC (18) NULL,
    [LOAD_DATE]                  DATE         NULL,
    [UPDATE_DATE]                DATE         NULL,
    [_DLRawZoneTimeStamp]        DATETIME     NULL,
    [_DLTrustedZoneTimeStamp]    DATETIME     NULL
);


GO
PRINT N'Creating Table [edw].[Prada_Unit_UNIT_INSTANCES]...';


GO
CREATE TABLE [edw].[Prada_Unit_UNIT_INSTANCES] (
    [ID_UUI]                    VARCHAR (40)  NULL,
    [ID_UNIT]                   VARCHAR (30)  NULL,
    [INSTITUTE]                 VARCHAR (4)   NULL,
    [UNIT_CATEGORY]             VARCHAR (10)  NULL,
    [CTYPE_CALENDAR_TYPE_CODE]  VARCHAR (10)  NULL,
    [FES_UNIT_INSTANCE_CODE]    VARCHAR (25)  NULL,
    [FES_ACTIVE]                VARCHAR (3)   NULL,
    [FES_ENROL_FLAG]            VARCHAR (3)   NULL,
    [FES_SHORT_DESCRIPTION]     VARCHAR (50)  NULL,
    [FES_LONG_DESCRIPTION]      VARCHAR (200) NULL,
    [TGA_COURSE_NAME]           VARCHAR (200) NULL,
    [FES_STATUS]                VARCHAR (15)  NULL,
    [RELEASE_NUM]               VARCHAR (4)   NULL,
    [ANIMAL_USE]                NUMERIC (18)  NULL,
    [ANIMAL_USE_DESCRIPTION]    VARCHAR (50)  NULL,
    [PRODUCT_SUBJECT]           VARCHAR (200) NULL,
    [UI_ID]                     NUMERIC (18)  NULL,
    [UI_TYPE]                   VARCHAR (3)   NULL,
    [NZSCED]                    VARCHAR (8)   NULL,
    [GRADING_SCHEME_ID]         NUMERIC (18)  NULL,
    [VERSION_NUMBER]            NUMERIC (18)  NULL,
    [MAXIMUM_HOURS]             NUMERIC (18)  NULL,
    [STEM_VALUE]                VARCHAR (25)  NULL,
    [UI_LEVEL]                  VARCHAR (10)  NULL,
    [RAM_CATEGORY]              VARCHAR (4)   NULL,
    [IS_VET_FEE_HELP]           VARCHAR (3)   NULL,
    [IS_FEE_HELP]               VARCHAR (3)   NULL,
    [IS_BOS_COURSE]             VARCHAR (3)   NULL,
    [ANZSIC_NUM]                VARCHAR (8)   NULL,
    [COURSE_OCCUPATION]         VARCHAR (10)  NULL,
    [INTERNATIONAL_COURSE_CODE] VARCHAR (20)  NULL,
    [NATIONAL_COURSE_CODE]      VARCHAR (25)  NULL,
    [COURSE_CODE]               VARCHAR (25)  NULL,
    [TAFE_COURSE_CODE]          VARCHAR (25)  NULL,
    [COURSE_EFTSL_FACTOR]       NUMERIC (18)  NULL,
    [IS_VOCATIONAL]             VARCHAR (3)   NULL,
    [ANZSIC_NAM]                VARCHAR (100) NULL,
    [ANZSCO_NAM]                VARCHAR (100) NULL,
    [FIELD_OF_EDUCATION_NAM]    VARCHAR (100) NULL,
    [RAM_NAM]                   VARCHAR (30)  NULL,
    [PROGRAM_AREA_NUM]          VARCHAR (4)   NULL,
    [SPONSOR_NUM]               VARCHAR (4)   NULL,
    [PROGRAM_AREA_NAM]          VARCHAR (50)  NULL,
    [SPONSOR_NAM]               VARCHAR (50)  NULL,
    [RECOMMENDED_USAGE]         VARCHAR (20)  NULL,
    [EXTRACT_DATE]              NUMERIC (18)  NULL,
    [SCOPE_APPROVED]            VARCHAR (1)   NULL,
    [LOAD_DATE]                 DATE          NULL,
    [UPDATE_DATE]               DATE          NULL,
    [_DLRawZoneTimeStamp]       DATETIME      NULL,
    [_DLTrustedZoneTimeStamp]   DATETIME      NULL
);


GO
PRINT N'Creating Table [tsEchecklist].[echecklistRptPrompt]...';


GO
CREATE TABLE [tsEchecklist].[echecklistRptPrompt] (
    [Domain]      NVARCHAR (50)  NOT NULL,
    [Value]       NVARCHAR (100) NOT NULL,
    [Description] NVARCHAR (100) NULL
);


GO
PRINT N'Refreshing View [OneEBS].[Attainments]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Attainments]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List]';


GO
PRINT N'Refreshing View [OneEBS].[People_Units]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_Units]';


GO
PRINT N'Refreshing View [OneEBS].[People_Units_Special]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_Units_Special]';


GO
PRINT N'Refreshing View [OneEBS].[Progress_Records]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Progress_Records]';


GO
PRINT N'Refreshing View [OneEBS].[Register_Event_Details_Slots]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Register_Event_Details_Slots]';


GO
PRINT N'Refreshing View [OneEBS].[Register_Event_Slots]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Register_Event_Slots]';


GO
PRINT N'Refreshing View [OneEBS].[Unit_Instance_Occurrences]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Unit_Instance_Occurrences]';


GO
PRINT N'Refreshing View [EChecklist].[EChecklistExceptionReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[EChecklist].[EChecklistExceptionReport]';


GO
PRINT N'Altering View [compliance].[vwAvetmissStudent]...';


GO




ALTER      view [compliance].[vwAvetmissStudent] as

	SELECT distinct 
		concat(ce.ReportingYear, ce.InstituteId, s.PersonCode) as ID_PC
		,ce.InstituteId as INSTITUTE
		,ce.StudentId as 'Person Code'
		,case
			when s.CompletedQualification = 'Y' then 'Yes - Completed Qual'
			else 'No - Completed Qual'
		 end AS 'Completed Qualification'
		,s.[CountryOfBirthDescription] AS 'Country of Birth'
		/*
		,CASE 
				WHEN s.DisabilityFlag > 0 THEN 'Yes - Count Dis'
				ELSE 'No - Count Dis'
			END AS 'Disability Count Flag'
		*/
		,CASE
			WHEN s.DisabilityFlag = 2 
				OR s.DisabilityNeedHelp = 'Yes - Help Dis'
				OR Coalesce (dt.DisabilityType, '') <> '' THEN 'Yes - Count Dis'
			ELSE 'No - Count Dis'
		 END AS 'Disability Count Flag'
		,Coalesce (dt.DisabilityType, 'Not Known') AS 'Disability Type'
		,CASE 
			WHEN s.EmploymentStatus IS NOT NULL THEN CONCAT(s.EmploymentStatus, ' ', s.EmploymentStatusDescription) 
			ELSE NULL 
			END AS 'Employment Status'
		--,case 
		--	when s.gender = 'F' then 'Female'
		--	when s.gender = 'M' then 'Male'
		--	else 'Unknown' 
		--	end AS 'Gender'
		,Coalesce(s.gender, 'Unknown') AS 'Gender'
		--,CASE
		--	WHEN s.DisabilityNeedHelp = 'Y' THEN 'Yes - Help Dis'
		--	ELSE 'No - Help Dis'
		--	END AS 'Help Disability'
		,DisabilityNeedHelp as 'Help Disability'
		,CASE
			WHEN EnglishHelpFlag  = 'Y' THEN 'Yes - Help Eng'
			ELSE 'No - Help Eng'
		 END  AS 'Help English'
		,Coalesce(s.HighestSchoolLevel, 'NOT STATED') AS 'Highest School Level'
		,CASE 
			WHEN ATSICodeDescription IS NOT NULL OR ATSICodeDescription <> '' THEN ATSICodeDescription
			ELSE 'No'
			END AS 'Indigenous'
		--,CASE
		--	WHEN s.AboriginalGroupDescription in ('1','2','3') THEN 'INDIGENOUS' 
		--	ELSE 'NON INDIGENOUS'
		--	END  AS 'Indigenous Group'
		,CASE 
			WHEN ATSICodeDescription IS NOT NULL OR ATSICodeDescription <> ''
			THEN s.AboriginalGroupDescription ELSE 'NON INDIGENOUS' END as 'Indigenous Group'
		,[LanguageGroupDescription] AS 'Language Group'
		,[LanguageSpokenDescription]  AS 'Language Spoken'
		,s.[RegistrationNo] AS 'Learner Number'
		,[PostalAddressPostcode] AS 'Postcode Postal'
		,[HomePostCode] AS 'Postcode Residential'
		,[ResidentialCountry] AS 'Residential Country'
		,ResidentialRegion AS 'Residential Region'
		,CASE
			WHEN s.VisaClassNo  IS NOT NULL THEN CONCAT(s.VisaClassNo, ' ', s.VisaClassName)
			ELSE NULL 
			END  AS 'Residential Status'
		,StillAttendSchool AS 'Still Attends School'
		,s.[USIProvided]  AS 'USI Provided'
		,s.[YearSchoolCompleted] AS 'Year School Completed'
		,CASE
			WHEN s.VisaType  is not null THEN 'Yes - Visa Provided'
			ELSE 'No - Visa Blank'
			END  AS 'Visa Provided'
		,[VisaSubClass] as 'Visa Sub Class'
		,[VisaSubClassDescription] as 'Visa Sub Class Description'
		,Case When year(VisaExpiryDate) >= RIGHT(ce.ReportingYear,4) then VisaExpiryDate else null end  as VISA_EXPIRY_DATE
		,Case When year(VisaExpiryDate) >= RIGHT(ce.ReportingYear,4) then DAY(s.VisaExpiryDate) else null end AS 'Visa Expiry Date Day'
		,Case When year(VisaExpiryDate) >= RIGHT(ce.ReportingYear,4) then DATENAME(MONTH,s.VisaExpiryDate) else null end AS 'Visa Expiry Date Month'
		,Case When year(VisaExpiryDate) >= RIGHT(ce.ReportingYear,4) then YEAR(s.VisaExpiryDate) else null end AS 'Visa Expiry Date Year'
		,CASE 
			WHEN USIManuallyVerified = 'Y' THEN 'Yes - USI Verified' 
			ELSE 'No - USI Verified'
			END AS 'USI Manually Verified'
		,Case When year(VisaExpiryDate) >= RIGHT(ce.ReportingYear,4) then MONTH(s.VisaExpiryDate) else null end AS SORT_VED
		,DateUSIVerified as DATE_USI_VERIFIED
		,DAY(DateUSIVerified) AS 'Date USI Verified Day'
		,DATENAME(MONTH, DateUSIVerified) AS 'Date USI Verified Month'
		,YEAR(DateUSIVerified) AS 'Date USI Verified Year'
		,MONTH(DateUSIVerified) AS SORT_DUV
		,Coalesce ([PrimaryLearner], s.RegistrationNo, s.personcode) as PrimaryLearner
	from [compliance].[AvetmissStudent] s
	join [compliance].[AvetmissCourseEnrolment] ce on s.PersonCode = ce.StudentId
	join edw.reference_avetmiss_reporting_year_cut_off_date cutoff on ce.ReportingYear = cutoff.ReportingYear
															and cutoff._RecordCurrent = 1
															and cutoff._RecordDeleted = 0
	left join [compliance].[AvetmissDisabilityType] dt on RIGHT(ce.ReportingYear, 4) = dt.ReportingYear and ce.StudentId = dt.PersonCode
		and dt._RecordCurrent = 1 and dt._RecordDeleted = 0
	LEFT JOIN [compliance].[AvetmissPrimaryLearner] PL ON PL.PersonCode = ce.StudentId and cutoff.CubeCutOffReportingDate between PL._RecordStart and PL._RecordEnd

	where 1=1
	and cutoff.CubeCutOffReportingDate between s._RecordStart and s._RecordEnd
GO
PRINT N'Altering View [reference].[CourseReplacement]...';


GO
ALTER   VIEW  reference.CourseReplacement AS SELECT *, _DLTrustedZoneTimeStamp _DLCuratedZoneTimeStamp  FROM edw.reference_course_replacement
GO
PRINT N'Altering View [reference].[WaiverTypes]...';


GO
ALTER   VIEW  reference.WaiverTypes AS SELECT *, _DLTrustedZoneTimeStamp _DLCuratedZoneTimeStamp  FROM edw.reference_waiver_types
GO
PRINT N'Creating View [EChecklist].[ChecklistActions]...';


GO

Create View [EChecklist].[ChecklistActions] as
Select CheckListId,
       InstanceID,
	   TaskNo,
       ActionedDate,
       CreationDate,
	   Actioner,
	   TaskName,
	   TaskOwner,
	   InitiatedDate,
	   InitiatedBy,
	   HighestStatusId,
	   SkillPoint,
	   [Location],
	   FundingType,
	   AttendanceMode,
	   CostCentre,
	   VTO,
	   CourseCode,
	   Calocc,
	   OfferType,
	   LearnerNo,
	   DOB,
	   FirstName,
	   LastName,
	   Quantity,
	   StartDate,
	   EndDate,
	   [Year],
	   [Month],
	   [Day],
	   Term,
	   ChangeType,
	   Marketing,
	   StatusName,
	   TaskStatusName,
	   Final_ChecklistStatus
from [tsEChecklist].[ChecklistActions] ca
GO
PRINT N'Creating View [eChecklist].[ChecklistActionsSummary]...';


GO

Create View [eChecklist].[ChecklistActionsSummary] as 
select [InstanceID],
	   [No_Checklists_Completed],
	   [No_Checklists_Cancelled]
from [tsEChecklist].[ChecklistActionsSummary] a
GO
PRINT N'Creating View [eChecklist].[ChecklistTemplates]...';


GO
Create View [eChecklist].[ChecklistTemplates] as 
select [CheckListId],
	[Version],
	[Sponsor],
	[CheckListAcronym],
	[CheckListName],
	[CheckListSponsors],
	[WULPublicName],
	[ImplementationDate],
	[CC_LastUpdated],
	[ReviewDate]
from [tsEChecklist].[ChecklistTemplates] ct
GO
PRINT N'Creating View [eChecklist].[echecklistRptPrompt]...';


GO

Create View [eChecklist].[echecklistRptPrompt] as
Select [Domain],
[Value],
[Description]
from [tsEChecklist].[echecklistRptPrompt]
GO
PRINT N'Altering Procedure [compliance].[PopulateAvetmissFeeRecord]...';


GO


--exec compliance.PopulateAvetmissFeeRecord

ALTER procedure compliance.PopulateAvetmissFeeRecord
as

	if object_id('tempdb..#feeList') is not null drop table #feeList

	select
		 fl.fee_record_code
		,fl.fes_record_type
		,fl.status
		,fl.matched_fee_record_code
		,fl.fes_associated_record
	into #feeList
	from edw.oneebs_ebs_0165_fees_list fl
	where _RecordCurrent = 1
	and _RecordDeleted = 0

	if object_id('tempdb..#seed') is not null drop table #seed
	select 
		fl.FEE_RECORD_CODE as start_fee_record_code,
		f2.fee_record_code as fee_record_code,
		case when f2.status = 'f' then f2.fee_record_code else 0 end as weight,
		f2.fes_associated_record
	into #seed
	from #feeList fl
		join #feeList f2 on f2.fee_record_code = CASE WHEN fl.fes_record_type = 'R' THEN fl.matched_fee_record_code ELSE fl.fee_record_code END

	create index IDX_seed_fee_record_code on #seed(fee_record_code)

	--------------------------

	--firstFeeRecord
	if object_id('tempdb..#firstFeeRecord') is not null drop table #firstFeeRecord
	;with cte_next as
	(
		select seed.start_fee_record_code, seed.fee_record_code, seed.fes_associated_record
		from #seed seed
		union all
		select t.start_fee_record_code, seed.fee_record_code, seed.fes_associated_record
		from cte_next t
			join #seed seed on t.fes_associated_record = seed.fee_record_code
	)
	select start_fee_record_code as fee_record_code, min(fee_record_code) as firstFeeRecord
	into #firstFeeRecord
	from cte_next
	group by start_fee_record_code
	option (maxrecursion 0)

	--------------------------
	--finalFeeRecord
	if object_id('tempdb..#finalFeeRecord') is not null drop table #finalFeeRecord
	;with cte_next as
	(
		select seed.start_fee_record_code, seed.fee_record_code, seed.weight, seed.fes_associated_record
		from #seed seed
		union all
		select t.start_fee_record_code, seed.fee_record_code, seed.weight, seed.fes_associated_record
		from cte_next t
			join #seed seed on t.fee_record_code = seed.fes_associated_record
	) 
	select start_fee_record_code as fee_record_code, case when max(weight) > 0 then max(weight) else max(fee_record_code) end as finalFeeRecord
	into #finalFeeRecord
	from cte_next
	group by start_fee_record_code
	option (maxrecursion 0)

	-- combine #firstFeeRecord and #finalFeeRecord and insert into the physical table
	truncate table compliance.AvetmissFeeRecord
	insert into compliance.AvetmissFeeRecord (FeeRecordCode, FirstFeeRecord, FinalFeeRecord)
	select f1.fee_record_code, f1.firstFeeRecord, f2.finalFeeRecord
	from #firstFeeRecord f1
		join #finalFeeRecord f2 on f1.fee_record_code = f2.fee_record_code

	if object_id('tempdb..#feeList') is not null drop table #feeList
	if object_id('tempdb..#seed') is not null drop table #seed
	if object_id('tempdb..#firstFeeRecord') is not null drop table #firstFeeRecord
	if object_id('tempdb..#finalFeeRecord') is not null drop table #finalFeeRecord
GO
PRINT N'Refreshing Procedure [UMD].[USP_RefreshUMDDataModel]...';


GO
EXECUTE sp_refreshsqlmodule N'[UMD].[USP_RefreshUMDDataModel]';


GO
PRINT N'Refreshing Procedure [compliance].[PopulatePeopleUnitLinks]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[PopulatePeopleUnitLinks]';


GO
--This SP will drop any masking from the Production environment.
EXEC dbo.spDropAllMasking
GO

GO
PRINT N'Update complete.';


GO
