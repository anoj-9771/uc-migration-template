/*
Deployment script for ZEASQLDBEDW01

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "ZEASQLDBEDW01"
:setvar DefaultFilePrefix "ZEASQLDBEDW01"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (QUERY_CAPTURE_MODE = ALL, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367)) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE = OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_ATTAINMENTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [CATS_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPORTED_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_EXPORT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUP_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_COMMITMENT_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_EXPORT_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_DLRawZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_DLTrustedZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_RecordEnd] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_RecordStart] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [AIM_END] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [AIM_START] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [END_POINT_ASSESSMENT_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [ESF_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_EXPIRY_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [NVQ_ACHIEVE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [ORIG_LEARN_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [PLANNED_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [_DLRawZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [_DLTrustedZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [_RecordEnd] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [_RecordStart] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [ACTIONED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [ACTUAL_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [EFFECTIVE_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_PROGRESS_RECORDS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_DLRawZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_DLTrustedZoneTimeStamp] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_RecordEnd] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_RecordStart] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [_transaction_date] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [ACTUAL_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [ACTUAL_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [CREATED_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [PLANNED_END_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [PLANNED_START_DATE] DATETIME2 (7) NULL;

ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [UPDATED_DATE] DATETIME2 (7) NULL;


GO
PRINT N'Creating Table [edw].[OneEBS_EBS_0165_AWARDS_ORIGINAL]...';


GO
CREATE TABLE [edw].[OneEBS_EBS_0165_AWARDS_ORIGINAL] (
    [ID]                            NUMERIC (10)                                     NULL,
    [CODE]                          VARCHAR (20)                                     NULL,
    [TITLE]                         VARCHAR (60)                                     NULL,
    [DESCRIPTION]                   VARCHAR (240)                                    NULL,
    [SDR_QUALIFICATION_CODE]        VARCHAR (6)                                      NULL,
    [USER_1]                        VARCHAR (240)                                    NULL,
    [USER_2]                        VARCHAR (240)                                    NULL,
    [USER_3]                        VARCHAR (240)                                    NULL,
    [USER_4]                        VARCHAR (240)                                    NULL,
    [USER_5]                        VARCHAR (240)                                    NULL,
    [USER_6]                        VARCHAR (240)                                    NULL,
    [USER_7]                        VARCHAR (240)                                    NULL,
    [USER_8]                        VARCHAR (240)                                    NULL,
    [USER_9]                        VARCHAR (240)                                    NULL,
    [USER_10]                       VARCHAR (240)                                    NULL,
    [USER_11]                       VARCHAR (240)                                    NULL,
    [USER_12]                       VARCHAR (240)                                    NULL,
    [IS_ACTIVE]                     VARCHAR (1)                                      NULL,
    [CREATED_BY]                    VARCHAR (30)                                     NULL,
    [CREATED_DATE]                  DATETIME2 (7)                                    NULL,
    [UPDATED_BY]                    VARCHAR (30)                                     NULL,
    [UPDATED_DATE]                  DATETIME2 (7)                                    NULL,
    [COURSE_CREDITS]                NUMERIC (3) MASKED WITH (FUNCTION = 'default()') NULL,
    [SDR_REGISTER_LEVEL]            NUMERIC (10)                                     NULL,
    [TRANSCRIPT_ID]                 NUMERIC (10)                                     NULL,
    [AWARD_CATEGORY_CODE]           VARCHAR (3)                                      NULL,
    [GRADING_SCHEME_ID]             NUMERIC (10)                                     NULL,
    [NATIONAL_CODE]                 VARCHAR (20)                                     NULL,
    [SPECIALISATION]                VARCHAR (1000)                                   NULL,
    [CONFIGURABLE_STATUS_ID]        NUMERIC (10)                                     NULL,
    [PUBLISHED]                     VARCHAR (1)                                      NULL,
    [REGULATION_SCHEME_ID]          NUMERIC (10)                                     NULL,
    [INSTITUTION_CONTEXT_ID]        NUMERIC (10)                                     NULL,
    [COUNT_OUTCOMES_MULTIPLE_TIMES] VARCHAR (1)                                      NULL,
    [_transaction_date]             DATETIME2 (7)                                    NULL,
    [year]                          NVARCHAR (MAX)                                   NULL,
    [month]                         NVARCHAR (MAX)                                   NULL,
    [day]                           NVARCHAR (MAX)                                   NULL,
    [_DLRawZoneTimeStamp]           DATETIME                                         NULL,
    [_DLTrustedZoneTimeStamp]       DATETIME                                         NULL,
    [_RecordStart]                  DATETIME                                         NULL,
    [_RecordEnd]                    DATETIME                                         NULL,
    [_RecordDeleted]                INT                                              NULL,
    [_RecordCurrent]                INT                                              NULL
);


GO
PRINT N'Creating Table [edw].[OneEBS_EBS_0165_UI_ACCREDITATION]...';


GO
CREATE TABLE [edw].[OneEBS_EBS_0165_UI_ACCREDITATION] (
    [ACCREDITATION_AUTHORITY]   VARCHAR (10)   NULL,
    [APPLICATION]               VARCHAR (2000) NULL,
    [ARTICULATION_ARRANGEMENT]  VARCHAR (2000) NULL,
    [ASSESSMENT_STRATEGIES]     VARCHAR (2000) NULL,
    [CONSULTATION]              VARCHAR (2000) NULL,
    [COPYRIGHT_ACKNOWLEDGEMENT] VARCHAR (2000) NULL,
    [CREATED_BY]                VARCHAR (30)   NULL,
    [CREATED_DATE]              DATETIME2 (7)  NULL,
    [DAYS_CURRENCY]             NUMERIC (4)    NULL,
    [FRANCHISING]               VARCHAR (2000) NULL,
    [ID]                        NUMERIC (10)   NULL,
    [INSTITUTION_CONTEXT_ID]    NUMERIC (10)   NULL,
    [LICENSING_INFORMATION]     VARCHAR (2000) NULL,
    [ONGOING_MONITORING]        VARCHAR (2000) NULL,
    [OUTCOMES]                  VARCHAR (2000) NULL,
    [PHYSICAL_RESOURCES]        VARCHAR (2000) NULL,
    [SUBMISSION_TYPE]           VARCHAR (10)   NULL,
    [UNIT_INSTANCE_CODE]        VARCHAR (20)   NULL,
    [UPDATED_BY]                VARCHAR (30)   NULL,
    [UPDATED_DATE]              DATETIME2 (7)  NULL,
    [_transaction_date]         DATETIME2 (7)  NULL,
    [_DLRawZoneTimeStamp]       DATETIME2 (7)  NULL,
    [year]                      NVARCHAR (MAX) NULL,
    [month]                     NVARCHAR (MAX) NULL,
    [day]                       NVARCHAR (MAX) NULL,
    [_DLTrustedZoneTimeStamp]   DATETIME2 (7)  NULL,
    [_RecordStart]              DATETIME2 (7)  NULL,
    [_RecordEnd]                DATETIME2 (7)  NULL,
    [_RecordDeleted]            INT            NULL,
    [_RecordCurrent]            INT            NULL
);


GO
PRINT N'Altering View [compliance].[vwAvetmissUnit]...';


GO





ALTER VIEW [compliance].[vwAvetmissUnit]--[vwAvetmissUnit]  --[VWUNIT_UNITS] 
AS 

WITH EnrolmentDetailFields AS
  (SELECT  DISTINCT 
			ReportingYear
		   ,InstituteId
		  , AvetmissUnitCode
   FROM [compliance].[AvetmissUnitEnrolment]
   WHERE AvetmissUnitEnrolment._RecordCurrent = 1 
  and AvetmissUnitEnrolment._RecordDeleted = 0
   and  LEFT(ReportingYear, 2) = 'CY' 
   ),

   UnitRank as (Select 
				 RANK() OVER   
					(PARTITION BY ac.UnitCode ORDER BY AC.unitStatus ) AS Rank  
				,unitcode, unitStatus
				from [compliance].[AvetmissUnit] ac
				where _RecordCurrent = 1
				and _RecordDeleted = 0
				)

--Pre Adding CY to ID Fields--SELECT DISTINCT cast(concat(right(ce.ReportingYear, 4) , ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UUI' ,
SELECT DISTINCT cast(concat(ce.ReportingYear , ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UUI' ,
				--cast(concat( ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UUI' ,
               -- ID_UUI,
--Pre Adding CY to ID Fields--cast(concat(right(ce.ReportingYear, 2) , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UNIT',
				cast(concat(ce.ReportingYear , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UNIT',
                ce.InstituteId AS INSTITUTE,
                ac.AnimalUseName AS 'Animal Use',
                CASE
                    WHEN ac.OccupationCode IS NOT NULL THEN CONCAT(ac.OccupationCode, ' ', ac.OccupationName)
                    ELSE NULL
                END AS 'ANZSCO',
                CASE
                    WHEN [IndustryCode] IS NOT NULL THEN CONCAT([IndustryCode], ' ', [IndustryName])
                    ELSE NULL
                END AS 'ANZSIC',
                CASE
                    WHEN ac.FieldOfEducationId IS NOT NULL THEN CONCAT(ac.FieldOfEducationId, ' ', ac.FieldOfEducationName)
                    ELSE NULL
                END AS 'Field of Education',
                ac.IsVocational AS 'Is Vocational',
                CASE
                    WHEN ac.ScopeApproved = 'Y' THEN 'Yes - Scope Approved'
                    WHEN ac.ScopeApproved = 'N' THEN 'No - Scope Approved'
                    ELSE NULL
                END AS 'Scope Approved',
                ac.[NationalCourseCode] AS 'National Course Code',
                ac.[UnitStatus] AS 'Product Status',
                NULL AS 'Program Area' --This is now out of scope See PRADA-1012 for confirmation
,
                CASE
                    WHEN ac.ResourceAllocationModelCategoryCode IS NOT NULL THEN CONCAT(ac.ResourceAllocationModelCategoryCode, ' ', ac.ResourceAllocationModelCategoryName)
                    ELSE NULL
                END AS RAM,
  --ESCNM.ESCNM_Description as Sponsor   --           [Sponsor] AS 'Sponsor' --PRADA-1014 created as a missing field
  Coalesce(Replace (ESCNM.ESCNM_Description, '?', ' '), '_UNKNOWN') as Sponsor   --           [Sponsor] AS 'Sponsor' --PRADA-1014 created as a missing field
,
                [TGAUnitName] AS 'TGA Unit Name' --PRADA-1015 bug raised as all records are null
,
                UnitCategory AS 'Unit Category' ,
                --isnull(UPPER([RecommendedUsage]), '') AS 'Recommended Usage',
                UPPER([RecommendedUsage]) AS 'Recommended Usage',
                ac.[UnitCode] AS 'Unit Code',
                [UnitName] AS 'Unit Name',
				-- right(rp.ReportingYear, 4) AS 'EXTRACT_DATE'
			--	 year(Getdate()) AS 'EXTRACT_DATE'
			Right(ce.ReportingYear,4)  AS 'EXTRACT_DATE'
   -- select * from     [reference].[CommencingProgramIdentifierunitesc]
--Select unitesc.*, escnm.*

FROM [compliance].[AvetmissUnit] ac
join UnitRank ur on ur.UnitCode = ac.UnitCode and ur.Rank = 1 and ac.UnitStatus = ur.UnitStatus
JOIN EnrolmentDetailFields ce ON ce.AvetmissUnitCode = ac.UnitCode
left join  [reference].[CommencingProgramIdentifierunitesc] unitesc on unitesc.UNITesc = ac.NationalCourseCode and unitesc._RecordCurrent = 1 and unitesc._RecordDeleted = 0
left join  [reference].[CommencingProgramIdentifierescnm]  escnm on escnm.ESCNM = UNITesc.ESCNM and escnm._RecordCurrent = 1 and escnm._RecordDeleted = 0
--JOIN
  --(SELECT DISTINCT ReportingYear
  -- FROM [compliance].[AvetmissReportingPeriod]
  -- WHERE ReportingDate <= GETDATE() 
  -- and _RecordCurrent = 1 
  -- and _RecordDeleted = 0
  -- ) rp ON ce.ReportingYear = rp.ReportingYear

WHERE LEFT(ce.ReportingYear, 2) = 'CY' 
and ac._RecordCurrent = 1 
and ac._RecordDeleted = 0
and ((cast(concat(right(ce.ReportingYear, 2) , ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) in ('20127NSWTPLG107A', '20165CUAVSS301') and ac.[UnitStatus] = 'CURRENT') or cast(concat(right(ce.ReportingYear, 2) , ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) not in ('20127NSWTPLG107A', '20165CUAVSS301'))
and not (cast(concat(right(ce.ReportingYear, 2) , ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30))  in ( '20357NSWTPLG107A','20167CUAVSS301') and ac.UnitStatus = 'OBSOLETE')
GO
PRINT N'Altering View [compliance].[vwAvetmissUnitOffering]...';


GO











ALTER VIEW [compliance].[vwAvetmissUnitOffering]
AS 

WITH EnrolmentDetailFields AS
  (SELECT DISTINCT ReportingYear ,
                   InstituteId ,
                   UnitOfferingId ,
                   AvetmissUnitCode
   FROM compliance.AvetmissUnitEnrolment
   WHERE LEFT(ReportingYear, 2) = 'CY' )
SELECT CAST (concat(ce.ReportingYear , ce.InstituteId , cast((convert(bigint,Uo.UnitOfferingID)) AS varchar(20))) AS VARCHAR) AS 'ID_UUIO' ,
            cast(concat(ce.ReportingYear, ce.InstituteId , ce.AvetmissUnitCode) AS varchar(30)) AS 'ID_UUI' ,
            ce.InstituteId,
            convert(date, OfferingStartDate) AS 'Start Date',
            DAY(convert(date, OfferingStartDate)) AS 'Start Date Day',
            DATENAME(MONTH, convert(date, OfferingStartDate)) AS 'Start Date Month',
            YEAR(convert(date, OfferingStartDate)) AS 'Start Date Year',
            MONTH(convert(date, OfferingStartDate)) AS SORT_SD,
            convert(date, OfferingEndDate) AS 'End Date',
            DAY(convert(date, OfferingEndDate)) AS 'End Date Day',
            DATENAME(MONTH, convert(date, OfferingEndDate)) AS 'End Date Month',
            YEAR(convert(date, OfferingEndDate)) AS 'End Date Year',
            MONTH(convert(date, OfferingEndDate)) AS SORT_ED,
--            AttendanceModeDescription AS 'Attendance Code',
  
			CASE AttendanceModeDescription  
			WHEN 'Full Time Connected Learning' 
			THEN 'Full Time'
			
			WHEN 'Part Time Connected Learning' 
			THEN 'Part Time' 
			
			WHEN 'Part Time Day Connected Learning' 
			THEN 'Part Time Day' 
			
			WHEN 'Part Time Evening Connected Learning' 
			THEN 'Part Time Evening' 
			
			ELSE AttendanceModeDescription  END AS 'Attendance Code', 
  
            CaloccOccurrenceCode AS 'Calocc Code',
           compliance.ProperCase( uo.DeliveryModeDescription ) AS 'Offering Delivery Mode',
            MAXIMUMHOURS AS 'Maximum Hours',
            OFFERINGCODE AS 'Offering Code',
           CASE When OfferingFundingSource = '7201' then '7201 CSO – Youth Engagement Strategy'
                WHEN OfferingFundingSource IS NOT NULL THEN OfferingFundingSource+ ' ' + FundingSource.FundingSourceDescription
                ELSE NULL
            END AS 'Offering Funding Source',
            OfferingCostCentreCode AS 'Offering Cost Centre Code',

            Case 
			when OfferingCostCentre is not null
			 and LEn(OfferingCostCentre) <> 4
			 and SUBSTRING (OfferingCostCentre,4,1) = '-' 
			then TRIM(SUBSTRING (OfferingCostCentre,5,999)) 

			when OfferingCostCentre is not null and OfferingCostCentre not in ('', ' ')
			Then TRIM(OfferingCostCentre)
			Else Null end  AS 'Offering Cost Centre',
			
			--else TRIM(ISNULL(OfferingCostCentre,'')) end  AS 'Offering Cost Centre',
            left(OfferingCostCentreCode, 4) AS 'Offering Teaching Unit',
            OFFERINGSTATUS AS 'Offering Status',
            OfferingType.OfferingTypeDescription AS 'Offering Type',
            		CASE enrloc.LocationName
			WHEN  'Blue Mountain' THEN 'Blue Mountains'
			WHEN  'B2B / Partner' THEN 'Business to Business/Partnership'
			WHEN  'Coffs Hbr Edc' THEN 'Coffs Harbour Education'
			WHEN  'Flx E Trn Ill' THEN 'Flex E Training'
			WHEN  'Lake Cargelli' THEN 'Lake Cargelligo'
			WHEN  'Lightning Rid' THEN 'Lightning Ridge'
			WHEN  'Macquarie Fie' THEN 'Macquarie Fields'
			WHEN  'Nat Env Ctre' THEN 'National Environmental Centre'
			WHEN  'Nci Open Camp' THEN 'NCI Open Campus'
			WHEN  'New Eng Campu' THEN 'New Eng Campus'
			WHEN  'N Beaches' THEN 'Northern Beaches'
			WHEN 'OTEN' THEN 'OTEN - Distance Education'
			WHEN 'Pt Macquarie' THEN 'Port Macquarie'
			WHEN 'Prim Ind Cent' THEN 'Primary Industries Centre'
			WHEN 'RI Learn Onli' THEN 'Riverina Institute Learn Online'
			WHEN 'Western Conne' THEN 'Western Connect'
			WHEN 'WSI Business' THEN 'Western Sydney Institute Business'
			WHEN 'Wetherill Pk' THEN 'Wetherill Park'
			WHEN 'Wit Access Un' THEN 'WIT Access Unit'
			WHEN 'Wollongong W' THEN 'Wollongong West'
			WHEN 'WSI Internati' THEN 'WSI International'
			WHEN 'Swsi Internat' THEN 'SWSI International'
			WHEN 'Online' Then 'Online Campus'
			WHEN 'Clarence CC' Then 'Grafton'
			else enrloc.LocationName 
		end AS 'Offering Enrolment Location',
            OfferingDeliveryLocation AS 'Offering Delivery Location',
            right(ce.ReportingYear, 4) AS 'EXTRACT_DATE',
			NULL INSTITUTE																															/*FIX ME: */


FROM compliance.AvetmissUnitOffering uo--.

JOIN EnrolmentDetailFields ce ON ce.UnitOfferingId = uo.UnitOfferingId
LEFT JOIN compliance.AvetmissLocation enrloc ON uo.OfferingEnrolmentLocation = enrloc.LocationDescription
AND enrloc._RecordCurrent = 1
AND enrloc._RecordDeleted = 0
LEFT JOIN compliance.AvetmissLocation delloc ON uo.OfferingDeliveryLocation = delloc.LocationCode
AND delloc._RecordCurrent = 1
AND delloc._RecordDeleted = 0
LEFT JOIN reference.FundingSource ON FundingSource.FundingSourceCode = uo.OfferingFundingSource
LEFT JOIN reference.OfferingType ON OfferingType.OfferingTypeCode = uo.OfferingType
WHERE 1=1 
  AND left(ce.ReportingYear, 2) = 'CY'
GO
PRINT N'Creating View [OneEBS].[900_UI_Links]...';


GO





CREATE   view [OneEBS].[900_UI_Links] AS  Select * from edw.OneEBS_EBS_0900_UI_LINKS WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[900_Unit_Instances]...';


GO
Create   view OneEBS.[900_Unit_Instances] AS  Select * from edw.OneEBS_EBS_0900_UNIT_INSTANCES WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[900_Verifier_Properties]...';


GO
Create   view OneEBS.[900_Verifier_Properties] AS  Select * from edw.OneEBS_EBS_0900_VERIFIER_PROPERTIES WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[900_Verifiers]...';


GO
Create   view OneEBS.[900_Verifiers] AS  Select * from edw.OneEBS_EBS_0900_VERIFIERS WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Addresses]...';


GO


Create   view [OneEBS].[Addresses] AS  
Select [OWNER_REF]
      ,[OWNER_TYPE]
      ,[ADDRESS_CODE]
      ,[ADDRESS_TYPE]
      ,[START_DATE]
      ,[END_DATE]
      ,[ADDRESS_LINE_1]
      ,[ADDRESS_LINE_2]
      ,[ADDRESS_LINE_3]
      ,[ADDRESS_LINE_4]
      ,[ADDRESS_LINE_5]
      ,[TOWN]
      ,[TELEPHONE]
      ,[UK_POST_CODE_PT1]
      ,[UK_POST_CODE_PT2]
      ,[INTERNATIONAL_POST_CODE]
      ,[FAX]
      ,[REGION]
      ,[COUNTRY]
      ,[EMAIL_ADDRESS]
      ,[EXTENSION_TEL_NO]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[MAILSORT_CODE]
      ,[FES_CONTACT_NAME]
      ,[FES_TELEPHONE_LINE_2]
      ,[EASTING]
      ,[NORTHING]
      ,[NOTES_ID]
      ,[OLIB_ADDRNO]
      ,[PERSON_CODE]
      ,[UCAS_RECORD]
      ,[UCAS_RD_NUMBER]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[ACCOMMODATION_TYPE]
      ,[REGION_AREA]
      ,[FUNDING_YEAR]
      ,[INSTITUTION_CONTEXT_ID]
      ,[UNIQUE_DELIVERY_POINT_REF_NO]
      ,[LOCATION_TYPE]
      ,[COUNTRY_CODE]
      ,[LATITUDE]
      ,[LONGITUDE]
      ,[TERRITORIAL_AUTHORITY_CODE] from edw.OneEBS_EBS_0165_ADDRESSES 
	  WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Attached_Waiver_Values]...';


GO

Create   view [OneEBS].[Attached_Waiver_Values] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ATTACHMENT_ID]
      ,[CHARGE_LEVEL]
      ,[RUL_CODE]
      ,[REGISTRATION_CODE]
      ,[WAIVER_VALUE_NUMBER]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[EVIDENCE_ACCEPTED]
      ,[NOTES_ID]
	   from edw.OneEBS_EBS_0165_ATTACHED_WAIVER_VALUES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Attainment_Links]...';


GO

Create   view [OneEBS].[Attainment_Links] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ATT_ATTAINMENT_CODE_TO]
      ,[ATT_ATTAINMENT_CODE_FROM]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[CONTRIBUTES_TO_AWARD_OUTCOME] 
from edw.OneEBS_EBS_0165_ATTAINMENT_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Attainments]...';


GO

Create   view [OneEBS].[Attainments] AS  
Select [ATTAINMENT_CODE]
      ,[ATYPE_ATTAINMENT_TYPE_CODE]
      ,[TOPIC_TOPIC_CODE]
      ,[DESCRIPTION]
      ,[OUTCOME]
      ,[MARK]
      ,[CATS_LEVEL]
      ,[DATE_CONFERRED]
      ,[DATE_AWARDED]
      ,[GRADE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[PER_PERSON_CODE]
      ,[CATS_CREDITS]
      ,[FES_THIS_INST]
      ,[FES_QUALIFICATION_AIM]
      ,[FES_YEAR_ACHIEVED]
      ,[FES_EXAM_BOARD]
      ,[FES_EXAM_TYPE]
      ,[FES_PREDICTED_GRADE]
      ,[FES_GRADE_ISR]
      ,[FES_ISR]
      ,[FES_NCVQ_REF]
      ,[FES_NCVQ_LEVEL]
      ,[FES_FUNDING_YEAR]
      ,[LOCAL_QOE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[PEOPLE_UNITS_ID]
      ,[SDR_QUALIFICATION_CODE]
      ,[MAIN_SUBJECT_1]
      ,[MAIN_SUBJECT_2]
      ,[MAIN_SUBJECT_3]
      ,[DATA_RETURN]
      ,[SDR_COMPLETION_RETURN_STATUS]
      ,[COURSE_CREDITS]
      ,[SDR_COURSE_CODE]
      ,[THEORY_HOURS]
      ,[PRACTICAL_HOURS]
      ,[AWARD_ID]
      ,[AWARD_STATUS]
      ,[SDR_REGISTER_LEVEL]
      ,[GRADING_SCHEME_ID]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[PRINT_COUNT]
      ,[ASSESSMENT_PROGRESS]
      ,[CONFIGURABLE_STATUS_ID]
      ,[NZQA_EXPORT_BATCH]
      ,[USER_19]
      ,[USER_20]
      ,[USER_21]
      ,[USER_22]
      ,[USER_23]
      ,[USER_24]
      ,[USER_25]
      ,[USER_26]
      ,[USER_27]
      ,[USER_28]
      ,[USER_29]
      ,[USER_30]
      ,[NZQA_ID]
      ,[PREVIOUS_FAILED_FINAL_RESULT]
      ,[AGGREGATE_SCORE]
      ,[ADJUSTED_GRADE]
      ,[LINKED_CAR_ID]
      ,[EXPIRY_DATE]
      ,[USER_31]
      ,[USER_32]
      ,[USER_33]
      ,[USER_34]
      ,[USER_35]
      ,[USER_36]
      ,[RECOGNITION_TYPE]
      ,[ORGANISATION_TYPE]
      ,[ORGANISATION_CODE]
      ,[EXPORTED_DATE]
      ,[AUTOCREDIT_STATUS]
      ,[HAS_MUST_PASS_ELEMENT_FAILED]
      ,[SOURCE]
      ,[SOURCE_ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[IS_CONDONED]
      ,[TARGET_GRADE]
      ,[WORKING_TO_GRADE]
      ,[EXTERNAL_PREDICTED_GRADE]
      ,[POINTS]
      ,[AMENDED_AGGREGATE_SCORE]
      ,[AAS_REQUESTED_BY]
      ,[AAS_AUTHORISED_BY]
      ,[SITTING]
      ,[HESA_QUAL_TYPE]
      ,[INCLUDE_IN_HESA] 
from edw.OneEBS_EBS_0165_ATTAINMENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Authority_To_Deliver]...';


GO


Create   view [OneEBS].[Authority_To_Deliver] AS  

Select [ID]
      ,[NATIONAL_COURSE_CODE]
      ,[LOCATION_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from [edw].[OneEBS_EBS_0165_AUTHORITY_TO_DELIVER]  
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Award_Attainment_Links]...';


GO

Create   view [OneEBS].[Award_Attainment_Links] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[PEOPLE_UNIT_ID]
      ,[AWARD_ID]
      ,[ATTAINMENT_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[CONTRIBUTES_TO_AWARD_OUTCOME] 
from edw.OneEBS_EBS_0165_AWARD_ATTAINMENT_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Award_Rulesets]...';


GO

Create   view [OneEBS].[Award_Rulesets] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[AWARD_ID]
      ,[RULESET_ID]
      ,[START_DATE]
      ,[END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_AWARD_RULESETS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Awards]...';


GO

Create   view [OneEBS].[Awards] AS  
Select [ID]
      ,[CODE]
      ,[TITLE]
      ,[DESCRIPTION]
      ,[SDR_QUALIFICATION_CODE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[IS_ACTIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[COURSE_CREDITS]
      ,[SDR_REGISTER_LEVEL]
      ,[TRANSCRIPT_ID]
      ,[AWARD_CATEGORY_CODE]
      ,[GRADING_SCHEME_ID]
      ,[NATIONAL_CODE]
      ,[SPECIALISATION]
      ,[CONFIGURABLE_STATUS_ID]
      ,[PUBLISHED]
      ,[REGULATION_SCHEME_ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[COUNT_OUTCOMES_MULTIPLE_TIMES] 
from edw.OneEBS_EBS_0165_AWARDS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Awards_Printed_Details]...';


GO

Create   view [OneEBS].[Awards_Printed_Details] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[ATTAINMENT_CODE]
      ,[TESTAMUR_DATE_LAST_PRINTED]
      ,[TRANSCRIPT_DATE_LAST_PRINTED]
      ,[EMPLOYER_REPORT_LAST_PRINTED]
      ,[HAS_TRANSCRIPT_CHANGED]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_AWARDS_PRINTED_DETAILS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Communications]...';


GO

Create   view [OneEBS].[Communications] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[IS_ACTIVE]
      ,[HAS_BEEN_PRINTED]
      ,[ID]
      ,[LEARNER_ID]
      ,[FORMAT]
      ,[RECIPIENT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[SUBJECT]
      ,[BODY]
      ,[SOURCE_ID]
      ,[SOURCE]
      ,[BLOB_ID]
      ,[PARENT_ID]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FORMAT_TYPE] 
from edw.OneEBS_EBS_0165_COMMUNICATIONS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Configurable_Statuses]...';


GO

Create   view [OneEBS].[Configurable_Statuses] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[INCLUDE_IN_DATA_RETURN]
      ,[ID]
      ,[STATUS_CODE]
      ,[SHORT_DESCRIPTION]
      ,[LONG_DESCRIPTION]
      ,[ACTIVE]
      ,[CONTRIBS_COURSE_OUTCOMES]
      ,[LEARNER_VIEWABLE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[LINKED_ROLE]
      ,[STATUS_TYPE]
      ,[CONTRIBS_AWARD_OUTCOMES]
      ,[SUBMIT_TO_NZQA]
      ,[INCLUDED_IN_SDR]
      ,[BAD_DEBT_CHECK]
      ,[IS_PUBLISHABLE]
      ,[CAN_UPDATE_PROGRESS] 
from edw.OneEBS_EBS_0165_CONFIGURABLE_STATUSES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Course_Assessments]...';


GO

Create   view [OneEBS].[Course_Assessments] AS  
Select [ID]
      ,[OBJECT_TYPE]
      ,[OBJECT_ID]
      ,[DESCRIPTION]
      ,[CRS_ASSESSMENT_TYPE]
      ,[HE_ASSESSMENT_SEQUENCE]
      ,[WEIGHTING_PERCENT]
      ,[DUE_DATE]
      ,[GRADING_SCHEME_ID]
      ,[NZQA_ID]
      ,[LOCATION_CODE]
      ,[OWNING_ORGANISATION]
      ,[REQUIRED_THEORY_HOURS]
      ,[REQUIRED_PRACTICAL_HOURS]
      ,[PLANNED_START_DATE]
      ,[PLANNED_END_DATE]
      ,[NUMBER_OF_RESITS]
      ,[ALLOW_AEGROTATS]
      ,[ALLOW_EXTENSIONS]
      ,[FES_ACTIVE]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[MARKS_OUT_OF]
      ,[MUST_PASS]
      ,[ASSESSMENT_CODE]
      ,[IS_MANDATORY]
      ,[MIN_PASS_MARK]
      ,[MANDATORY_ENROL]
      ,[REQUIRES_OUTCOME]
      ,[ASSESSMENT_INSTRUCTIONS]
      ,[ASSESSOR_INSTRUCTIONS]
      ,[HAS_BEST_RESULT]
      ,[INSTITUTION_CONTEXT_ID]
      ,[SORT_ORDER] 
from edw.OneEBS_EBS_0165_COURSE_ASSESSMENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Course_Assessments_Results]...';


GO

Create   view [OneEBS].[Course_Assessments_Results] AS  
Select [ID]
      ,[PEOPLE_UNITS_ID]
      ,[COURSE_ASSESSMENTS_ID]
      ,[ASSESSMENT_DATE]
      ,[ATTEMPT_NUMBER]
      ,[STATUS]
      ,[MITIGATING_CIRCS]
      ,[MITIGATING_CIRCS_ACCEPTED]
      ,[REASON_FOR_ZERO_MARK]
      ,[RESULT]
      ,[INTERNAL_SCORE]
      ,[IS_AEGROTAT]
      ,[DUE_DATE]
      ,[ACTUAL_THEORY_HOURS]
      ,[ACTUAL_PRACTICAL_HOURS]
      ,[ACTUAL_START_DATE]
      ,[ACTUAL_END_DATE]
      ,[DATE_COMPLETED]
      ,[FES_ACTIVE]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[ATTAINMENT_ID]
      ,[CONFIGURABLE_STATUS_ID]
      ,[ADJUSTED_RESULT]
      ,[BEST_RESULT]
      ,[DATE_SUBMITTED]
      ,[DATE_MARKED]
      ,[ENHANCED_MARK_CODE]
      ,[ENHANCED_MARK_COMMENTS]
      ,[INSTITUTION_CONTEXT_ID]
      ,[AMENDMENT_REASON]
      ,[AMENDMENT_REQUESTED_BY]
      ,[AMENDMENT_AUTHORISED_BY] 
from edw.OneEBS_EBS_0165_COURSE_ASSESSMENTS_RESULTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Disabilities]...';


GO

Create   view [OneEBS].[Disabilities] AS  
Select [ID]
      ,[DISABILITY_TYPE]
      ,[PER_PERSON_CODE]
      ,[START_DATE]
      ,[END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[ASSESSMENT_ID]
      ,[FES_ISR_DISABILITY]
      ,[FES_LONG_DESCRIPTION]
      ,[FES_SHORT_DESCRIPTION]
      ,[NOTES_ID]
      ,[PRIMARY_NEED]
      ,[SPECIAL_EXAM_NEEDS]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[USER_19]
      ,[USER_20]
      ,[USER_21]
      ,[USER_22]
      ,[USER_23]
      ,[USER_24]
      ,[USER_25]
      ,[USER_26]
      ,[USER_27]
      ,[USER_28]
      ,[USER_29]
      ,[USER_30]
      ,[USER_31]
      ,[USER_32]
      ,[IS_ASSISTANCE_REQUIRED]
      ,[INSTITUTION_CONTEXT_ID]
      ,[DATA_RETURN] 
from edw.OneEBS_EBS_0165_DISABILITIES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fee_Categories]...';


GO

Create   view [OneEBS].[Fee_Categories] AS  
Select [AUTOPROGRESS_ONLY_IF_ZERO_FEES]
      ,[FEE_CATEGORY_CODE]
      ,[LONG_DESCRIPTION]
      ,[TRANSACTION_TYPE]
      ,[PRIORITY]
      ,[ACCOUNT_CODE]
      ,[GL_COMPONENT_1]
      ,[GL_COMPONENT_2]
      ,[GL_COMPONENT_3]
      ,[GL_COMPONENT_4]
      ,[TAX_CODE]
      ,[ALLOW_REFUND]
      ,[CHARGE_ONCE]
      ,[ROLE_DEFS_ID]
      ,[IS_ENFORCEABLE_DEBT]
      ,[IS_ACTIVE]
      ,[IS_ELIGIBLE_FOR_INSTALMENTS]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[IS_GIFT]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_FEE_CATEGORIES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fee_Type_Waivers]...';


GO

Create   view [OneEBS].[Fee_Type_Waivers] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[FEE_TYPE]
      ,[WAIVER_CODE]
      ,[WAIVER_ORDER]
      ,[CUMULATIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[ID] 
from edw.OneEBS_EBS_0165_FEE_TYPE_WAIVERS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fee_Types]...';


GO

Create   view [OneEBS].[Fee_Types] AS  
Select [FEE_TYPE_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[TUITION_TYPE_FEE]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG]
      ,[FES_VAT_CODE]
      ,[FES_ACCOUNT_CODE]
      ,[FES_TRANSACTION_TYPE]
      ,[FES_ISR]
      ,[LATE_FEE]
      ,[REFERRAL_FEE]
      ,[PRIORITY]
      ,[INCLUDE_IN_RETURN]
      ,[SDR_TYPE]
      ,[ALLOW_REFUND]
      ,[ROUNDING_MULTIPLE]
      ,[MIN_VALUE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[CHARGE_ONCE]
      ,[ROLE_DEFS_ID]
      ,[IS_ENFORCEABLE_DEBT]
      ,[IS_TEMP_VISA_HOLDER_FEE]
      ,[ENROLMENT_DURATION]
      ,[IS_ELIGIBLE_FOR_INSTALMENTS]
      ,[IS_GIFT]
      ,[GL_COMPONENT_1]
      ,[GL_COMPONENT_2]
      ,[GL_COMPONENT_3]
      ,[GL_COMPONENT_4]
      ,[FEE_CATEGORY_CODE]
      ,[IS_ACTIVE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[IS_ELIGIBLE_FOR_FEES_FREE] 
from edw.OneEBS_EBS_0165_FEE_TYPES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fee_Values]...';


GO

Create   view [OneEBS].[Fee_Values] AS  
Select [FEE_VALUE_NUMBER]
      ,[FEE_TYPE_CODE]
      ,[CHARGE_LEVEL]
      ,[UNIT_INSTANCE_CODE]
      ,[CALOCC_CTYPE]
      ,[CALOCC_CODE]
      ,[CP_FLAG_DEL]
      ,[AMOUNT_PAYABLE]
      ,[VAT_CODE]
      ,[TRANSACTION_TYPE]
      ,[ACCOUNT_CODE]
      ,[FUNDING_YEAR]
      ,[START_DATE]
      ,[END_DATE]
      ,[BOARD_CODE]
      ,[BOARD_OCCURRENCE]
      ,[SERIES]
      ,[DEFAULT_INCLUDE]
      ,[OVERSEAS_AMOUNT]
      ,[EXAM_CODE]
      ,[CFACS_PRODUCT_ID]
      ,[PAYEES]
      ,[PRICE_BAND_ID]
      ,[PRICE_BAND_VALUE]
      ,[UIO_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[NO_OF_OVERSEAS_PAYERS]
      ,[IS_STUDYLINK]
      ,[DOMESTIC_FCR_AMOUNT]
      ,[FEE_CALCULATION_METHOD]
      ,[ALLOW_REFUND]
      ,[ROUNDING_MULTIPLE]
      ,[MIN_VALUE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[CHARGE_ONCE]
      ,[IS_TEMP_VISA_HOLDER_FEE]
      ,[GL_COMPONENT_1]
      ,[GL_COMPONENT_2]
      ,[GL_COMPONENT_3]
      ,[GL_COMPONENT_4]
      ,[GL_COMPONENT_5]
      ,[UNIT_OF_STUDY_CODE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ROLL_FORWARD_SOURCE_FV_NUMBER]
      ,[IS_ELIGIBLE_FOR_FEES_FREE] 
from edw.OneEBS_EBS_0165_FEE_VALUES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fees_List]...';


GO

Create   view [OneEBS].[Fees_List] AS  
Select [ID]
      ,[FEE_RECORD_CODE]
      ,[MATCHED_FEE_RECORD_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[AMOUNT]
      ,[BOARD_CODE]
      ,[BOARD_OCCURRENCE]
      ,[CALOCC_CALENDAR_TYPE]
      ,[CALOCC_OCCURRENCE_CODE]
      ,[DATE_PRINTED]
      ,[DESCRIPTION]
      ,[EPAYMENT_TRANSACTION_ID]
      ,[EPAYMENT_STATUS_CODE]
      ,[EPAYMENT_STATUS]
      ,[EPAYMENT_EXTERNAL_REF]
      ,[EXAM_CODE]
      ,[EXAM_SERIES]
      ,[FEE_DATE]
      ,[FEE_VALUE_NUMBER]
      ,[FES_ASSOCIATED_RECORD]
      ,[FES_BAL_TO_UPDATE]
      ,[FES_FEE_TYPE]
      ,[FES_FUNDING_YEAR]
      ,[FES_GROSS_AMOUNT]
      ,[FES_PERSON_CODE]
      ,[FES_RECEIPT_NO]
      ,[FES_RECORD_TYPE]
      ,[FES_SPONSOR_CODE]
      ,[FES_TAX_FLAG]
      ,[FES_UINS_CODE]
      ,[FES_UIO_CTYPE]
      ,[FES_UIO_CALOCC]
      ,[FES_VAT_AMOUNT]
      ,[FES_VAT_CODE]
      ,[FES_VAT_RATE]
      ,[FES_WAIVER_TYPE]
      ,[FES_WAIVER_CTYPE]
      ,[FES_WAIVER_CALOCC]
      ,[FES_WHO_TO_PAY]
      ,[INSTALMENT_ID]
      ,[INTERNAL_INVOICE_CODE]
      ,[INTERNAL_INVOICE_DATE]
      ,[INVOICE_NUMBER]
      ,[INV_RUN_NUMBER]
      ,[INV_RUN_DATE]
      ,[NOTES_ID]
      ,[PAYMENT_METHOD]
      ,[REG_REGISTRATION_CODE]
      ,[RUL_CODE]
      ,[SFT_STUDENT_FEE_REF]
      ,[STATUS]
      ,[TILL_CODE]
      ,[WAIVER_VALUE_NUMBER]
      ,[ZERO_VALUE_FLAG]
      ,[Z_READ_DATE]
      ,[Z_READ_BATCH_ID]
      ,[TRANSACTION_ID]
      ,[TRANSACTION_TYPE]
      ,[TRANSACTION_DATE]
      ,[PROCESSED_STATE]
      ,[STUDYLINK_DATA_ID]
      ,[EXCLUDE_FROM_REFUND]
      ,[ORDER_NUMBER]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[ACCOUNT_CODE]
      ,[EFTPOS_TERMINAL_ID]
      ,[PERSON_FINANCIALLY_RESPONSIBLE]
      ,[HAS_APPEARED_ON_ASSIST_REPORT]
      ,[IS_DOUBTFUL]
      ,[IS_PREPAYMENT]
      ,[EXTERNAL_REFUND_PAYMENT_REF]
      ,[EXTERNAL_REFUND_PAYMENT_DATE]
      ,[IS_GIFT]
      ,[INVOICE_GROUP_ID]
      ,[NUMBER_OF_REMINDERS]
      ,[TENDERED_AMOUNT]
      ,[REJECTED_PAYMENT]
      ,[TILL_END_SESSION_ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[WAS_REFUND_CANCELLED]
      ,[REFUND_CANCELLATION_REASON]
      ,[UIO_RESERVATION_ID] 
from edw.OneEBS_EBS_0165_FEES_LIST 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fees_List_Allocated]...';


GO

Create   view [OneEBS].[Fees_List_Allocated] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ORIG_RECEIPT_FEE_RECORD_CODE]
      ,[ID]
      ,[FEE_RECORD_CODE]
      ,[FEE_VALUE_NUMBER]
      ,[PERSON_CODE]
      ,[STATUS]
      ,[AMOUNT_TEMP]
      ,[TYPE]
      ,[RECONCILED_BY]
      ,[RECONCILED_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[AMOUNT]
      ,[VAT_CODE]
      ,[VAT_AMOUNT]
      ,[VAT_RATE] 
from edw.OneEBS_EBS_0165_FEES_LIST_ALLOCATED 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fees_List_Special]...';


GO

Create   view [OneEBS].[Fees_List_Special] AS  
Select [ID]
      ,[FEES_LIST_ID]
      ,[BANK_ID]
      ,[ACCOUNT_NAME]
      ,[CHEQUE_NUMBER]
      ,[CARD_TYPE]
      ,[CARD_HOLDER_NAME]
      ,[STATEMENT_DETAILS]
      ,[REFERENCE_NUMBER]
      ,[DATE_BANKED]
      ,[GL_ACCOUNT]
      ,[COST_CENTRE]
      ,[SUB_ACCOUNT]
      ,[AUTHORISED_BY]
      ,[PAYER_AUTHORISATION_NO]
      ,[DEBTOR_NAME]
      ,[DEBTOR_ID]
      ,[PAYEE_NAME]
      ,[SWIFT_NUMBER]
      ,[NOTES_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[ELECTRONIC_PAYMENT_REF_NO]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_FEES_LIST_SPECIAL 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fees_List_Temp]...';


GO

Create   view [OneEBS].[Fees_List_Temp] AS  
Select [FEE_RECORD_CODE]
      ,[CALOCC_CALENDAR_TYPE]
      ,[CALOCC_OCCURRENCE_CODE]
      ,[AMOUNT]
      ,[FEE_DATE]
      ,[DESCRIPTION]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[SFT_STUDENT_FEE_REF]
      ,[STATUS]
      ,[FES_PERSON_CODE]
      ,[FES_RECORD_TYPE]
      ,[FES_UINS_CODE]
      ,[FES_UIO_CTYPE]
      ,[FES_UIO_CALOCC]
      ,[FES_FEE_TYPE]
      ,[FES_WHO_TO_PAY]
      ,[FES_BAL_TO_UPDATE]
      ,[FES_SPONSOR_CODE]
      ,[FES_GROSS_AMOUNT]
      ,[FES_WAIVER_TYPE]
      ,[FES_WAIVER_CTYPE]
      ,[FES_WAIVER_CALOCC]
      ,[FES_TAX_FLAG]
      ,[FES_ASSOCIATED_RECORD]
      ,[FES_VAT_AMOUNT]
      ,[FES_VAT_CODE]
      ,[FES_VAT_RATE]
      ,[FES_FUNDING_YEAR]
      ,[FES_RECEIPT_NO]
      ,[REG_REGISTRATION_CODE]
      ,[PAYMENT_METHOD]
      ,[TILL_CODE]
      ,[BOARD_CODE]
      ,[EXAM_CODE]
      ,[BOARD_OCCURRENCE]
      ,[EXAM_SERIES]
      ,[INVOICE_NUMBER]
      ,[INV_RUN_NUMBER]
      ,[INV_RUN_DATE]
      ,[ZERO_VALUE_FLAG]
      ,[RUL_CODE]
      ,[FEE_VALUE_NUMBER]
      ,[WAIVER_VALUE_NUMBER]
      ,[DATE_PRINTED]
      ,[NOTES_ID]
      ,[Z_READ_DATE]
      ,[INSTALMENT_ID]
      ,[EPAYMENT_TRANSACTION_ID]
      ,[EPAYMENT_STATUS_CODE]
      ,[EPAYMENT_STATUS]
      ,[EPAYMENT_EXTERNAL_REF]
      ,[ID]
      ,[MATCHED_FEE_RECORD_CODE]
      ,[INTERNAL_INVOICE_CODE]
      ,[INTERNAL_INVOICE_DATE]
      ,[Z_READ_BATCH_ID]
      ,[TRANSACTION_ID]
      ,[TRANSACTION_TYPE]
      ,[TRANSACTION_DATE]
      ,[PROCESSED_STATE]
      ,[ORDER_NUMBER]
      ,[ACCOUNT_CODE]
      ,[PERSON_FINANCIALLY_RESPONSIBLE]
      ,[HAS_APPEARED_ON_ASSIST_REPORT]
      ,[IS_DOUBTFUL]
      ,[IS_PREPAYMENT]
      ,[EXTERNAL_REFUND_PAYMENT_REF]
      ,[EXTERNAL_REFUND_PAYMENT_DATE]
      ,[INVOICE_GROUP_ID]
      ,[IS_GIFT]
      ,[NUMBER_OF_REMINDERS]
      ,[TENDERED_AMOUNT]
      ,[REJECTED_PAYMENT]
      ,[INSTITUTION_CONTEXT_ID]
      ,[WAS_REFUND_CANCELLED]
      ,[REFUND_CANCELLATION_REASON]
      ,[UIO_RESERVATION_ID] 
from edw.OneEBS_EBS_0165_FEES_LIST_TEMP 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Fees_List_Waivers]...';


GO

Create   view [OneEBS].[Fees_List_Waivers] AS  
Select [ID]
      ,[FEE_RECORD_CODE]
      ,[WAIVER_VALUE_NUMBER]
      ,[ATTACHMENT_ID]
      ,[WAIVER_ORDER]
      ,[CUMULATIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[EVIDENCE_ACCEPTED]
      ,[NOTES_ID]
      ,[ADJUSTMENT_AMOUNT]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_FEES_LIST_WAIVERS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Grading_Scheme_Grades]...';


GO

Create   view [OneEBS].[Grading_Scheme_Grades] AS  
Select [NOMINAL_GRADE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[WEIGHTING]
      ,[POINTS]
      ,[IS_DEFAULT_WITHDRAWAL_GRADE]
      ,[IS_DEFAULT_NONSTARTER_GRADE]
      ,[IS_EXCLUDED_FROM_DOCUMENTATION]
      ,[IS_PASS]
      ,[IS_EXTERNAL_GRADE]
      ,[IS_ACTIVE]
      ,[IS_FAILED_FINAL]
      ,[DEFAULT_FAILED_GRADE]
      ,[IS_NIL_GRADE]
      ,[IS_NOT_COMPLETE_GRADE]
      ,[INTERNALLY_MARKED]
      ,[IS_DEFAULT_AUTO_CREDIT]
      ,[STATE_COMPLETION_CODE]
      ,[PROGRESS_CODE]
      ,[ID]
      ,[GRADING_SCHEME_ID]
      ,[GRADE]
      ,[MIN_GRADE]
      ,[MAX_GRADE]
      ,[INTERNAL_SCORE]
      ,[SDR_COMPLETION_CODE]
      ,[DESCRIPTION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_GRADING_SCHEME_GRADES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Grading_Schemes]...';


GO

Create   view [OneEBS].[Grading_Schemes] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[CODE]
      ,[GRADING_SCHEME_TYPE]
      ,[DESCRIPTION]
      ,[IS_ACTIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[GRADING_SCHEME_SUBTYPE]
      ,[ALLOW_FLOOD_FILL]
      ,[IS_EXCLUDED_FROM_AWARD_CALC] 
from edw.OneEBS_EBS_0165_GRADING_SCHEMES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Instalment_Plans]...';


GO

Create   view [OneEBS].[Instalment_Plans] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PLAN_ID]
      ,[PERSON_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[AMOUNT]
      ,[DUE_DATE]
      ,[EPAYMENT_EXTERNAL_REF]
      ,[EPAYMENT_STATUS]
      ,[EPAYMENT_STATUS_CODE]
      ,[EPAYMENT_TRANSACTION_ID]
      ,[INTERNAL_INVOICE_CODE]
      ,[INTERNAL_INVOICE_DATE]
      ,[MATCHED_FEE_RECORD_CODE]
      ,[PAID] 
from edw.OneEBS_EBS_0165_INSTALMENT_PLANS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Locations]...';


GO

Create   view [OneEBS].[Locations] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[COUNTRY_CODE]
      ,[IS_AVAILABLE_IN_ESP]
      ,[ORGANISATION_CODE]
      ,[ADDRESS_LINE_3]
      ,[ADDRESS_LINE_4]
      ,[TOWN]
      ,[REGION]
      ,[UK_POST_CODE_PT1]
      ,[UK_POST_CODE_PT2]
      ,[SITE_CODE]
      ,[SP_LOCATION_URL]
      ,[SP_DIRECTIONS_URL]
      ,[FES_ACTIVE]
      ,[INSTCAMP]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[IS_INCIDENT]
      ,[LOCATION_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[ADDRESS_LINE_1]
      ,[ADDRESS_LINE_2] 
from edw.OneEBS_EBS_0165_LOCATIONS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Marking_Rule_Assessments]...';


GO

Create   view [OneEBS].[Marking_Rule_Assessments] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[GRADING_SCHEME_GRADES_ID]
      ,[ID]
      ,[MARKING_RULE_ID]
      ,[ASSESSMENT_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[WEIGHTING] 
from edw.OneEBS_EBS_0165_MARKING_RULE_ASSESSMENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Marking_Rule_Properties]...';


GO

Create   view [OneEBS].[Marking_Rule_Properties] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[MARKING_RULE_ID]
      ,[PROPERTY_NAME]
      ,[PROPERTY_VALUE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_MARKING_RULE_PROPERTIES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Marking_Rules]...';


GO

Create   view [OneEBS].[Marking_Rules] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[NAME]
      ,[DESCRIPTION]
      ,[MARKING_RULE_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[RULE_WEIGHTING]
      ,[GRADING_SCHEME_ID]
      ,[MUST_PASS] 
from edw.OneEBS_EBS_0165_MARKING_RULES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Modes_Of_Provision]...';


GO

Create   view [OneEBS].[Modes_Of_Provision] AS  
Select [PROVISION_CODE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[MOA_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[FES_NOTIONAL_HOURS]
      ,[FES_FTE]
      ,[FES_ACTIVE] 
from edw.OneEBS_EBS_0165_MODES_OF_PROVISION 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Notes]...';


GO

Create   view [OneEBS].[Notes] AS  
Select [NOTES_ID]
      ,[NOTES]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[NOTES_TOPICS_ID]
      ,[REQUIRES_ACTION]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[USER_19]
      ,[USER_20]
      ,[USER_21]
      ,[USER_22]
      ,[USER_23]
      ,[USER_24]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_NOTES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Notes_Topics]...';


GO

Create   view [OneEBS].[Notes_Topics] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[TOPIC_CODE]
      ,[SHORT_DESCRIPTION]
      ,[LONG_DESCRIPTION]
      ,[LINKED_ROLE_1]
      ,[LINKED_ROLE_2]
      ,[IS_ACTIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_NOTES_TOPICS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Org_Unit_Links]...';


GO

Create   view [OneEBS].[Org_Unit_Links] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[PRIMARY_ORGANISATION]
      ,[SECONDARY_ORGANISATION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_ORG_UNIT_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Org_Unit_People]...';


GO

Create   view [OneEBS].[Org_Unit_People] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[INCLUDE_IN_DATA_RETURN]
      ,[PEOPLE_UNITS_ID]
      ,[WORK_PLACEMENT_CONFIRMED_DATE]
      ,[ID]
      ,[ORG_UNIT_CODE]
      ,[PERSON_CODE]
      ,[START_DATE]
      ,[END_DATE]
      ,[ADDRESS_CODE]
      ,[POSITION]
      ,[PRIMARY_CONTACT]
      ,[TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3] 
from edw.OneEBS_EBS_0165_ORG_UNIT_PEOPLE 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Organisation_Units]...';


GO

Create   view [OneEBS].[Organisation_Units] AS  
Select [DO_NOT_PHONE]
      ,[DO_NOT_FAX]
      ,[DO_NOT_EMAIL]
      ,[DO_NOT_POSTAL_MAIL]
      ,[DO_NOT_BULK_EMAIL]
      ,[DO_NOT_BULK_POSTAL_MAIL]
      ,[EXCLUDE_FROM_MONDAS_EXPORT]
      ,[FAX_CODE]
      ,[FES_ACTIVE]
      ,[FES_DEPARTMENT_HEAD]
      ,[FES_FULL_NAME]
      ,[FES_SHORT_NAME]
      ,[MAIN_ACTIVITY]
      ,[MAIN_RISK_FACTOR]
      ,[NOTES_ID]
      ,[NUMBER_EMPLOYEES]
      ,[POST_CODE]
      ,[REGION_COUNTY_STATE]
      ,[SPONSOR]
      ,[TELEPHONE_NUMBER]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[WEB_SITE]
      ,[SHOW_IN_CM]
      ,[SIC_CODE]
      ,[HEALTH_SAFETY_CERT_EXP_DATE]
      ,[LEVEL_OF_ENGAGEMENT]
      ,[TRAINING_TYPE]
      ,[CUSTOMER_SATISFACTION]
      ,[SHOW_IN_CA]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[A2C_CENTRE_ID]
      ,[EMPLOYER_REFERENCE_NUMBER]
      ,[UKPRN]
      ,[IS_SMALL_EMPLOYER]
      ,[HEALTH_SAFETY_STATUS]
      ,[DATE_EMPLOYER_APPROVED]
      ,[DATE_EMPLOYER_LAST_VETTED]
      ,[DATE_EMPLOYER_DUE_VETTED]
      ,[CDA_APPLICATION_TYPE]
      ,[DATE_CDA_LAST_VETTED]
      ,[LIABILITY_INS_RENEW_DATE]
      ,[LIABILITY_INS_EXPIRY_DATE]
      ,[SOC_CODE_1]
      ,[SOC_CODE_2]
      ,[SOC_CODE_3]
      ,[SOC_CODE_4]
      ,[IS_APPROVED_FOR_INVOICING]
      ,[COST_CENTRE_COMPONENT]
      ,[ORGANISATION_CODE]
      ,[INTERNAL_OR_EXTERNAL]
      ,[ORGANISATION_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[ADDRESS_LINE_1]
      ,[ADDRESS_LINE_2]
      ,[ADDRESS_LINE_3]
      ,[ANNUAL_TURNOVER]
      ,[BTEC_CENTRE]
      ,[BTEC_SUB_CENTRE]
      ,[BUSINESS_SECTOR]
      ,[CENTRE_NUMBER]
      ,[CFACS_NAME_CODE]
      ,[CG_CENTRE]
      ,[CG_SUB_CENTRE]
      ,[CONTACT_NAME]
      ,[COUNTRY]
      ,[CP_PARTNER_CODE] 
from edw.OneEBS_EBS_0165_ORGANISATION_UNITS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People]...';


GO

Create   view [OneEBS].[People] AS  
Select [STAFF_USER_4]
      ,[STAFF_USER_5]
      ,[STAFF_USER_6]
      ,[STUDENT_STAFF_TUTOR]
      ,[TERTIARY_PERSON_CODE]
      ,[TITLE]
      ,[TREFNO]
      ,[UCAS_RECORD]
      ,[UCAS_RD_NUMBER]
      ,[UCAS_NUMBER]
      ,[ULI]
      ,[UNIQUE_LEARN_NO]
      ,[UNSPEC_CANDIDATE_NO]
      ,[UK_RESIDENT]
      ,[UPN]
      ,[UNCONFIRMED]
      ,[USE_EMAIL]
      ,[USE_LL]
      ,[USE_SMS]
      ,[YEAR_LEFT]
      ,[CAFID]
      ,[FES_NOK_CONT_REL]
      ,[STUDENT_VISA]
      ,[DISC_LEARN_SUP_TYPE1]
      ,[DISC_LEARN_SUP_TYPE2]
      ,[DISC_LEARN_SUP_TYPE3]
      ,[DISC_LEARN_SUP_TYPE4]
      ,[ELIGENHANC_1]
      ,[ELIGENHANC_2]
      ,[LOCAL_MONITOR_1]
      ,[LOCAL_MONITOR_2]
      ,[NES_LSC_NO]
      ,[HEALTHTD]
      ,[LONE_PAR]
      ,[WELSHUND]
      ,[WELSHRWR]
      ,[MIGRANTW]
      ,[HOURS_WK]
      ,[EMPLSIZE]
      ,[DISADV_UPLIFT]
      ,[DISABILITY_2]
      ,[LRS_ABILITY_TO_SHARE]
      ,[LRS_VERIFICATION_TYPE]
      ,[LRS_OTHER_VERIFICATION_DESC]
      ,[ULN_RECEIVED]
      ,[PLACE_OF_BIRTH]
      ,[LRS_UPDATED_DATE]
      ,[EXC_DELETE_FILE]
      ,[ILA_REF_NO]
      ,[LRS_VALIDATION_ERRORS]
      ,[LRS_ADDRESS_CODE]
      ,[FIRST_TERTIARY_YEAR]
      ,[DIS_ACCESSED]
      ,[LAST_SCHOOL_YEAR]
      ,[FINISH_THIS_YEAR]
      ,[IRD_NO]
      ,[MAX_EXEMPT_FEE]
      ,[NZ_ETHNICITY_1]
      ,[NZ_ETHNICITY_2]
      ,[NZ_ETHNICITY_3]
      ,[EXTERNAL_ID]
      ,[STUDYLINK_IDENTIFIER]
      ,[PREVIOUS_FORENAME]
      ,[RESIDENTIAL_STATUS]
      ,[VERIFICATION_NAME_DOB]
      ,[VERIFICATION_RESIDENTIAL]
      ,[VERIFICATION_ALT_NAME_DOB]
      ,[PREFERRED_NAME_FORMAT]
      ,[NZ_FUNDING]
      ,[DATE_OF_DEATH]
      ,[FEES_PAID]
      ,[ULN_STATUS]
      ,[LEARNER_UPDATE_REQUIRED]
      ,[IWI_1]
      ,[IWI_2]
      ,[IWI_3]
      ,[PASSPORT_NO]
      ,[PASSPORT_EXPIRY_DATE]
      ,[PASSPORT_ISSUE_COUNTRY]
      ,[PERSONAL_EMAIL]
      ,[CONTACT_METHODS]
      ,[BAD_DEBT]
      ,[VALIDATION_LEVEL]
      ,[FES_USER_31]
      ,[FES_USER_32]
      ,[FES_USER_33]
      ,[FES_USER_34]
      ,[FES_USER_35]
      ,[FES_USER_36]
      ,[FES_USER_37]
      ,[FES_USER_38]
      ,[FES_USER_39]
      ,[FES_USER_40]
      ,[FES_USER_41]
      ,[FES_USER_42]
      ,[FES_USER_43]
      ,[FES_USER_44]
      ,[FES_USER_45]
      ,[FES_USER_46]
      ,[FES_USER_47]
      ,[FES_USER_48]
      ,[FES_USER_49]
      ,[FES_USER_50]
      ,[CAN_ENROL]
      ,[DISC_LEARN_SUP_TYPE5]
      ,[RESIDENCY_GRANTED_DATE]
      ,[LEARN_DIFF_ASSMT]
      ,[DISABLED_ALLOWANCE]
      ,[TRAINEE_CODE]
      ,[CONCESSION_CODE]
      ,[CONCESSION_CODE_EXPIRY]
      ,[FEE_EXEMPTION]
      ,[PRIOR_EDUCATION_ACHIEVEMENT]
      ,[HAS_PRIOR_ACHIEVEMENT]
      ,[PRIOR_EDUCATION_LOCATION]
      ,[HOME_LANGUAGE]
      ,[INDIGENOUS_STATUS]
      ,[CURRENT_SCHOOL_LEVEL]
      ,[IS_AT_SCHOOL]
      ,[EXPORT_ACCEPTANCE_DATE]
      ,[REGISTRATION_NO]
      ,[INTERNATIONAL_NO]
      ,[PHOTO_PERMISSION]
      ,[TYPE_OF_INTERNET_ACCESS]
      ,[TYPE_OF_CARE]
      ,[CARE_PER_WEEK]
      ,[MEDICAL_NO]
      ,[IMMUNISATION_EVIDENCE_TYPE]
      ,[IMMUNISATION_VERIFICATION_TYPE]
      ,[IMMUNISATION_VERIFY_DATE]
      ,[OTHER_SCHOOLS_ATTENDED]
      ,[ROLL_CLASS]
      ,[RELIGIOUS_INSTRUCTION_GROUP]
      ,[SCHOLASTIC_YEAR]
      ,[HOUSE]
      ,[IS_EXCHANGE_STUDENT]
      ,[IS_BOARDER]
      ,[SECOND_LANG_SUPPORT_REQUIRED]
      ,[SECOND_LANG_PHASE]
      ,[SECOND_LANG_ASSESSMENT_DATE]
      ,[TAX_FILE_NO]
      ,[MODE_OF_ENTRY]
      ,[MODE_OF_ATTENDANCE]
      ,[ENTITLEMENT_LIMIT]
      ,[ENTITLEMENT_USED]
      ,[ENTITLEMENT_BALANCE]
      ,[ENTITLEMENT_AS_AT_DATE]
      ,[ENTITLEMENT_VERIFIED_DATE]
      ,[BOARD_OF_STUDIES_NO]
      ,[IS_HOME_LANG_NOT_ENGLISH]
      ,[IS_ELIGIBLE_FOR_FREE_TRAVEL]
      ,[DISTANCE_FROM_HOME]
      ,[AUTHORITY_TO_ENROL_NO]
      ,[AUTHORITY_TO_ENROL_EXPIRY_DATE]
      ,[ASSES_FORM_NO]
      ,[ASSES_FORM_EXPIRY_DATE]
      ,[DATE_FIRST_ENROLLED]
      ,[PREFERRED_FIRST_NAME]
      ,[PREFERRED_FAMILY_NAME]
      ,[POSITION]
      ,[REFERABLE]
      ,[ENTITLEMENT_ID]
      ,[HIGHER_EDUCATION_SUPPORT_NO]
      ,[HAS_AUTHORITY_TO_PUBLISH]
      ,[RELIGION]
      ,[PREVIOUS_SCHOOL_ATTEND_DATES]
      ,[HOME_LANGUAGE_OTHER]
      ,[PREVIOUS_SCHOOL_TYPE]
      ,[IS_RETURNING_FROM_OVERSEAS]
      ,[RETURNED_FROM_OVERSEAS_DATE]
      ,[IS_ACCELERATED_STUDENT]
      ,[IS_STUDENT_ON_LEARNING_PATH]
      ,[IS_CENSUS_SCHOOL]
      ,[IS_INTENSIVE_ENGLISH_CENTRE]
      ,[HAS_HEALTH_CARE_CARD]
      ,[ELECTRONIC_PAYMENT_REF_NO]
      ,[OCCUPATION]
      ,[OCCUPATION_GROUP]
      ,[LEVEL_OF_EDUCATION]
      ,[LEVEL_OF_QUALIFICATION]
      ,[PREV_UKPRN]
      ,[PREV_LEARNER_REF]
      ,[HAS_HEALTHCARE_PLAN]
      ,[PRIOR_ED_LEVEL]
      ,[PRIOR_ATTAIN_YEAR]
      ,[PARENT_EDUCATION_1]
      ,[PARENT_EDUCATION_2]
      ,[IS_RETURNING_STUDENT]
      ,[IS_ENTITLEMENT_REQUESTED]
      ,[POST_SCHOOL_QUALS]
      ,[HIGHEST_POST_SCHOOL_QUAL]
      ,[DISABILITY_ASSESSMENT_TYPE]
      ,[RESIDENTIAL_STATUS_2]
      ,[INSTITUTION_CONTEXT_ID]
      ,[PREDICTED_SCORE]
      ,[SECONDARY_QUALIFICATION]
      ,[IS_ACTIVE]
      ,[RESIDENTIAL_STATUS_UPDATED]
      ,[PERSON_CODE]
      ,[FORENAME]
      ,[MIDDLE_NAMES]
      ,[SURNAME]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[AGE_RANGE]
      ,[ALS_COST_CEILING]
      ,[AVAILABILITY_CODE]
      ,[AVATAR_IMAGE_LOCATION]
      ,[CAN_ACCESS_NETWORK]
      ,[CFACS_NAME_CODE]
      ,[CG_CANDIDATE_NAME]
      ,[CG_ENROL_NO]
      ,[CG_PREV_ENROL]
      ,[CNX_CARDHOLDER_ID]
      ,[COLLEGE_EMAIL]
      ,[COLLEGE_LOGIN]
      ,[COLLEGE_START_DATE]
      ,[COMMENTS]
      ,[CONTRACT_HOURS]
      ,[CONTACT_HOURS]
      ,[COUNTRY_OF_DOMICILE]
      ,[CREATE_BORROWER]
      ,[CURRENT_APP_DESC]
      ,[CURREMPSTATUS]
      ,[DATECURREMPCHG]
      ,[DATE_OF_BIRTH]
      ,[DATE_UK_ENTRY]
      ,[DISABILITY]
      ,[EMA_ID]
      ,[EMA_COURSE_TYPE]
      ,[EMPLOY_STATUS_BEGIN]
      ,[ETHNICITY]
      ,[EX_MAILSHOT]
      ,[FES_COUNTRY_OF_BIRTH]
      ,[FES_NEXT_OF_KIN]
      ,[FES_NOK_CONTACT_NO]
      ,[FES_SEC_PERSON_CODE]
      ,[FES_STAFF_CODE]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[FES_USER_13]
      ,[FES_USER_14]
      ,[FES_USER_15]
      ,[FES_USER_16]
      ,[FES_USER_17]
      ,[FES_USER_18]
      ,[FES_USER_19]
      ,[FES_USER_20]
      ,[FES_USER_21]
      ,[FES_USER_22]
      ,[FES_USER_23]
      ,[FES_USER_24]
      ,[FES_USER_25]
      ,[FES_USER_26]
      ,[FES_USER_27]
      ,[FES_USER_28]
      ,[FES_USER_29]
      ,[FES_USER_30]
      ,[F_LANG]
      ,[GC_CANDIDATE_NO]
      ,[GC_UCI]
      ,[GC_ALT_CAND_NO]
      ,[GC_QUALIFIER]
      ,[GC_ALT_CENTRE_NO]
      ,[HUSID]
      ,[INITIALS]
      ,[INTERNAL_CAND]
      ,[INTERNAL_TEL_EXT]
      ,[IS_PHOTO_SHAREABLE]
      ,[IS_PROFILE_SHAREABLE]
      ,[KNOWN_AS]
      ,[LEARNING_DIFFICULTY]
      ,[LEARN_DIFF]
      ,[MARITAL_STATUS]
      ,[MOBILE_PHONE_NUMBER]
      ,[MULTIPLE_CONTRACT_NUMBER]
      ,[NATIONALITY]
      ,[NAT_IDEN]
      ,[NCFE_CANDIDATE_NO]
      ,[NCFE_PREV_NO]
      ,[NETWORK_USERID]
      ,[NI_NUMBER]
      ,[NOTES]
      ,[ON_PAYROLL]
      ,[ORGANISATION_CODE_1]
      ,[ORGANISATION_CODE_2]
      ,[OVERSEAS]
      ,[PREVIOUS_SURNAME]
      ,[PRIMARY_DISABILITY]
      ,[PRIOR_ATTAIN_LEVEL]
      ,[PRIOR_LEARNER_STATUS]
      ,[RSA_NUMBER]
      ,[SCHOOL]
      ,[SCOTVEC]
      ,[SEX]
      ,[SIR_ENROL_HIGH_TEACH_QUAL]
      ,[SIR_HIGHEST_QUAL]
      ,[SIR_HIGHEST_QUAL_PA]
      ,[SIR_QTEACH_STATUS]
      ,[SIR_STAFF_CODE]
      ,[SIR_TEACH_QUAL_1]
      ,[SIR_TEACH_QUAL_2]
      ,[SIR_TEACH_QUAL_3]
      ,[SIR_TEACH_QUAL_4]
      ,[SIR_TEACH_TRNG_1]
      ,[SIR_TEACH_TRNG_2]
      ,[SIR_TEACH_TRNG_3]
      ,[SIR_TRAIN_SLDD]
      ,[SNAME16]
      ,[STAFF_USER_1]
      ,[STAFF_USER_2]
      ,[STAFF_USER_3] 
from edw.OneEBS_EBS_0165_PEOPLE 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_ASR]...';


GO



CREATE   view [OneEBS].[People_ASR] AS  
Select [HAS_DOC_DEGREE]
      ,[DOC_DEGREE_LOCATION]
      ,[DOC_DEGREE_ACHIEVED_SINCE_17]
      ,[HAS_MSTR_DEGREE]
      ,[MSTR_DEGREE_LOCATION]
      ,[MSTR_DEGREE_ACHIEVED_SINCE_17]
      ,[HAS_GRAD_DIPLOMA]
      ,[GRAD_DIPLOMA_LOCATION]
      ,[GRAD_DIPLOMA_ACHIEVED_SINCE_17]
      ,[ID]
      ,[PERSON_CODE]
      ,[HAS_BACH_OR_HIGHER_DEGREE_008]
      ,[HAS_ADV_DIP_OR_ASSOC_DEG_410]
      ,[HAS_DIP_OR_ASSOC_DIP_420]
      ,[HAS_CERT_IV_OR_AD_CERT_TEC_511]
      ,[HAS_CERT_III_OR_TRADE_CERT_514]
      ,[HAS_CERT_II_521]
      ,[HAS_CERT_I_524]
      ,[HAS_OTHER_CERT_990]
      ,[HOME_TELEPHONE_NUMBER]
      ,[WORK_TELEPHONE_NUMBER]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[SURVEY_CONTACT_STATUS] 
from edw.OneEBS_EBS_0165_PEOPLE_ASR 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Centrelink]...';


GO

Create   view [OneEBS].[People_Centrelink] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[ID]
      ,[PERSON_CODE]
      ,[CRN]
      ,[SECONDARY_CRN]
      ,[CRN_CONFIRM_DATE]
      ,[DVA_NO]
      ,[ORG_TYPE]
      ,[CREATED_DATE]
      ,[CREATED_BY]
      ,[UPDATED_DATE]
      ,[UPDATED_BY]
      ,[DVA_CONFIRM_DATE] 
from edw.OneEBS_EBS_0165_PEOPLE_CENTRELINK 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_UIO]...';


GO


CREATE   view [OneEBS].[People_UIO] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[START_DATE]
      ,[END_DATE]
      ,[STATUS]
      ,[PERSON_RIGHT]
      ,[OBS_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[ID]
      ,[PERSON_CODE]
      ,[UIO_ID]
      ,[TEACH_ALL_LEARNERS]
      ,[TYPE]
      ,[TUTORGROUP_ID] 
from edw.OneEBS_EBS_0165_PEOPLE_UIO 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Unit_Attainments]...';


GO

Create   view [OneEBS].[People_Unit_Attainments] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PEOPLE_UNITS_ID]
      ,[ATTAINMENT_CODE]
      ,[LINK_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PEOPLE_UNIT_ATTAINMENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Unit_Awards]...';


GO

Create   view [OneEBS].[People_Unit_Awards] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PEOPLE_UNITS_ID]
      ,[UNIT_INSTANCE_AWARD_ID]
      ,[AWARD_RULESET_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PEOPLE_UNIT_AWARDS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Unit_Links]...';


GO

Create   view [OneEBS].[People_Unit_Links] AS  
Select [CREATED_DATE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PARENT_ID]
      ,[CHILD_ID]
      ,[MANDATORY]
      ,[CREATED_BY]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[IS_ELECTIVE]
from edw.OneEBS_EBS_0165_PEOPLE_UNIT_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Units]...';


GO

Create   view [OneEBS].[People_Units] AS  
Select [ID]
      ,[UNIT_TYPE]
      ,[PROGRESS_CODE]
      ,[PROGRESS_STATUS]
      ,[PROGRESS_DATE]
      ,[PERSON_CODE]
      ,[UIO_ID]
      ,[UNIT_INSTANCE_CODE]
      ,[CALOCC_CODE]
      ,[CALOCC_CTYPE]
      ,[UNDEFINED_INTEREST_CODE]
      ,[PEOPLE_UNIT_GROUPS_ID]
      ,[ORGANISATION_CODE]
      ,[SPONSOR_ORG_CODE]
      ,[TOPIC_CODE]
      ,[REFERENCE_NO]
      ,[RECORD_DATE]
      ,[SOURCE_TYPE]
      ,[LOCATION_CODE]
      ,[GUIDED]
      ,[DATA_RETURN]
      ,[SPECIAL_DETAILS]
      ,[WHO_TO_PAY]
      ,[GROUP_CODE]
      ,[SUPERVISOR]
      ,[SUP_START_DATE]
      ,[SUPERVISOR_ROLE]
      ,[GENERATED_REGISTER]
      ,[INCLUDE_IN_HESA]
      ,[EPAY_TRANSACTION_ID]
      ,[UIO_EVENT_CODE]
      ,[UCAS_NUMBER]
      ,[UCAS_RECORD]
      ,[UCAS_RD_NUMBER]
      ,[UCAS_COURSE_CODE]
      ,[EMA_MAIN_COURSE]
      ,[EMA_EXCLUDE]
      ,[MATCH_FUNDED]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[USER_19]
      ,[USER_20]
      ,[USER_21]
      ,[USER_22]
      ,[USER_23]
      ,[USER_24]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[GENERATE_AWARD]
      ,[SPCL_AWARD_FLAG]
      ,[CASCADE_TO_EXAM]
      ,[PROGRESS_REASON]
      ,[DESTINATION]
      ,[CAFFILE]
      ,[CONVERSATION_ID]
      ,[NZ_ASSIST]
      ,[ATTENDANCE_CODE]
      ,[NZ_FUNDING]
      ,[RESIDENTIAL_STATUS]
      ,[YEAR_GRADUATED]
      ,[SDR_COMPLETION_RETURN_STATUS]
      ,[COMPLETION_RETURN]
      ,[USER_25]
      ,[USER_26]
      ,[USER_27]
      ,[USER_28]
      ,[USER_29]
      ,[USER_30]
      ,[FEE_GEN_LEVEL]
      ,[BAD_DEBT]
      ,[ENTRY_REQUIREMENTS_MET]
      ,[GEN_FEES_ENROLMENT]
      ,[RESERVATION_ID]
      ,[USER_31]
      ,[USER_32]
      ,[USER_33]
      ,[USER_34]
      ,[USER_35]
      ,[USER_36]
      ,[USER_37]
      ,[USER_38]
      ,[USER_39]
      ,[USER_40]
      ,[USER_41]
      ,[USER_42]
      ,[USER_43]
      ,[USER_44]
      ,[USER_45]
      ,[USER_46]
      ,[USER_47]
      ,[USER_48]
      ,[USER_49]
      ,[USER_50]
      ,[NUM_OF_MINUTES_ATTENDED]
      ,[STUDY_REASON]
      ,[IS_EXISTING_WORKER]
      ,[MODE_OF_ATTENDANCE]
      ,[IS_CENTRELINK_ACCESS_REQUIRED]
      ,[AMNT_PRIOR_LRN_CREDIT_OFFERED]
      ,[HE_PRIOR_LRN_CREDIT_PROVIDER]
      ,[ADMISSION_CRITERIA]
      ,[AMNT_PRIOR_LRN_CREDIT_USED]
      ,[PRIOR_STUDY_CREDIT_OFFERED]
      ,[PRIOR_FOE_CREDIT_OFFERED]
      ,[PRIOR_LOE_CREDIT_OFFERED]
      ,[PROVIDER_TYPE]
      ,[TUITION_FEE_STATUS]
      ,[ASSISTANCE_ELIGIBILITY_STATUS]
      ,[LOAN_REQUESTED]
      ,[INTENDS_TO_PAY_BY_INSTALMENTS]
      ,[RESERVE_ORDER]
      ,[INSTALMENT_PLAN_ID]
      ,[LOAN_AMOUNT]
      ,[HAS_AGREED_TERMS_CONDITIONS]
      ,[TERTIARY_SCORE]
      ,[TERTIARY_SCORE_YEAR]
      ,[HAS_ECAF_BEEN_SUBMITTED]
      ,[HAS_CAF_BEEN_RECEIVED]
      ,[DATE_ECAF_RECEIVED]
      ,[INCLUDE_IN_AUTO_COMPLETIONS]
      ,[LAST_AUTO_COMPLETION_DATE]
      ,[IS_RESIDENT]
      ,[FLOW_INDICATOR]
      ,[HAS_PREVIOUS_LOAN]
      ,[DATE_OFFER_MADE]
      ,[PURCHASING_CONTRACT_IDENTIFIER]
      ,[PURCHASING_CONTRACT_SCHED_ID]
      ,[TRAINING_CONTRACT_IDENTIFIER]
      ,[HOURS_ATTENDED_ON_WITHDRAWAL]
      ,[HAS_ANOTHER_SUBSIDISED_QUAL]
      ,[WELFARE_STATUS]
      ,[APPRENTICE_TRAINEE_TYPE]
      ,[IS_TRANSITIONED_ENROLMENT]
      ,[COMMITMENT_IDENTIFIER]
      ,[COMMITMENT_DATE]
      ,[REASON_FOR_REJECTION]
      ,[HAS_LTU_EVIDENCE]
      ,[IS_ESP_CLIENT]
      ,[ESP_ORGANISATION]
      ,[LEARNER_TRAINING_IDENTIFIER]
      ,[IS_ESP_REFERRAL]
      ,[ESP_REFERRAL_IDENTIFIER]
      ,[SUBSIDISED_CATEGORY]
      ,[SUBSIDISED_AMOUNT]
      ,[EXPORT_BATCH_ID]
      ,[ALTERNATE_ORGANISATION_NAME]
      ,[REGION]
      ,[PROGRAM_STREAM]
      ,[HAS_SOCIAL_HOUSING]
      ,[ALTERNATE_EMPLOYER_POSTCODE]
      ,[ALTERNATE_EMPLOYER_SUBURB]
      ,[IS_REHAB_FOR_DISABILITY]
      ,[HAS_REHAB_RELATED_EVIDENCE]
      ,[EXTERNAL_SUBSIDISED_AMOUNT]
      ,[SUBSIDY_EXPORT_DATE]
      ,[STANDARD_SUBSIDY_AMOUNT]
      ,[SUBSIDISED_NEEDS_LOADING]
      ,[SUBSIDISED_LOCATION_LOADING]
      ,[SUBSIDY_COMMITMENT_EXPIRY_DATE]
      ,[SUBSIDY_STATUS]
      ,[UNIT_OF_STUDY_CODE]
      ,[RESIDENTIAL_STATUS_2]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ASSOCIATED_PEOPLE_UNITS_ID]
      ,[IS_VET_IN_SCHOOLS]
      ,[COMMENCING_PROGRAM_ID]
      ,[COOLING_OFF_PERIOD_END]
      ,[ENROLLED_AS_MGD_APPSHIP]
      ,[TIMETABLES_ID]
      ,[TRANSITION_FROM_PEOPLE_UNIT_ID]
      ,[NOTACT] 
from edw.OneEBS_EBS_0165_PEOPLE_UNITS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Units_Centrelink]...';


GO

Create   view [OneEBS].[People_Units_Centrelink] AS  
Select [ID]
      ,[PU_ID]
      ,[SOURCE]
      ,[INPUTREFID]
      ,[CRN]
      ,[CNFRMDATE]
      ,[PCC]
      ,[HCC]
      ,[SHC]
      ,[DECEASED]
      ,[BLIND]
      ,[OVER70]
      ,[WAR]
      ,[INST]
      ,[PCODE_PCODEMTCH]
      ,[NUMCHILD]
      ,[SCNDRYCRN]
      ,[PYMTTYPE]
      ,[PYMTSTATUS]
      ,[PYMTSTARTDATE]
      ,[PYMTENDDATE]
      ,[DATEPAIDTO]
      ,[MAXRATE]
      ,[RATERATIO]
      ,[RATETHOLD]
      ,[CUSTID]
      ,[ORGTYPE]
      ,[MTCHCODE]
      ,[GCH]
      ,[FIRSTNAME]
      ,[MIDDLENAME]
      ,[SURNAME]
      ,[DOB]
      ,[ADDR]
      ,[CNFRMID]
      ,[WWP]
      ,[POW]
      ,[DISABILITY]
      ,[SDA]
      ,[EYP]
      ,[MWC]
      ,[OIP]
      ,[SRD]
      ,[WDP]
      ,[APPLY_BENEFIT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[WAVR_PYMT_ID]
      ,[INSTITUTION_CONTEXT_ID]
 
from edw.OneEBS_EBS_0165_PEOPLE_UNITS_CENTRELINK 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Units_Financial]...';


GO

Create   view [OneEBS].[People_Units_Financial] AS  
Select [ID]
      ,[PEOPLE_UNITS_ID]
      ,[FEE_TYPE_INDICATOR]
      ,[STUDENT_FEE_AMOUNT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PEOPLE_UNITS_FINANCIAL 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Units_Special]...';


GO

Create   view [OneEBS].[People_Units_Special] AS  
Select [ID]
      ,[PEOPLE_UNITS_ID]
      ,[START_DATE]
      ,[END_DATE]
      ,[MOA_CODE]
      ,[NO_OF_HOURS]
      ,[NO_OF_WEEKS]
      ,[POSSIBLE_HOURS]
      ,[AIM_START]
      ,[AIM_END]
      ,[STUDENT_TYPE]
      ,[FUNDING_YEAR]
      ,[FUNDING_STREAM]
      ,[FUND_SOURCE_1]
      ,[FUND_SOURCE_2]
      ,[DELIVERY_MODE]
      ,[MAIN_DEL_METHOD]
      ,[EMPLOYER_ROLE]
      ,[RESIT]
      ,[RELATED_OCCUPATION]
      ,[SECTOR_FRAMEWORK]
      ,[EXP_GUIDED_HRS]
      ,[ACT_GUIDED_HRS]
      ,[FUNDING_MOA]
      ,[TAUGHT_HRS]
      ,[STUDY_HRS]
      ,[DISTANCE_GLH]
      ,[ENHANCED_GLH]
      ,[APL_HRS]
      ,[FUNDING_EXPIRY_DATE]
      ,[UNITS_FOR_FULL_QUAL]
      ,[AWARD_FLAG]
      ,[ESF_START_DATE]
      ,[PLANNED_END_DATE]
      ,[FUNDING_END_DATE]
      ,[SECTOR_SUPPORT]
      ,[PRIOR_EMPLOY_STATUS]
      ,[EMPLOYMENT_STATUS]
      ,[PRIOR_UNEMPLOY_LENGTH]
      ,[EMPLOYER_TYPE]
      ,[GENDER_STEREOTYPE]
      ,[CO_FINANCE_ACTIVITY]
      ,[ESF_DELIVERY_MODE]
      ,[SUPPORT_MEASURES]
      ,[LEARNER_BACKGROUND]
      ,[DIS_SUPPORT_MEASURES]
      ,[PROJ_DOSSIER_NO]
      ,[LOCAL_PROJ_NO]
      ,[LEARNER_BACKGROUND_2]
      ,[LEARNER_BACKGROUND_3]
      ,[NATIONALITY]
      ,[HEQUALS]
      ,[NEW_ENTRANT]
      ,[HE_PROGYEAR_TP]
      ,[HE_EARLY_MODE]
      ,[HE_LEVEL]
      ,[HE_COMPLETE_YEAR]
      ,[HE_FTE]
      ,[YEAR_OF_PROGRAM]
      ,[FEE_BAND]
      ,[HE_SOURCE_FEES]
      ,[TERM_TIME_ACC]
      ,[OCC_CODE]
      ,[LAST_INST]
      ,[YEAR_LAST_INST]
      ,[ALEVELS]
      ,[ALEVEL_SCORE]
      ,[SCE_HIGHERS]
      ,[SCOT_HIGH_POINTS]
      ,[VOC_QUALS]
      ,[LEAVE_REASON]
      ,[PROP_NOT_TAUGHT]
      ,[PROP_SCLASS1]
      ,[PROP_SCLASS2]
      ,[PROP_SCLASS3]
      ,[SOCIO_ECO_IND]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[BROK_CONT_NO]
      ,[ASL_PROVISION_TYPE]
      ,[PLANNED_CREDIT]
      ,[CREDIT_ACHIEVED]
      ,[PROG_TYPE]
      ,[PROG_ENTRY_ROUTE]
      ,[FRANCHISING]
      ,[DELIVERY_PROVIDER]
      ,[DELIVERY_POST_CODE_PT1]
      ,[DELIVERY_POST_CODE_PT2]
      ,[NVQ_ACHIEVE_DATE]
      ,[EMPLOYER_NAME]
      ,[EMPLOYER_POST_CODE_PT1]
      ,[EMPLOYER_POST_CODE_PT2]
      ,[NATIONAL_MONITOR_1]
      ,[NATIONAL_MONITOR_2]
      ,[LOCAL_MONITOR_1]
      ,[LOCAL_MONITOR_2]
      ,[END_REASON]
      ,[PROP_FUND_REMAINING]
      ,[DISTANCE_FUNDING]
      ,[ADD_LEARN_NEED]
      ,[LOCATION_CODE]
      ,[DISTANCE_LEARNING_FACTOR]
      ,[NATIONAL_SKILLS_ACADEMY]
      ,[PLANNED_GROUP_BASED_HOURS]
      ,[PLANNED_ONE_TO_ONE_CONTACT]
      ,[EMPLOYMENT_OUTCOME]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[ER_ENHANCED_FUNDING]
      ,[CONTRACTING_ORG_CODE]
      ,[FUNDING_CATEGORY]
      ,[COURSE_CLASSIFICATION]
      ,[COURSE_EFTS_FACTOR]
      ,[FUNDING_STATUS]
      ,[NATIONAL_MONITOR_3]
      ,[ACT_PROG_ROUTE]
      ,[APPRENTICESHIP_PATHWAY]
      ,[FIRST_STEPS_INDICATOR]
      ,[RESTARTED]
      ,[ADD_SOCIAL_NEED]
      ,[IS_WORKPLACE_LEARNING]
      ,[HAS_STUDY_LOAN]
      ,[RPL_FUND_FACTOR]
      ,[OTHER_FUND_FACTOR]
      ,[ORIG_LEARN_START_DATE]
      ,[NATIONAL_MONITOR_4]
      ,[PLANNED_EEP_HOURS]
      ,[IS_CORE_AIM]
      ,[WORK_PROGRAMME_PARTICIPATION]
      ,[PERCENTAGE_ONLINE_DELIVERY]
      ,[APPRENTICESHIP_TRAILBLAZER_STD]
      ,[ELQ]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ADDITIONAL_DELIVERY_HOURS]
      ,[CONTRACT_REFERENCE_NUMBER]
      ,[FAMILY_ENGLISH_MATHS_LANGUAGE]
      ,[HE_POST_CODE1]
      ,[HE_POST_CODE2]
      ,[HE_CENTRE]
      ,[HOUSEHOLD_SITUATION_1]
      ,[HOUSEHOLD_SITUATION_2]
      ,[ASSESSMENT_ORGANISATION_ID]
      ,[COHORT_REFERENCE_NUMBER]
      ,[AIM_TYPE]
      ,[DEVOLVED_AREA_MONITORING_1]
      ,[DEVOLVED_AREA_MONITORING_2]
      ,[DEVOLVED_AREA_MONITORING_3]
      ,[DEVOLVED_AREA_MONITORING_4]
      ,[END_POINT_ASSESSMENT_DATE]
      ,[USE_EAD_TO_UPDATE_ACH_DATE]
      ,[NATIONAL_MONITOR_5]
      ,[NATIONAL_MONITOR_6]
      ,[PLANNED_HOURS] 
from edw.OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_Units_Sts]...';


GO

Create   view [OneEBS].[People_Units_Sts] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PEOPLE_UNITS_ID]
      ,[PURCHASING_ACTIVITY_SCHEDULE]
      ,[SUBSIDY_ADJUSTMENT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PEOPLE_UNITS_STS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[People_USI]...';


GO



CREATE   view [OneEBS].[People_USI] AS  
Select [ID]
      ,[PERSON_CODE]
      ,[USI]
      ,[HAS_USI_BEEN_MANUALLY_VERIFIED]
      ,[DATE_USI_VERIFIED]
      ,[CITY_OF_BIRTH]
      ,[COUNTRY_OF_STUDY]
      ,[CREATED_DATE]
      ,[CREATED_BY]
      ,[UPDATED_DATE]
      ,[UPDATED_BY]
      ,[INSTITUTION_CONTEXT_ID]
      ,[DUPLICATE_USI]
      ,[COUNTRY_OF_RESIDENCE]
      ,[COUNTRY_OF_BIRTH] 
from edw.OneEBS_EBS_0165_PEOPLE_USI 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Price_Bands]...';


GO

Create   view [OneEBS].[Price_Bands] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[PRICE_BAND_ID]
      ,[PRICE_BAND]
      ,[DESCRIPTION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PRICE_BANDS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Progress_Codes]...';


GO

Create   view [OneEBS].[Progress_Codes] AS  
Select [IS_REENGAGEMENT_ALLOWED]
      ,[IS_INCLUDED_IN_VFH_EXPORT]
      ,[INCLUDE_IN_ULN_SUBMISSION]
      ,[INSTITUTION_CONTEXT_ID]
      ,[REQUIRES_INVOICE_NOTICE]
      ,[AUTOPRGRSS_FROM_WHEN_ZERO_FEES]
      ,[TYPE_NAME]
      ,[STUDENT_STATUS]
      ,[TYPE_CODE]
      ,[PROGRESS_COMMENT]
      ,[CREATE_ATTAINMENT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[FES_ACTIVE]
      ,[IS_VISIBLE]
      ,[IS_PENDING]
      ,[SDR_COMPLETION_INDICATOR]
      ,[HAS_COMPLETED]
      ,[ROLE_DEFS_ID]
      ,[DATA_RETURN]
      ,[REQUIRES_OUTCOME]
      ,[GENERATE_FEES] 
from edw.OneEBS_EBS_0165_PROGRESS_CODES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Progress_Records]...';


GO

Create   view [OneEBS].[Progress_Records] AS  
Select [EFFECTIVE_DATE]
      ,[ACTUAL_END_DATE]
      ,[REG_REGISTRATION_CODE]
      ,[RPC_PROGRESS_TYPE]
      ,[RPR_SEQUENCE]
      ,[RPC_TYPE_NAME]
      ,[REG_REGISTRATION_NUMBER]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_REGISTRATION_NUMBER]
      ,[FES_UNIT_INSTANCE_CODE]
      ,[APP_APPLICATION_NUMBER]
      ,[AU_AU_NUMBER]
      ,[PER_PERSON_CODE]
      ,[FES_CAL_OCCURRENCE]
      ,[RUL_CODE]
      ,[ACTIONED_BY]
      ,[ACTIONED_DATE]
      ,[ACTION_STATUS]
      ,[SUBMITTED_BY]
      ,[NOTES_ID]
      ,[USER_NOTIFIED]
      ,[BATCH_NO]
      ,[PEOPLE_UNITS_ID]
      ,[PEOPLE_UNITS_TYPE]
      ,[PROGRESS_REASON]
      ,[DESTINATION]
      ,[CASCADE_UNITS]
      ,[CASCADE_AIMS]
      ,[CASCADE_REGISTERS]
      ,[CASCADE_EXAMS]
      ,[ADMIN_REASON]
      ,[INSTITUTION_CONTEXT_ID]
      ,[COMPUTED_ACADEMIC_YEAR] 
from edw.OneEBS_EBS_0165_PROGRESS_RECORDS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Progress_Types]...';


GO

Create   view [OneEBS].[Progress_Types] AS  
Select [FES_ACTIVE]
      ,[TYPE_CODE]
      ,[STUDENT_STATUS]
      ,[DESCRIPTION]
      ,[INSTITUTION_CONTEXT_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_PROGRESS_TYPES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Rc_Reports]...';


GO


CREATE   view [OneEBS].[Rc_Reports] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[IS_DIGITAL_SIGNATURE_SUPPORTED]
      ,[IS_BULK_REPORTING_ALLOWED]
      ,[ALTERNATIVE_CONTEXT]
      ,[ID]
      ,[NAME]
      ,[DISPLAY_NAME]
      ,[PATH]
      ,[DESCRIPTION]
      ,[IS_VISIBLE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[AGENT_CONTEXT]
      ,[APPLICATION]
      ,[CONTEXT]
      ,[PRINTER_SELECTION]
      ,[SAVE_FORMAT]
      ,[SUB_CONTEXT]
      ,[GEN_SEQ_NO] 
from edw.OneEBS_EBS_0165_RC_REPORTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Register_Event_Details]...';


GO

Create   view [OneEBS].[Register_Event_Details] AS  
Select [UPDATED_BY]
      ,[UPDATED_DATE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[UNCONFIRMED_LEARNER]
      ,[ILP_ACTIVE]
      ,[ILP_CAN_OVERRIDE]
      ,[INTERVIEW_PU_ID]
      ,[INTERVIEW_PUG_ID]
      ,[INTERVIEW_STATUS]
      ,[PLANNED_DURATION_TOTAL]
      ,[MARKED_DURATION_TOTAL]
      ,[IS_CONTACT]
      ,[EXTERNAL_DETAIL_REF_NO]
      ,[EXTERNAL_SOURCE]
      ,[DETAIL_STATUS]
      ,[FILLING_METHOD_ID]
      ,[SCHOLASTIC_YEAR]
      ,[ROLL_CLASS]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[REGISTER_EVENT_ID]
      ,[SESSION_CODE]
      ,[OBJECT_TYPE]
      ,[OBJECT_ID]
      ,[ORGANISATION_CODE]
      ,[CREATEDBY_PERSON_CODE]
      ,[IS_CONFIRMED]
      ,[LOCATION_CODE]
      ,[TUTORGROUP_ID]
      ,[PROGRESS_CODE]
      ,[TEMP_PROGRESS_CODE]
      ,[TEMP_PROGRESS_DATE]
      ,[IS_FOR_LEARNERS]
      ,[IS_FOR_TUTORS]
      ,[IS_FOR_ADMINS]
      ,[PERSON_FUNCTION]
      ,[ROOM_LAYOUT_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE] 
from edw.OneEBS_EBS_0165_REGISTER_EVENT_DETAILS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Register_Event_Details_Slots]...';


GO

Create   view [OneEBS].[Register_Event_Details_Slots] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[REGISTER_EVENT_ID]
      ,[REGISTER_EVENT_DETAIL_ID]
      ,[SESSION_CODE]
      ,[REGISTER_EVENT_SLOT_ID]
      ,[OBJECT_TYPE]
      ,[OBJECT_ID]
      ,[PLANNED_START_DATE]
      ,[PLANNED_END_DATE]
      ,[BREAK]
      ,[ACTUAL_START_DATE]
      ,[ACTUAL_END_DATE]
      ,[ADDITIONAL_TIME]
      ,[USAGE_CODE]
      ,[CONTRACT_ID]
      ,[CONTRACT_STATUS_ID]
      ,[AMOUNT_CLAIMED]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[HAS_MESSAGE_BEEN_SENT]
      ,[ASSOCIATED_BEHAVIOUR_ID]
      ,[IS_ABSENCE_JUSTIFIED] 
from edw.OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Register_Event_Slots]...';


GO

Create   view [OneEBS].[Register_Event_Slots] AS  
Select [MAXIMUM_LEARNERS]
      ,[TIMETABLE_PERIODS_ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[REGISTER_EVENT_ID]
      ,[SESSION_CODE]
      ,[STARTDATE]
      ,[ENDDATE]
      ,[BREAK]
      ,[SLOT_STATUS]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[REISSUED_BY]
      ,[REISSUED_DATE]
      ,[REISSUED_COUNT]
      ,[IS_ROLL_CALL] 
from edw.OneEBS_EBS_0165_REGISTER_EVENT_SLOTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Register_Events]...';


GO

Create   view [OneEBS].[Register_Events] AS  
Select [HAS_BEEN_MOVED_WHILST_LOCKED]
      ,[REGION_ORGANISATION_UNIT_ID]
      ,[ID]
      ,[SESSION_CODE]
      ,[EVENT_TYPE]
      ,[EVENT_CODE]
      ,[DESCRIPTION]
      ,[LEAD_MARKING]
      ,[REGISTER_WEEK_PATTERNS_ID]
      ,[REQUIRES_ATTENTION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[PROVIDER_ORGANISATION_CODE]
      ,[IS_FOR_EMA]
      ,[REGISTER_TYPE]
      ,[REGISTER_TYPE_START_DATE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[TIMETABLES_ID] 
from edw.OneEBS_EBS_0165_REGISTER_EVENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Rooms]...';


GO

Create   view [OneEBS].[Rooms] AS  
Select [ID]
      ,[ROOM_CODE]
      ,[SHORT_DESCRIPTION]
      ,[LONG_DESCRIPTION]
      ,[LOCATION_CODE]
      ,[CAPACITY]
      ,[COMMENTS]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_ACTIVE]
      ,[MASTER_MAP]
      ,[DETAILS_MAP]
      ,[ORGANISATION_CODE_1]
      ,[ORGANISATION_CODE_2]
      ,[SQUARE_METRES]
      ,[ROOM_TYPE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[USER_19]
      ,[USER_20]
      ,[USER_21]
      ,[USER_22]
      ,[USER_23]
      ,[USER_24]
      ,[USER_25]
      ,[USER_26]
      ,[IS_EXTERNALLY_SOURCED]
      ,[IS_CHANGE_NOTIFIED]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_ROOMS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Rules]...';


GO

Create   view [OneEBS].[Rules] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[DESCRIPTION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[RULE] 
from edw.OneEBS_EBS_0165_RULES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Ruleset_Rules]...';


GO

Create   view [OneEBS].[Ruleset_Rules] AS  
Select [ID]
      ,[RULESET_ID]
      ,[RULE_ID]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_RULESET_RULES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Rulesets]...';


GO

Create   view [OneEBS].[Rulesets] AS  
Select [ID]
      ,[TITLE]
      ,[DESCRIPTION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_RULESETS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Schools]...';


GO

Create   view [OneEBS].[Schools] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[SCHOOL_CODE]
      ,[FULL_NAME]
      ,[SHORT_NAME]
      ,[ADDRESS_LINE_1]
      ,[ADDRESS_LINE_2]
      ,[ADDRESS_LINE_3]
      ,[ADDRESS_LINE_4]
      ,[TOWN]
      ,[REGION]
      ,[COUNTRY]
      ,[UK_POST_CODE_PT1]
      ,[UK_POST_CODE_PT2]
      ,[TELEPHONE]
      ,[FAX]
      ,[EMAIL_ADDRESS]
      ,[HEAD_TITLE]
      ,[HEAD_INITIALS]
      ,[HEAD_SURNAME]
      ,[SCHOOL_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_ACTIVE]
      ,[SCHOOL_TYPE_NO]
      ,[START_DATE]
      ,[END_DATE]
      ,[REPORTS_TO]
      ,[DIOCESE]
      ,[CATEGORY] 
from edw.OneEBS_EBS_0165_SCHOOLS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Skills_List_Items]...';


GO

Create   view [OneEBS].[Skills_List_Items] AS  
Select [ID]
      ,[SKILLS_LISTS_ID]
      ,[QUALIFICATION_CODE]
      ,[TITLE]
      ,[IS_ACTIVE]
      ,[IS_LOC_AVAIL_FND_SKILLS]
      ,[IS_LOC_AVAIL_APPRENTICESHIP]
      ,[IS_LOC_AVAIL_TRAINEESHIP]
      ,[IS_LOC_AVAIL_TRGT_PRIORITY]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_SKILLS_LIST_ITEMS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Skills_Lists]...';


GO

Create   view [OneEBS].[Skills_Lists] AS  
Select [ID]
      ,[CODE]
      ,[START_DATE]
      ,[END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_SKILLS_LISTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Student_Status_Log]...';


GO

Create   view [OneEBS].[Student_Status_Log] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[PERSON_CODE]
      ,[STUDENT_STATUS_CODE]
      ,[START_DATE]
      ,[END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_STUDENT_STATUS_LOG 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Tills]...';


GO

Create   view [OneEBS].[Tills] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[LEGACY_TILL_CODE]
      ,[ID]
      ,[PC_NAME]
      ,[PC_DESCRIPTION]
      ,[EFTPOS_TERMINAL_ID]
      ,[CREATED_DATE]
      ,[CREATED_BY]
      ,[UPDATED_DATE]
      ,[UPDATED_BY]
      ,[TILL_CODE]
      ,[ORGANISATION_CODE] 
from edw.OneEBS_EBS_0165_TILLS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UI_ACCREDITATION]...';


GO



CREATE   view [OneEBS].[UI_ACCREDITATION] AS  
Select [ACCREDITATION_AUTHORITY]
      ,[APPLICATION]
      ,[ARTICULATION_ARRANGEMENT]
      ,[ASSESSMENT_STRATEGIES]
      ,[CONSULTATION]
      ,[COPYRIGHT_ACKNOWLEDGEMENT]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[DAYS_CURRENCY]
      ,[FRANCHISING]
      ,[ID]
      ,[INSTITUTION_CONTEXT_ID]
      ,[LICENSING_INFORMATION]
      ,[ONGOING_MONITORING]
      ,[OUTCOMES]
      ,[PHYSICAL_RESOURCES]
      ,[SUBMISSION_TYPE]
      ,[UNIT_INSTANCE_CODE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
from edw.OneEBS_EBS_0165_UI_ACCREDITATION 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UI_Links]...';


GO



CREATE   view [OneEBS].[UI_Links] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[UI_CODE_FROM]
      ,[UI_CODE_TO]
      ,[LINK_TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[START_DATE]
      ,[END_DATE]
      ,[PROGRESS_WEIGHT]
      ,[DEFAULT_PROGRESS_CODE]
      ,[TARGET_WEIGHT]
      ,[IS_CORE]
      ,[IS_EXCLUDED_FROM_AWARD_CALC]
      ,[IS_GRADE_AWARD_OUTCOME_CONTRIB]
      ,[SEQUENCENUMBER] 
from edw.OneEBS_EBS_0900_UI_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UI_Target_Audiences]...';


GO



CREATE   view [OneEBS].[UI_Target_Audiences] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[UI_ID]
      ,[TARGET_AUDIENCE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_UI_TARGET_AUDIENCES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UIO_Instalment_Plans]...';


GO




CREATE   view [OneEBS].[UIO_Instalment_Plans] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[UIO_ID]
      ,[START_DATE]
      ,[END_DATE]
      ,[DESCRIPTION]
      ,[INTERVAL]
      ,[NUMBER_OF_SLOTS]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_UIO_INSTALMENT_PLANS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UIO_Instalments]...';


GO



CREATE   view [OneEBS].[UIO_Instalments] AS  
Select [FIXED_FEE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[UIO_INSTALMENT_PLANS_ID]
      ,[DUE_DATE]
      ,[NUMBER_OF_DAYS]
      ,[INSTALMENT_NUMBER]
      ,[PERCENTAGE]
      ,[IS_ACTIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_UIO_INSTALMENTS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UIO_Links]...';


GO



CREATE   view [OneEBS].[UIO_Links] AS  
Select [CASCADE_SPECIAL_DETAILS]
      ,[INSTITUTION_CONTEXT_ID]
      ,[UIO_ID_FROM]
      ,[UIO_ID_TO]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[CALOCC_CODE_FROM]
      ,[CALOCC_CODE_TO]
      ,[CREATE_APP_UNIT]
      ,[DELIVERY_DATE]
      ,[EXPLODE]
      ,[MANDATORY]
      ,[UI_CODE_FROM]
      ,[UI_CODE_TO]
      ,[WEEK_NUMBER]
      ,[SEQUENCENUMBER]
      ,[IS_AVAILABLE]
      ,[AVAILABLE_FROM]
      ,[AVAILABLE_TO]
      ,[DEFAULT_PROGRESS_CODE]
      ,[IS_CORE] 
from edw.OneEBS_EBS_0165_UIO_LINKS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[UIO_Organisation_Units]...';


GO



CREATE   view [OneEBS].[UIO_Organisation_Units] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[UIO_ID]
      ,[ORGANISATION_CODE]
      ,[TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE] 
from edw.OneEBS_EBS_0165_UIO_ORGANISATION_UNITS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Unit_Instance_Awards]...';


GO

Create   view [OneEBS].[Unit_Instance_Awards] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[UPDATED_DATE]
      ,[ID]
      ,[UNIT_INSTANCE_CODE]
      ,[AWARD_ID]
      ,[MAIN]
      ,[TYPE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY] 
from edw.OneEBS_EBS_0165_UNIT_INSTANCE_AWARDS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Unit_Instance_Occurrences]...';


GO

Create   view [OneEBS].[Unit_Instance_Occurrences] AS  
Select [REGISTER_MODE]
      ,[REGISTER_TYPE]
      ,[NUMBER_OF_ENQUIRIES]
      ,[TARGET_PLACES]
      ,[LONG_DESCRIPTION]
      ,[COURSE_INCENTIVE]
      ,[INCENTIVE_TYPE]
      ,[COURSE_LEVEL]
      ,[SP_VISIBLE]
      ,[SP_CAN_ENQUIRE]
      ,[SP_CAN_APPLY]
      ,[SP_CAN_ENROL]
      ,[SP_CAN_WAIT]
      ,[CALC_SPCL_END_DATE]
      ,[FES_LENGTH]
      ,[FES_UNITS_OF_LENGTH]
      ,[EXCEED_UIO_CAPACITY]
      ,[NOTES_ID]
      ,[CALC_TOTAL_PLACES]
      ,[UCAS]
      ,[UCAS_APPLICATION_YEAR]
      ,[SUPERVISOR]
      ,[SUPERVISOR_ROLE]
      ,[SUP_START_DATE]
      ,[EMA_AWARDING]
      ,[EXPORT]
      ,[GENERATE_AWARD]
      ,[ILP_ACTIVE]
      ,[ILP_CAN_OVERRIDE]
      ,[EMA_COURSE_TYPE]
      ,[CAN_ENQUIRE]
      ,[CAN_APPLY]
      ,[CAN_ENROL]
      ,[CAN_WAIT]
      ,[WAITING]
      ,[COURSE_OCCURRENCE_CODE]
      ,[STATUS]
      ,[IMAGE_LOCATION]
      ,[IS_SHAREABLE]
      ,[UIO_TYPE]
      ,[KEYWORDS]
      ,[PROVIDER_ID]
      ,[MAYTAS_E_TRACK]
      ,[COURSE_EFTS_FACTOR]
      ,[COMPULSORY_COURSE_COST_FEE]
      ,[INCLUDE_IN_LEARNER_RETURN]
      ,[MIN_CREDITS_REQUIRED]
      ,[COURSE_CREDITS]
      ,[FES_RETENTION_CONT]
      ,[FES_ACHIEVEMENT]
      ,[NZ_FUNDING]
      ,[GEN_FEES_ENROLMENT]
      ,[REQUIRES_ATTAINMENT]
      ,[NUM_DAYS_CAN_ENROL]
      ,[NUM_DAYS_CAN_DROP]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[FES_USER_13]
      ,[FES_USER_14]
      ,[FES_USER_15]
      ,[FES_USER_16]
      ,[FES_USER_17]
      ,[FES_USER_18]
      ,[FES_USER_19]
      ,[FES_USER_20]
      ,[FES_USER_21]
      ,[FES_USER_22]
      ,[FES_USER_23]
      ,[FES_USER_24]
      ,[FES_USER_25]
      ,[FES_USER_26]
      ,[LP_INDICATIVE_START_DATES]
      ,[MAX_RESIT_GRADE]
      ,[LP_INDICATIVE_COSTS]
      ,[VERSION_NUMBER]
      ,[VERSION_DATE]
      ,[MAXIMUM_HOURS]
      ,[PROSP_USER_11]
      ,[PROSP_USER_12]
      ,[INCLUDE_IN_DATA_RETURN]
      ,[PRINT_NAME]
      ,[OFFERING_TYPE]
      ,[VFH_ADMIN_DATE]
      ,[VFH_CENSUS_DATE]
      ,[VFH_DELIVERY_MODE]
      ,[DEF_LEARNER_USAGE_CODE]
      ,[IS_ELIGIBLE_FOR_INSTALMENT]
      ,[FEE_DUE_DATE]
      ,[SELECTION_OPENING_DATE]
      ,[SELECTION_CLOSING_DATE]
      ,[NUMBER_SUBJECT_CHOICES]
      ,[NUMBER_RESERVES]
      ,[PROSP_USER_13]
      ,[PROSP_USER_14]
      ,[PROSP_USER_15]
      ,[PROSP_USER_16]
      ,[PROSP_USER_17]
      ,[PROSP_USER_18]
      ,[PROSP_USER_19]
      ,[CAN_LEARNER_REGISTER]
      ,[CAN_REGISTER]
      ,[HAS_APPLICATION_QUESTIONS]
      ,[OFFERING_STATUS]
      ,[PAYMENT_DUE_DATE]
      ,[IS_FLEXIBLE_DELIVERY]
      ,[SCHOLASTIC_YEAR]
      ,[TARGET_SECTOR]
      ,[DEFAULT_VTO_CODE]
      ,[IS_SHARED_DELIVERY]
      ,[SHARED_ORGANISATION]
      ,[HAS_OPTIONAL_EXAM]
      ,[REQUIRES_ENTRANCE_SCORE]
      ,[DELIVERY_LOCATION]
      ,[AWARD_CODE]
      ,[AWARD_RULESET_ID]
      ,[FES_COURSE_CONTACT]
      ,[RPL_FUND_FACTOR]
      ,[IS_INCLUDED_IN_COURSE_REPORT]
      ,[INDICATIVE_COURSE_COST]
      ,[ESTIMATED_STUDENT_LOAD]
      ,[CREATED_BY_BATCH_NO]
      ,[UNIT_OF_STUDY_CODE]
      ,[COURSE_EFTSL_FACTOR]
      ,[WAIVER_CODE]
      ,[CAN_BE_APPROVED_FOR_DELIVERY]
      ,[PURCHASING_CONTRACT_IDENTIFIER]
      ,[PURCHASING_CONTRACT_SCHED_ID]
      ,[SECONDARY_LENGTH]
      ,[SECONDARY_LENGTH_UNIT]
      ,[IS_GOVT_SUBSID_COURSE]
      ,[PROGRAM_STREAM_DEPRECATED]
      ,[FULLY_REFUNDED_WITHDRAWAL_DATE]
      ,[INSTALMENT_PLAN_TEMPLATE_ID]
      ,[ROLL_FORWARD_SOURCE_UIO_ID]
      ,[RE_ROLL_FORWARD_BY]
      ,[RE_ROLL_FORWARD_DATE]
      ,[CAN_WITHDRAW_EARLY]
      ,[INSTITUTION_CONTEXT_ID]
      ,[CAN_OFFER_MGD_APPSHIP]
      ,[IS_SHOWN_IN_TIMETABLE]
      ,[VSL_LOAN_CAP]
      ,[PREDOMINANT_DELIVERY_MODE]
      ,[REFUND_PERIOD]
      ,[ALLOW_CHILD_UNIT_SELECTION]
      ,[TOTAL_REQUIRED_CHILD_UNITS]
      ,[CHILD_UNIT_VALUE]
      ,[ALLOW_CHILD_UNIT_DROP]
      ,[CAN_LEARNER_DROP]
      ,[YEAR_OF_UNIT]
      ,[IS_AVAILABLE_FOR_BLOCK_BOOKING]
      ,[BLOCK_BOOK_NAMING_PERIOD]
      ,[BOOKABLE_PLACES]
      ,[HAS_ONLINE_CONTENT]
      ,[YEAR_LONG_INDICATOR]
      ,[REGION_ORGANISATION]
      ,[CALOCC_CALENDAR_TYPE_CODE]
      ,[CALOCC_OCCURRENCE_CODE]
      ,[TOTAL_PLACES]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_MIN_PLACES]
      ,[FES_TRIGGER_PLACES]
      ,[FES_ACTIVE_PLACES]
      ,[FES_TRANSFERRED_PLACES]
      ,[FES_WITHDRAWN_PLACES]
      ,[FES_NO_OF_HOURS]
      ,[FES_NO_OF_WEEKS]
      ,[FES_POSSIBLE_HOURS]
      ,[FES_RETENTION]
      ,[FES_SUCCESS]
      ,[FES_DAY_OF_WEEK]
      ,[FES_START_TIME]
      ,[FES_END_TIME]
      ,[FES_START_DATE]
      ,[FES_END_DATE]
      ,[FES_UINS_INSTANCE_CODE]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[FES_NON_STARTER_PLACES]
      ,[FES_FINISHED_PLACES]
      ,[TOTAL_PLACES_APPS]
      ,[ACTIVE_APPS]
      ,[WITHDRAWN_APPS]
      ,[TRANSFERRED_APPS]
      ,[ROLLED_FORWARD_APPS]
      ,[PLACES_BOOKED]
      ,[ROOM_CODE]
      ,[STAFF_CODE]
      ,[DURATION]
      ,[QUAL_START_DATE]
      ,[QUAL_END_DATE]
      ,[PENDING_RF_APPS]
      ,[TIME_OF_DAY]
      ,[PROSP_USER_1]
      ,[PROSP_USER_2]
      ,[PROSP_USER_3]
      ,[PROSP_USER_4]
      ,[PROSP_USER_5]
      ,[PROSP_USER_6]
      ,[PROSP_USER_7]
      ,[PROSP_USER_8]
      ,[PROSP_USER_9]
      ,[PROSP_USER_10]
      ,[UIO_ID]
      ,[FES_ACTIVE]
      ,[OWNING_ORGANISATION]
      ,[OFFERING_ORGANISATION]
      ,[SLOC_LOCATION_CODE]
      ,[FES_UNIT_LEADER]
      ,[FES_STATUS]
      ,[FES_MOA_CODE] 
from edw.OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Unit_Instances]...';


GO

Create   view [OneEBS].[Unit_Instances] AS  
Select [UNIT_UNIT_CODE]
      ,[SLOC_LOCATION_CODE]
      ,[EFFECTIVE_START_DATE]
      ,[UNIT_CATEGORY]
      ,[CTYPE_CALENDAR_TYPE_CODE]
      ,[TOPIC_TOPIC_CODE]
      ,[FULL_DESCRIPTION]
      ,[EFFECTIVE_END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[TOTAL_PLACES]
      ,[CATS_CREDITS]
      ,[CATS_LEVEL]
      ,[FES_UNIT_INSTANCE_CODE]
      ,[FES_ACTIVE]
      ,[FES_ENROL_FLAG]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[FES_LEADS_TO]
      ,[FES_QUALIFICATION_TYPE]
      ,[FES_UNIT_LEADER]
      ,[FES_STATUS]
      ,[FES_MOA_CODE]
      ,[FES_LENGTH]
      ,[FES_UNITS_OF_LENGTH]
      ,[FES_YEAR_OF_UNIT]
      ,[FES_APPROVAL_RECEIVED]
      ,[FES_SOURCE_FINANCE]
      ,[FES_ISR]
      ,[FES_LEARN_AGREE_REQ]
      ,[FES_USER_1]
      ,[FES_USER_2]
      ,[FES_USER_3]
      ,[FES_USER_4]
      ,[FES_USER_5]
      ,[FES_USER_6]
      ,[REGISTER_MODE]
      ,[REGISTER_TYPE]
      ,[PREREQUISITES]
      ,[OFFERING_ORGANISATION]
      ,[OWNING_ORGANISATION]
      ,[VTR]
      ,[PROSPECTUS_TYPE]
      ,[PROSP_USER_1]
      ,[PROSP_USER_2]
      ,[PROSP_USER_3]
      ,[PROSP_USER_4]
      ,[PROSP_USER_5]
      ,[PROSP_USER_6]
      ,[PROSP_USER_7]
      ,[PROSP_USER_8]
      ,[PROSP_USER_9]
      ,[PROSP_USER_10]
      ,[PROSPECTUS_ITEM]
      ,[UI_ID]
      ,[UI_TYPE]
      ,[UCAS_COURSE_CODE]
      ,[INCLUDE_IN_HESA]
      ,[UCAS_POINT_OF_ENTRY]
      ,[UNIT_TYPE]
      ,[AE1]
      ,[NOTES_ID]
      ,[BLOCK_MATRIX]
      ,[MAYTAS_E_TRACK]
      ,[SDR_QUALIFICATION_CODE]
      ,[SDR_COURSE_CODE]
      ,[FUNDING_CATEGORY]
      ,[COURSE_CLASSIFICATION]
      ,[NZSCED]
      ,[SDR_REGISTER_LEVEL]
      ,[COURSE_CREDITS]
      ,[QUALIFICATION_STAGE]
      ,[INTERNET_BASED_LEARNING]
      ,[SDR_PBRF_ELIGIBLE]
      ,[EXEMPT_INDICATOR]
      ,[EMBEDDED_LITERACY_NUMERACY]
      ,[MAIN_SUBJECT_1]
      ,[MAIN_SUBJECT_2]
      ,[MAIN_SUBJECT_3]
      ,[FUNDING_STATUS]
      ,[PROGRAMME_CODE]
      ,[COMPLETION_RETURN]
      ,[MIN_CREDITS_REQUIRED]
      ,[IS_ACCREDITED]
      ,[ACCREDITATION_EXPIRY_DATE]
      ,[DELIVERY_LANGUAGE]
      ,[CONTENTS]
      ,[EVALUATION_METHOD]
      ,[VOCATION]
      ,[FURTHER_OPPORTUNITIES]
      ,[AIM_DESCRIPTION]
      ,[UNIT_STANDARD_SUBFIELD]
      ,[UNIT_STANDARD_DOMAIN]
      ,[AMAP_REFERENCE]
      ,[QUAL_AWARDED]
      ,[ALTERNATIVE_NAME]
      ,[VERSION]
      ,[PRICE_BAND_ID]
      ,[GRADING_SCHEME_ID]
      ,[AWARD_CATEGORY_CODE]
      ,[COURSE_EFTS_FACTOR]
      ,[INCLUDE_FEES_IN_STUDYLINK]
      ,[REQUIRES_APPLICATION]
      ,[REQUIRES_ATTAINMENT]
      ,[IS_SHORT_COURSE]
      ,[FES_USER_7]
      ,[FES_USER_8]
      ,[FES_USER_9]
      ,[FES_USER_10]
      ,[FES_USER_11]
      ,[FES_USER_12]
      ,[FES_USER_13]
      ,[FES_USER_14]
      ,[FES_USER_15]
      ,[FES_USER_16]
      ,[FES_USER_17]
      ,[FES_USER_18]
      ,[FES_USER_19]
      ,[FES_USER_20]
      ,[FES_USER_21]
      ,[FES_USER_22]
      ,[FES_USER_23]
      ,[FES_USER_24]
      ,[FES_USER_25]
      ,[FES_USER_26]
      ,[GEN_FEES_ENROLMENT]
      ,[NUM_DAYS_CAN_ENROL]
      ,[NUM_DAYS_CAN_DROP]
      ,[LP_INDICATIVE_START_DATES]
      ,[LP_INDICATIVE_COSTS]
      ,[DEF_ASSESS_GRADING_SCHEME_ID]
      ,[EXTERNAL_COURSE_CODE]
      ,[IS_NZDIPBUS]
      ,[INVOLVES_WORK_EXP]
      ,[FES_USER_27]
      ,[FES_USER_28]
      ,[FES_USER_29]
      ,[FES_USER_30]
      ,[FES_USER_31]
      ,[FES_USER_32]
      ,[FES_USER_33]
      ,[FES_USER_34]
      ,[FES_USER_35]
      ,[FES_USER_36]
      ,[FES_USER_37]
      ,[FES_USER_38]
      ,[FES_USER_39]
      ,[FES_USER_40]
      ,[FES_USER_41]
      ,[FES_USER_42]
      ,[FES_USER_43]
      ,[FES_USER_44]
      ,[FES_USER_45]
      ,[FES_USER_46]
      ,[FES_USER_47]
      ,[FES_USER_48]
      ,[FES_USER_49]
      ,[FES_USER_50]
      ,[VERSION_NUMBER]
      ,[VERSION_DATE]
      ,[MAXIMUM_HOURS]
      ,[IS_VTO_PROGRAM]
      ,[STEM_VALUE]
      ,[UI_LEVEL]
      ,[RAM_CATEGORY]
      ,[PROCESSING_TYPE]
      ,[DELEGATION_CATEGORY]
      ,[REPLACED_UNIT_INSTANCE_CODE]
      ,[VTO_CODE]
      ,[IS_VET_FEE_HELP]
      ,[IS_FEE_HELP]
      ,[IS_BOS_COURSE]
      ,[REVIEW_DATE]
      ,[PROSP_USER_11]
      ,[PROSP_USER_12]
      ,[UNIT_CURRENCY_YEARS]
      ,[UNIT_CURRENCY_MONTHS]
      ,[STAGE]
      ,[LEARNING_PROG_TYPE]
      ,[STUDIED_FROM_YEAR]
      ,[STUDIED_TO_YEAR]
      ,[CENSUS_SUBJECT]
      ,[KEY_LEARNING_AREA_SUBJECT]
      ,[SCHOLASTIC_YEAR]
      ,[EXTERNAL_COURSE_NAME]
      ,[COURSE_HOURS]
      ,[WORK_PLACEMENT_HOURS]
      ,[ACCREDITATION_TYPE]
      ,[CRD_ID]
      ,[ACCREDITED_UNITS]
      ,[QUALIFICATION_LEVEL]
      ,[FUNDING_BODY_COST_CATEGORY]
      ,[ACCREDITED_HOURS]
      ,[FUNDING_BODY_ALLOCATED_HOURS]
      ,[COURSE_OCCUPATION]
      ,[INTERNATIONAL_COURSE_CODE]
      ,[EXIT_POINTS]
      ,[CAN_ENROL_1]
      ,[CAN_ENROL_2]
      ,[CAN_ENROL_3]
      ,[SCOPE_APPROVED]
      ,[STATUS_CHANGE_DATE]
      ,[SPECIAL_COURSE_INDICATOR]
      ,[NATIONAL_COURSE_CODE]
      ,[COURSE_EFTSL_FACTOR]
      ,[IS_VOCATIONAL]
      ,[COURSE_STUDY_LOAD]
      ,[IS_SUBSIDISED]
      ,[HAS_ENH_ASSESSMENT_MARKING]
      ,[INSTITUTION_CONTEXT_ID]
      ,[HAS_LIMITED_ABILITY_TO_OFFER]
      ,[RECOGNITION_LEVEL]
      ,[IS_SHOWN_IN_TIMETABLE]
      ,[REFUND_PERIOD]
      ,[HAS_ONLINE_CONTENT]
      ,[STANDARD_COURSE_DURATION] 
from edw.OneEBS_EBS_0900_UNIT_INSTANCES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Usages]...';


GO

Create   view [OneEBS].[Usages] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[IS_NOT_AVAILABLE_IN_AGENT]
      ,[IS_NOT_OVERWRITABLE_IN_AGENT]
      ,[ID]
      ,[USAGE_CODE]
      ,[OBJECT_TYPE]
      ,[DESCRIPTION]
      ,[IS_POSITIVE]
      ,[IS_DEFAULT_USAGE]
      ,[ALTERNATE_KEY]
      ,[POSITIVE_FOR_EMA]
      ,[FES_ACTIVE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[IS_LATE]
      ,[IS_NOT_IN_CLASS]
      ,[BG_COLOUR]
      ,[SELECTION_ORDER]
      ,[IS_PARTIAL] 
from edw.OneEBS_EBS_0165_USAGES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Users]...';


GO

Create   view [OneEBS].[Users] AS  
Select [CURRENT_INSTITUTION_CONTEXT]
      ,[INSTITUTION_CONTEXT_ID]
      ,[LOCKED_UNTIL]
      ,[FAILED_LOGIN_ATTEMPTS]
      ,[PASSWORD_CAN_EXPIRE]
      ,[ID]
      ,[GROUP_ID]
      ,[NAME]
      ,[PASS]
      ,[STATUS]
      ,[STUDENT_OR_TUTOR_ID]
      ,[DIALINUSERNAME]
      ,[ENABLED]
      ,[HAVEAUDIO]
      ,[HAVEVIDEO]
      ,[INMEETING]
      ,[IPADDRESS]
      ,[PERSON_ID]
      ,[DEFAULTEMAIL]
      ,[CANCHANGEEMAIL]
      ,[PASSEXPIRYDATE]
      ,[EBS_PERSON_CODE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[LDAP_PATH]
      ,[AUTHENTICATION_TYPE]
      ,[DEFAULT_ROLE]
      ,[GROUP_ID2]
      ,[USER_KEY]
      ,[ENC_METHOD]
      ,[DEFAULT_AGENT_ROLE]
      ,[EXTERNAL_REF] 
from edw.OneEBS_EBS_0165_USERS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Vat_Rates]...';


GO

Create   view [OneEBS].[Vat_Rates] AS  
Select [VAT_RATE_CODE]
      ,[VAT_RATE_PERCENTAGE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[CFACS_VAT_RATE]
      ,[FES_ROUNDING_FACTOR]
      ,[FES_ACTIVE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[IS_DGR_APPLICABLE] 
from edw.OneEBS_EBS_0165_VAT_RATES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Verifier_Properties]...';


GO

Create   view [OneEBS].[Verifier_Properties] AS  
Select [ID]
      ,[RV_DOMAIN]
      ,[LOW_VALUE]
      ,[PROPERTY_NAME]
      ,[PROPERTY_VALUE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0900_VERIFIER_PROPERTIES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Verifiers]...';


GO

Create   view [OneEBS].[Verifiers] AS  
Select [ID]
      ,[LOW_VALUE]
      ,[RV_DOMAIN]
      ,[ABBREVIATION]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[FRANCHISING_TYPE]
      ,[OPS_MASTER]
      ,[FES_SHORT_DESCRIPTION]
      ,[FES_LONG_DESCRIPTION]
      ,[SIR_VALUE]
      ,[FES_ACTIVE]
      ,[ROLE_DEFS_ID]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0900_VERIFIERS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Visa_Subclasses]...';


GO

Create   view [OneEBS].[Visa_Subclasses] AS  
Select [IS_FEE_APPLICABLE]
      ,[START_DATE]
      ,[END_DATE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[CODE]
      ,[DESCRIPTION]
      ,[VISA_TYPE]
      ,[VISA_CLASS]
      ,[IS_ACTIVE]
      ,[IS_TEMPORARY_VISA_HOLDER]
      ,[IS_ENROLMENT_APPLICABLE]
      ,[IS_TUITION_FEE] 
from edw.OneEBS_EBS_0165_VISA_SUBCLASSES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Visas]...';


GO

Create   view [OneEBS].[Visas] AS  
Select [ID]
      ,[PERSON_CODE]
      ,[VISA_TYPE]
      ,[ISSUE_DATE]
      ,[EXPIRY_DATE]
      ,[CONDITIONS]
      ,[PERMIT_LABEL_NO]
      ,[VISA_LABEL_NO]
      ,[STATUS]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[BLOB_ID]
      ,[INZ_FILE_CREATED]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[USER_11]
      ,[USER_12]
      ,[USER_13]
      ,[USER_14]
      ,[USER_15]
      ,[USER_16]
      ,[USER_17]
      ,[USER_18]
      ,[USER_19]
      ,[USER_20]
      ,[VISA_SUB_CLASS]
      ,[VISA_HOLDER_CODE]
      ,[INSTITUTION_CONTEXT_ID] 
from edw.OneEBS_EBS_0165_VISAS 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Waiver_Types]...';


GO

Create   view [OneEBS].[Waiver_Types] AS  
Select [WAIVER_CODE]
      ,[LONG_DESCRIPTION]
      ,[SHORT_DESCRIPTION]
      ,[LOWER_AGE_LIMIT]
      ,[UPPER_AGE_LIMIT]
      ,[STAFF_WAIVER]
      ,[DISABILITY_DEPENDENCIES]
      ,[EXCLUSIVE_WAIVER]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[EXCLUSIVE_FEE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[FEE_EXEMPTION]
      ,[INSTITUTION_CONTEXT_ID]
      ,[IS_ONCE_PER_CALENDAR_YEAR]
      ,[IS_FEE_HELP_APPLICABLE]
      ,[IS_VET_FEE_HELP_APPLICABLE] 
from edw.OneEBS_EBS_0165_WAIVER_TYPES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Waiver_Values]...';


GO

Create   view [OneEBS].[Waiver_Values] AS  
Select [IS_ELIGIBLE_FOR_FEES_FREE]
      ,[ROUNDING_FACTOR]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[SP_VISIBLE]
      ,[SP_EVIDENCE_STATEMENT]
      ,[SP_PUBLIC_WAIVER_CODE]
      ,[USER_1]
      ,[USER_2]
      ,[USER_3]
      ,[USER_4]
      ,[USER_5]
      ,[USER_6]
      ,[USER_7]
      ,[USER_8]
      ,[USER_9]
      ,[USER_10]
      ,[INSTITUTION_CONTEXT_ID]
      ,[WAIVER_VALUE_NUMBER]
      ,[WAIVER_CODE]
      ,[CALOCC_CODE]
      ,[CALOCC_CTYPE]
      ,[START_DATE]
      ,[END_DATE]
      ,[CALC_CRITERIA]
      ,[CALC_VALUE] 
from edw.OneEBS_EBS_0165_WAIVER_VALUES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Web_Config]...';


GO

Create   view [OneEBS].[Web_Config] AS  
Select [INSTITUTION_CONTEXT_ID]
      ,[ID]
      ,[CAN_BE_OVERRIDDEN]
      ,[PARAMETER]
      ,[PARAMETER_VALUE]
      ,[APP_ID]
      ,[AREA_CODE]
      ,[DESCRIPTION]
      ,[DATA_TYPE]
      ,[VERIFIER]
      ,[LINK_URL]
      ,[LINK_DESCRIPTION]
      ,[NON_NULLABLE]
      ,[CREATED_BY]
      ,[CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[VISIBLE]
      ,[PRODUCT_MODULE_ID]
      ,[RESTRICT_TO_LICENCE]
      ,[DISPLAY_ORDER]
      ,[RESTRICT_BY_INST_TYPE]
      ,[MIN_VALUE]
      ,[MAX_VALUE]
      ,[VALIDATION_PATTERN] 
from edw.OneEBS_EBS_0165_WEB_CONFIG 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Creating View [OneEBS].[Z_Read_Batches]...';


GO
Create   view [OneEBS].[Z_Read_Batches] AS  
Select [CREATED_DATE]
      ,[UPDATED_BY]
      ,[UPDATED_DATE]
      ,[BANKED_BY]
      ,[PC_NAME]
      ,[BANKING_GROUP_ID]
      ,[ORGANISATION_ID]
      ,[BANKING_DEPOSIT_NO]
      ,[INSTITUTION_CONTEXT_ID]
      ,[DATE_TO_BE_BANKED]
      ,[ID]
      ,[TILL_CODE]
      ,[CREATED_BY] 
from edw.OneEBS_EBS_0165_Z_READ_BATCHES 
WHERE        (_RecordDeleted = 0) AND (_RecordCurrent = 1)
GO
PRINT N'Refreshing Procedure [UMD].[USP_RefreshUMDDataModel]...';


GO
EXECUTE sp_refreshsqlmodule N'[UMD].[USP_RefreshUMDDataModel]';


GO
PRINT N'Refreshing Procedure [compliance].[PopulatePeopleUnitLinks]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[PopulatePeopleUnitLinks]';


GO
--This SP will drop any masking from the Production environment.
EXEC dbo.spDropAllMasking
GO

GO
PRINT N'Update complete.';


GO
