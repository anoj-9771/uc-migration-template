/*
Deployment script for ZEASQLDBEDW01

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "ZEASQLDBEDW01"
:setvar DefaultFilePrefix "ZEASQLDBEDW01"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (QUERY_CAPTURE_MODE = ALL, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367)) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [sys].[databases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE = OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
PRINT N'Altering Table [compliance].[AvetmissCourseEnrolment]...';


GO
ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [CreditTransferNationalRecognitionUnitCount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [CreditTransferUnitCount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [LocationLoadingAmount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [NeedsLoadingAmount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [PassGradeUnitCount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [StandardSubsidyAmount] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissCourseEnrolment] ALTER COLUMN [SubsidisedAmount] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [compliance].[AvetmissPrimaryLearner]...';


GO
ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [AddressLine1Value] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [DateOfBirth] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [MobilePhoneScore] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [MobilePhoneValue] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [PersonalEmailScore] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [PersonalEmailValue] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissPrimaryLearner] ALTER COLUMN [Surname] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [compliance].[AvetmissStudent]...';


GO
ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [DateOfBirth] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [EmailAddress] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [HomePhone] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [MobilePhone] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressCountry] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressLine1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressLine2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressLine3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressLine4] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressLine5] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressPostcode] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressPostcodeName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAddressRegion] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [PostalAvetmissCountry] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [ResidentialAddressLine1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [ResidentialAddressLine2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [ResidentialAddressLine3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [ResidentialAddressLine4] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [ResidentialAddressLine5] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [Surname] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaClassName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaClassNo] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaExpiryDate] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaHolderCode] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaHolderDescription] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaIssueDate] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaProvided] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaSubClass] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaSubClassDescription] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [VisaType] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [compliance].[AvetmissStudent] ALTER COLUMN [WorkPhone] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [compliance].[AvetmissUnitEnrolment]...';


GO
ALTER TABLE [compliance].[AvetmissUnitEnrolment] ALTER COLUMN [AvetmissFundingSourceNationalId] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[eChecklist_dbo_checklists_actions]...';


GO
ALTER TABLE [edw].[eChecklist_dbo_checklists_actions] ALTER COLUMN [ReminderEmailData] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_ADDRESSES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_LINE_1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_LINE_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_LINE_3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_LINE_4] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_LINE_5] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [ADDRESS_TYPE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [EMAIL_ADDRESS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [FES_TELEPHONE_LINE_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ADDRESSES] ALTER COLUMN [TELEPHONE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_ATTAINMENTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [CATS_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ATTAINMENTS] ALTER COLUMN [EXPORTED_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_AWARDS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_AWARDS] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_AWARDS_ORIGINAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_AWARDS_ORIGINAL] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_COURSE_ASSESSMENTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_COURSE_ASSESSMENTS] ALTER COLUMN [MIN_PASS_MARK] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEE_CATEGORIES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_CATEGORIES] ALTER COLUMN [ACCOUNT_CODE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEE_TYPES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_TYPES] ALTER COLUMN [FES_ACCOUNT_CODE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEE_VALUES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_VALUES] ALTER COLUMN [ACCOUNT_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_VALUES] ALTER COLUMN [AMOUNT_PAYABLE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_VALUES] ALTER COLUMN [DOMESTIC_FCR_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_VALUES] ALTER COLUMN [NO_OF_OVERSEAS_PAYERS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEE_VALUES] ALTER COLUMN [OVERSEAS_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [ACCOUNT_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EPAYMENT_EXTERNAL_REF] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EPAYMENT_STATUS_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EPAYMENT_TRANSACTION_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_REF] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [FES_GROSS_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [FES_VAT_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INTERNAL_INVOICE_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INTERNAL_INVOICE_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INVOICE_GROUP_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [INVOICE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [PAYMENT_METHOD] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST] ALTER COLUMN [TENDERED_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST_ALLOCATED]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_ALLOCATED] ALTER COLUMN [AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_ALLOCATED] ALTER COLUMN [AMOUNT_TEMP] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_ALLOCATED] ALTER COLUMN [VAT_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [ACCOUNT_NAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [CARD_HOLDER_NAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [CARD_TYPE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [ELECTRONIC_PAYMENT_REF_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [GL_ACCOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [SUB_ACCOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_SPECIAL] ALTER COLUMN [SWIFT_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [ACCOUNT_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [EPAYMENT_EXTERNAL_REF] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [EPAYMENT_STATUS_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [EPAYMENT_TRANSACTION_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [EXTERNAL_REFUND_PAYMENT_REF] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [FES_GROSS_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [FES_VAT_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [INTERNAL_INVOICE_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [INTERNAL_INVOICE_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [INVOICE_GROUP_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [INVOICE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [PAYMENT_METHOD] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_TEMP] ALTER COLUMN [TENDERED_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_FEES_LIST_WAIVERS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_FEES_LIST_WAIVERS] ALTER COLUMN [ADJUSTMENT_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [EPAYMENT_EXTERNAL_REF] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [EPAYMENT_STATUS_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [EPAYMENT_TRANSACTION_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [INTERNAL_INVOICE_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_INSTALMENT_PLANS] ALTER COLUMN [INTERNAL_INVOICE_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_LOCATIONS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_LOCATIONS] ALTER COLUMN [ADDRESS_LINE_1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_LOCATIONS] ALTER COLUMN [ADDRESS_LINE_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_LOCATIONS] ALTER COLUMN [ADDRESS_LINE_3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_LOCATIONS] ALTER COLUMN [ADDRESS_LINE_4] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [ADDRESS_LINE_1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [ADDRESS_LINE_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [ADDRESS_LINE_3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [FES_FULL_NAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [HEALTH_SAFETY_CERT_EXP_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [HEALTH_SAFETY_STATUS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [LIABILITY_INS_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_ORGANISATION_UNITS] ALTER COLUMN [TELEPHONE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [ASSES_FORM_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [AUTHORITY_TO_ENROL_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [CNX_CARDHOLDER_ID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [COLLEGE_EMAIL] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [CONCESSION_CODE_EXPIRY] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [DATE_OF_BIRTH] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [ELECTRONIC_PAYMENT_REF_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [ETHNICITY] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [EXPORT_ACCEPTANCE_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [MEDICAL_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [MOBILE_PHONE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [NZ_ETHNICITY_1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [NZ_ETHNICITY_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [NZ_ETHNICITY_3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PASSPORT_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PASSPORT_ISSUE_COUNTRY] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PASSPORT_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PERSONAL_EMAIL] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PREFERRED_FIRST_NAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [PREVIOUS_SURNAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [SURNAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE] ALTER COLUMN [TAX_FILE_NO] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_ASR]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_ASR] ALTER COLUMN [HOME_TELEPHONE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_ASR] ALTER COLUMN [WORK_TELEPHONE_NUMBER] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [AMNT_PRIOR_LRN_CREDIT_USED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [EXTERNAL_SUBSIDISED_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [HE_PRIOR_LRN_CREDIT_PROVIDER] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [LOAN_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [PRIOR_FOE_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [PRIOR_LOE_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [PRIOR_STUDY_CREDIT_OFFERED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [STANDARD_SUBSIDY_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDISED_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_COMMITMENT_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS] ALTER COLUMN [SUBSIDY_EXPORT_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_FINANCIAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_FINANCIAL] ALTER COLUMN [STUDENT_FEE_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [CREDIT_ACHIEVED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [FUNDING_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_UNITS_SPECIAL] ALTER COLUMN [PLANNED_CREDIT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_PEOPLE_USI]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_PEOPLE_USI] ALTER COLUMN [CITY_OF_BIRTH] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_REGISTER_EVENT_DETAILS_SLOTS] ALTER COLUMN [AMOUNT_CLAIMED] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_SCHOOLS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [ADDRESS_LINE_1] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [ADDRESS_LINE_2] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [ADDRESS_LINE_3] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [ADDRESS_LINE_4] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [EMAIL_ADDRESS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [FULL_NAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [HEAD_SURNAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_SCHOOLS] ALTER COLUMN [TELEPHONE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [DEFAULT_VTO_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [MIN_CREDITS_REQUIRED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCE_OCCURRENCES] ALTER COLUMN [PAYMENT_DUE_DATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_UNIT_INSTANCES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [ACCREDITATION_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [ACCREDITATION_TYPE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [ACCREDITED_HOURS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [ACCREDITED_UNITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [CATS_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [MIN_CREDITS_REQUIRED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [UNIT_CURRENCY_MONTHS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [UNIT_CURRENCY_YEARS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_UNIT_INSTANCES] ALTER COLUMN [VTO_CODE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_USERS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_USERS] ALTER COLUMN [DIALINUSERNAME] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_USERS] ALTER COLUMN [IPADDRESS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_USERS] ALTER COLUMN [PASS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_USERS] ALTER COLUMN [PASSEXPIRYDATE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_VISA_SUBCLASSES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_VISA_SUBCLASSES] ALTER COLUMN [VISA_CLASS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_VISA_SUBCLASSES] ALTER COLUMN [VISA_TYPE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_VISAS]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_VISAS] ALTER COLUMN [EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_VISAS] ALTER COLUMN [VISA_HOLDER_CODE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_VISAS] ALTER COLUMN [VISA_LABEL_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_VISAS] ALTER COLUMN [VISA_SUB_CLASS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_VISAS] ALTER COLUMN [VISA_TYPE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_WEB_CONFIG]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_WEB_CONFIG] ALTER COLUMN [AREA_CODE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0165_Z_READ_BATCHES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0165_Z_READ_BATCHES] ALTER COLUMN [BANKING_DEPOSIT_NO] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0165_Z_READ_BATCHES] ALTER COLUMN [BANKING_GROUP_ID] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[OneEBS_EBS_0900_UNIT_INSTANCES]...';


GO
ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [ACCREDITATION_EXPIRY_DATE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [ACCREDITATION_TYPE] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [ACCREDITED_HOURS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [ACCREDITED_UNITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [CATS_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [COURSE_CREDITS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [MIN_CREDITS_REQUIRED] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [UNIT_CURRENCY_MONTHS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [UNIT_CURRENCY_YEARS] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[OneEBS_EBS_0900_UNIT_INSTANCES] ALTER COLUMN [VTO_CODE] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[Prada_dbo_COURSE_ENROLMENTS]...';


GO
ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS] ALTER COLUMN [PASSTOT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS] ALTER COLUMN [SS_STANDARD_SUBSIDY_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS] ALTER COLUMN [SS_SUBSIDY_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[Prada_dbo_COURSE_ENROLMENTS_FINALS]...';


GO
ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS_FINALS] ALTER COLUMN [PASSTOT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS_FINALS] ALTER COLUMN [SS_STANDARD_SUBSIDY_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[Prada_dbo_COURSE_ENROLMENTS_FINALS] ALTER COLUMN [SS_SUBSIDY_AMOUNT] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[reference_date]...';


GO
ALTER TABLE [edw].[reference_date] ALTER COLUMN [DateFullName] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[reference_funding_source_sbi_rules]...';


GO
ALTER TABLE [edw].[reference_funding_source_sbi_rules] ALTER COLUMN [Rule1_FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[reference_funding_source_sbi_rules] ALTER COLUMN [Rule10_FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[reference_funding_source_sbi_rules] ALTER COLUMN [Rule2_FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[reference_funding_source_sbi_rules] ALTER COLUMN [Rule9_FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[reference_ts_nsw_fund_group]...';


GO
ALTER TABLE [edw].[reference_ts_nsw_fund_group] ALTER COLUMN [FundingSourceNationalID] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[UMD_FactUnenteredMarks]...';


GO
ALTER TABLE [edw].[UMD_FactUnenteredMarks] ALTER COLUMN [CId] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_FactUnenteredMarks] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_FactUnenteredMarks] ALTER COLUMN [LastName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_FactUnenteredMarks] ALTER COLUMN [TeacherADEmail] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_FactUnenteredMarks] ALTER COLUMN [TeacherADUserName] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[UMD_TempTeachersMarks]...';


GO
ALTER TABLE [edw].[UMD_TempTeachersMarks] ALTER COLUMN [cid] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_TempTeachersMarks] ALTER COLUMN [First_Name] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [edw].[UMD_TempTeachersMarks] ALTER COLUMN [Last_Name] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [edw].[VCPrexip_participant]...';


GO
ALTER TABLE [edw].[VCPrexip_participant] ALTER COLUMN [remote_address] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [tsEChecklist].[ChecklistActions]...';


GO
ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [DOB] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [LastName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActions] ALTER COLUMN [VTO] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Altering Table [tsEChecklist].[ChecklistActionsInvalidRecords]...';


GO
ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [DOB] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [FirstName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [LastName] ADD MASKED WITH (FUNCTION = 'default()');

ALTER TABLE [tsEChecklist].[ChecklistActionsInvalidRecords] ALTER COLUMN [VTO] ADD MASKED WITH (FUNCTION = 'default()');


GO
PRINT N'Refreshing View [Avetmiss].[CourseEnrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[Avetmiss].[CourseEnrolment]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissCourse]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissCourse]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissCourseOffering]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissCourseOffering]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissCurrentCourseMapping]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissCurrentCourseMapping]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissLocation]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissLocation]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissStudent]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissStudent]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitStudent]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitStudent]';


GO
PRINT N'Refreshing View [ISDP].[Actuals_By_Course_Region_CommencementSemester]...';


GO
EXECUTE sp_refreshsqlmodule N'[ISDP].[Actuals_By_Course_Region_CommencementSemester]';


GO
PRINT N'Refreshing View [RevRec].[Course]...';


GO
EXECUTE sp_refreshsqlmodule N'[RevRec].[Course]';


GO
PRINT N'Refreshing View [RevRec].[CourseOffering]...';


GO
EXECUTE sp_refreshsqlmodule N'[RevRec].[CourseOffering]';


GO
PRINT N'Refreshing View [RevRec].[Enrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[RevRec].[Enrolment]';


GO
PRINT N'Refreshing View [RevRec].[Student]...';


GO
EXECUTE sp_refreshsqlmodule N'[RevRec].[Student]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitLocation]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitLocation]';


GO
PRINT N'Refreshing View [RevRec].[Location]...';


GO
EXECUTE sp_refreshsqlmodule N'[RevRec].[Location]';


GO
PRINT N'Refreshing View [Avetmiss].[PrimaryLearner]...';


GO
EXECUTE sp_refreshsqlmodule N'[Avetmiss].[PrimaryLearner]';


GO
PRINT N'Refreshing View [Avetmiss].[Student]...';


GO
EXECUTE sp_refreshsqlmodule N'[Avetmiss].[Student]';


GO
PRINT N'Refreshing View [Avetmiss].[UnitEnrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[Avetmiss].[UnitEnrolment]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnit]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnit]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitEnrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitEnrolment]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitOffering]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitOffering]';


GO
PRINT N'Refreshing View [EChecklist].[checklist_actions]...';


GO
EXECUTE sp_refreshsqlmodule N'[EChecklist].[checklist_actions]';


GO
PRINT N'Refreshing View [EChecklist].[EChecklistOfferingNewSummary]...';


GO
EXECUTE sp_refreshsqlmodule N'[EChecklist].[EChecklistOfferingNewSummary]';


GO
PRINT N'Refreshing View [OneEBS].[Addresses]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Addresses]';


GO
PRINT N'Refreshing View [OneEBS].[Attainments]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Attainments]';


GO
PRINT N'Refreshing View [OneEBS].[Awards]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Awards]';


GO
PRINT N'Refreshing View [OneEBS].[Course_Assessments]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Course_Assessments]';


GO
PRINT N'Refreshing View [OneEBS].[Fee_Categories]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fee_Categories]';


GO
PRINT N'Refreshing View [OneEBS].[Fee_Types]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fee_Types]';


GO
PRINT N'Refreshing View [OneEBS].[Fee_Values]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fee_Values]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List_Allocated]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List_Allocated]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List_Special]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List_Special]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List_Temp]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List_Temp]';


GO
PRINT N'Refreshing View [OneEBS].[Fees_List_Waivers]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Fees_List_Waivers]';


GO
PRINT N'Refreshing View [OneEBS].[Instalment_Plans]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Instalment_Plans]';


GO
PRINT N'Refreshing View [OneEBS].[Locations]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Locations]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissCourseEnrolment_ReprocessOldPrada]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissCourseEnrolment_ReprocessOldPrada]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitEnrolmentFinals]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitEnrolmentFinals]';


GO
PRINT N'Refreshing View [OneEBS].[Organisation_Units]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Organisation_Units]';


GO
PRINT N'Refreshing View [OneEBS].[People]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People]';


GO
PRINT N'Refreshing View [OneEBS].[People_ASR]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_ASR]';


GO
PRINT N'Refreshing View [OneEBS].[People_Units]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_Units]';


GO
PRINT N'Refreshing View [OneEBS].[People_Units_Financial]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_Units_Financial]';


GO
PRINT N'Refreshing View [OneEBS].[People_Units_Special]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_Units_Special]';


GO
PRINT N'Refreshing View [OneEBS].[People_USI]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[People_USI]';


GO
PRINT N'Refreshing View [OneEBS].[Register_Event_Details_Slots]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Register_Event_Details_Slots]';


GO
PRINT N'Refreshing View [OneEBS].[Schools]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Schools]';


GO
PRINT N'Refreshing View [OneEBS].[Unit_Instance_Occurrences]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Unit_Instance_Occurrences]';


GO
PRINT N'Refreshing View [OneEBS].[Users]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Users]';


GO
PRINT N'Refreshing View [OneEBS].[Visa_Subclasses]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Visa_Subclasses]';


GO
PRINT N'Refreshing View [OneEBS].[Visas]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Visas]';


GO
PRINT N'Refreshing View [OneEBS].[Web_Config]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Web_Config]';


GO
PRINT N'Refreshing View [OneEBS].[Z_Read_Batches]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Z_Read_Batches]';


GO
PRINT N'Refreshing View [OneEBS].[900_Unit_Instances]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[900_Unit_Instances]';


GO
PRINT N'Refreshing View [OneEBS].[Unit_Instances]...';


GO
EXECUTE sp_refreshsqlmodule N'[OneEBS].[Unit_Instances]';


GO
PRINT N'Refreshing View [reference].[Date]...';


GO
EXECUTE sp_refreshsqlmodule N'[reference].[Date]';


GO
PRINT N'Refreshing View [reference].[FundingSourceSbiRules]...';


GO
EXECUTE sp_refreshsqlmodule N'[reference].[FundingSourceSbiRules]';


GO
PRINT N'Refreshing View [reference].[TsNswFundGroup]...';


GO
EXECUTE sp_refreshsqlmodule N'[reference].[TsNswFundGroup]';


GO
PRINT N'Refreshing View [reference].[FundingSourceExtended]...';


GO
EXECUTE sp_refreshsqlmodule N'[reference].[FundingSourceExtended]';


GO
PRINT N'Refreshing View [VCPexip].[VCParticipantDetail]...';


GO
EXECUTE sp_refreshsqlmodule N'[VCPexip].[VCParticipantDetail]';


GO
PRINT N'Refreshing View [EChecklist].[ChecklistActions]...';


GO
EXECUTE sp_refreshsqlmodule N'[EChecklist].[ChecklistActions]';


GO
PRINT N'Refreshing View [EChecklist].[EChecklistExceptionReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[EChecklist].[EChecklistExceptionReport]';


GO
PRINT N'Altering View [compliance].[vwAvetmissUnitReportingPeriod]...';


GO






ALTER view [compliance].[vwAvetmissUnitReportingPeriod] as

Select 2018 as REPORT_DATE, 2018 as [Report Date], 2018 as [Report Year], 2018 as [Extract Date], 20171 as [Week Last Year], 'Previous Week 2018 - 2018' as [Current Week], NULL as [Current Week Flag] UNION ALL 
Select '2019', '2019', '2019', '2019', '2018', 'Previous Week 2019 - 2019', NULL UNION ALL 
Select '20161', '20161', '2016', '2016', NULL, 'Final Week 2016', NULL UNION ALL 
Select '20171', '20171', '2017', '20171', '2016', 'Previous Week 2017 - 20171', NULL UNION ALL 
Select '20150124', '20150124', '2015', '20160124', NULL, 'Previous Week 2015 - 20160124', NULL UNION ALL 
Select '20150131', '20150131', '2015', '20160131', NULL, 'Previous Week 2015 - 20160131', NULL UNION ALL 
Select '20150221', '20150221', '2015', '20160221', NULL, 'Previous Week 2015 - 20160221', NULL UNION ALL 
Select '20160108', '20160108', '2016', '20170108', '20160110', 'Previous Week 2016 - 20170108', NULL UNION ALL 
Select '20160115', '20160115', '2016', '20170115', NULL, 'Previous Week 2016 - 20170115', NULL UNION ALL 
Select '20160122', '20160122', '2016', '20170122', '20150124', 'Previous Week 2016 - 20170122', NULL UNION ALL 
Select '20160129', '20160129', '2016', '20170129', '20150131', 'Previous Week 2016 - 20170129', NULL UNION ALL 
Select '20160205', '20160205', '2016', '20170205', NULL, 'Previous Week 2016 - 20170205', NULL UNION ALL 
Select '20160212', '20160212', '2016', '20170212', '20150214', 'Previous Week 2016 - 20170212', NULL UNION ALL 
Select '20160219', '20160219', '2016', '20170219', '20150221', 'Previous Week 2016 - 20170219', NULL UNION ALL 
Select '20160306', '20160306', '2016', '20160306', '20150308', 'Previous Week 2016 - 20160306', NULL UNION ALL 
Select '20160313', '20160313', '2016', '20160313', '20150315', 'Previous Week 2016 - 20160313', NULL UNION ALL 
Select '20160320', '20160320', '2016', '20160320', '20150322', 'Previous Week 2016 - 20160320', NULL UNION ALL 
Select '20160327', '20160327', '2016', '20160327', '20150329', 'Previous Week 2016 - 20160327', NULL UNION ALL 
Select '20160403', '20160403', '2016', '20160403', '20150405', 'Previous Week 2016 - 20160403', NULL UNION ALL 
Select '20160410', '20160410', '2016', '20160410', '20150412', 'Previous Week 2016 - 20160410', NULL UNION ALL 
Select '20160417', '20160417', '2016', '20160417', '20150419', 'Previous Week 2016 - 20160417', NULL UNION ALL 
Select '20160424', '20160424', '2016', '20160424', '20150426', 'Previous Week 2016 - 20160424', NULL UNION ALL 
Select '20160501', '20160501', '2016', '20160501', '20150510', 'Previous Week 2016 - 20160501', NULL UNION ALL 
Select '20160508', '20160508', '2016', '20160508', '20150510', 'Previous Week 2016 - 20160508', NULL UNION ALL 
Select '20160605', '20160605', '2016', '20160605', '20150607', 'Previous Week 2016 - 20160605', NULL UNION ALL 
Select '20160703', '20160703', '2016', '20160703', '20160705', 'Previous Week 2016 - 20160703', NULL UNION ALL 
Select '20160807', '20160807', '2016', '20160807', '20150809', 'Previous Week 2016 - 20160807', NULL UNION ALL 
Select '20160904', '20160904', '2016', '20160904', '20150906', 'Previous Week 2016 - 20160904', NULL UNION ALL 
Select '20161002', '20161002', '2016', '20161002', '20151004', 'Previous Week 2016 - 20161002', NULL UNION ALL 
Select '20161106', '20161106', '2016', '20161106', '20151108', 'Previous Week 2016 - 20161106', NULL UNION ALL 
Select '20161204', '20161204', '2016', '20161204', '20151206', 'Previous Week 2016 - 20161204', NULL UNION ALL 
Select '20161211', '20161211', '2016', '20161211', '20151213', 'Previous Week 2016 - 20161211', NULL UNION ALL 
Select '20161218', '20161218', '2016', '20161218', '20160103', 'Previous Week 2016 - 20161218', NULL UNION ALL 
Select '20170107', '20170107', '2017', '20180107', '20160108', 'Previous Week 2017 - 20180107', NULL UNION ALL 
Select '20170108', '20170108', '2017', '20170108', '20160110', 'Previous Week 2017 - 20170108', NULL UNION ALL 
Select '20170115', '20170115', '2017', '20170115', '20160117', 'Previous Week 2017 - 20170115', NULL UNION ALL 
Select '20170122', '20170122', '2017', '20170122', '20160124', 'Previous Week 2017 - 20170122', NULL UNION ALL 
Select '20170129', '20170129', '2017', '20170129', '20160130', 'Previous Week 2017 - 20170129', NULL UNION ALL 
Select '20170204', '20170204', '2017', '20180204', '20160205', 'Previous Week 2017 - 20180204', NULL UNION ALL 
Select '20170205', '20170205', '2017', '20170205', '20160207', 'Previous Week 2017 - 20170205', NULL UNION ALL 
Select '20170212', '20170212', '2017', '20170212', '20160214', 'Previous Week 2017 - 20170212', NULL UNION ALL 
Select '20170219', '20170219', '2017', '20170219', '20160221', 'Previous Week 2017 - 20170219', NULL UNION ALL 
Select '20170226', '20170226', '2017', '20170226', '20160228', 'Previous Week 2017 - 20170226', NULL UNION ALL 
Select '20170305', '20170305', '2017', '20170305', '20160306', 'Previous Week 2017 - 20170305', NULL UNION ALL 
Select '20170312', '20170312', '2017', '20170312', '20160313', 'Previous Week 2017 - 20170312', NULL UNION ALL 
Select '20170319', '20170319', '2017', '20170319', '20160320', 'Previous Week 2017 - 20170319', NULL UNION ALL 
Select '20170326', '20170326', '2017', '20170326', '20160327', 'Previous Week 2017 - 20170326', NULL UNION ALL 
Select '20170402', '20170402', '2017', '20170402', '20160403', 'Previous Week 2017 - 20170402', NULL UNION ALL 
Select '20170409', '20170409', '2017', '20170409', '20160410', 'Previous Week 2017 - 20170409', NULL UNION ALL 
Select '20170416', '20170416', '2017', '20170416', '20160417', 'Previous Week 2017 - 20170416', NULL UNION ALL 
Select '20170423', '20170423', '2017', '20170423', '20160424', 'Previous Week 2017 - 20170423', NULL UNION ALL 
Select '20170430', '20170430', '2017', '20170430', '20160501', 'Previous Week 2017 - 20170430', NULL UNION ALL 
Select '20170507', '20170507', '2017', '20170507', '20160508', 'Previous Week 2017 - 20170507', NULL UNION ALL 
Select '20170604', '20170604', '2017', '20170604', '20160605', 'Previous Week 2017 - 20170604', NULL UNION ALL 
Select '20170702', '20170702', '2017', '20170702', '20160703', 'Previous Week 2017 - 20170702', NULL UNION ALL 
Select '20170806', '20170806', '2017', '20170806', '20160807', 'Previous Week 2017 - 20170806', NULL UNION ALL 
Select '20170903', '20170903', '2017', '20170903', '20160904', 'Previous Week 2017 - 20170903', NULL UNION ALL 
Select '20171001', '20171001', '2017', '20171001', '20161002', 'Previous Week 2017 - 20171001', NULL UNION ALL 
Select '20171105', '20171105', '2017', '20171105', '20161106', 'Previous Week 2017 - 20171105', NULL UNION ALL 
Select '20171203', '20171203', '2017', '20171203', '20161204', 'Previous Week 2017 - 20171203', NULL UNION ALL 
Select '20180106', '20180106', '2018', '20190106', '20170107', 'Previous Week 2018 - 20190106', NULL UNION ALL 
Select '20180107', '20180107', '2018', '20180107', '20170108', 'Previous Week 2018 - 20180107', NULL UNION ALL 
Select '20180203', '20180203', '2018', '20190203', '20170204', 'Previous Week 2018 - 20190203', NULL UNION ALL 
Select '20180204', '20180204', '2018', '20180204', '20170205', 'Previous Week 2018 - 20180204', NULL UNION ALL 
Select '20180304', '20180304', '2018', '20180304', '20170305', 'Previous Week 2018 - 20180304', NULL UNION ALL 
Select '20180401', '20180401', '2018', '20180401', '20170402', 'Previous Week 2018 - 20180401', NULL UNION ALL 
Select '20180506', '20180506', '2018', '20180506', '20170507', 'Previous Week 2018 - 20180506', NULL UNION ALL 
Select '20180603', '20180603', '2018', '20180603', '20170604', 'Previous Week 2018 - 20180603', NULL UNION ALL 
Select '20180701', '20180701', '2018', '20180701', '20170702', 'Previous Week 2018 - 20180701', NULL UNION ALL 
Select '20180729', '20180729', '2018', '20180729', '20170730', 'Previous Week 2018 - 20180729', NULL UNION ALL 
Select '20180805', '20180805', '2018', '20180805', '20170806', 'Previous Week 2018 - 20180805', NULL UNION ALL 
Select '20180902', '20180902', '2018', '20180902', '20170903', 'Previous Week 2018 - 20180902', NULL UNION ALL 
Select '20180930', '20180930', '2018', '20180930', '20171001', 'Previous Week 2018 - 20180930', NULL UNION ALL 
Select '20181007', '20181007', '2018', '20181007', '20171008', 'Previous Week 2018 - 20181007', NULL UNION ALL 
Select '20181104', '20181104', '2018', '20181104', '20171105', 'Previous Week 2018 - 20181104', NULL UNION ALL 
Select '20181202', '20181202', '2018', '20181202', '20171203', 'Previous Week 2018 - 20181202', NULL UNION ALL 
Select '20190105', '20190105', '2019', '20200105', '20180106', 'Previous Week 2019 - 20200105', NULL UNION ALL 
Select '20190106', '20190106', '2019', '20190106', '20180107', 'Previous Week 2019 - 20190106', NULL UNION ALL 
Select '20190202', '20190202', '2019', '20200202', '20180203', 'Previous Week 2019 - 20200202', NULL UNION ALL 
Select '20190203', '20190203', '2019', '20190203', '20180204', 'Previous Week 2019 - 20190203', NULL UNION ALL 
Select '20190303', '20190303', '2019', '20190303', '20180304', 'Previous Week 2019 - 20190303', NULL UNION ALL 
Select '20190407', '20190407', '2019', '20190407', '20180408', 'Previous Week 2019 - 20190407', NULL UNION ALL 
Select '20190505', '20190505', '2019', '20190505', '20180506', 'Previous Week 2019 - 20190505', NULL UNION ALL 
Select '20190602', '20190602', '2019', '20190602', '20180603', 'Previous Week 2019 - 20190602', NULL UNION ALL 
Select '20190707', '20190707', '2019', '20190707', '20180708', 'Previous Week 2019 - 20190707', NULL UNION ALL 
Select '20190804', '20190804', '2019', '20190804', '20180805', 'Previous Week 2019 - 20190804', NULL UNION ALL 
Select '20190901', '20190901', '2019', '20190901', '20180902', 'Previous Week 2019 - 20190901', NULL UNION ALL 
Select '20191006', '20191006', '2019', '20191006', '20181007', 'Previous Week 2019 - 20191006', NULL UNION ALL 
Select '20191103', '20191103', '2019', '20191103', '20181104', 'Previous Week 2019 - 20191103', NULL UNION ALL 
Select '20191201', '20191201', '2019', '20191201', '20181202', 'Previous Week 2019 - 20191201', NULL UNION ALL 
Select '20200105', '20200105', '2020', '20200105', '20190106', 'Previous Week 2020 - 20200105', NULL UNION ALL 
Select '20200202', '20200202', '2020', '20200202', '20190203', 'Previous Week 2020 - 20200202', NULL UNION ALL 
Select '20200301', '20200301', '2020', '20200301', '20190303', 'Previous Week 2020 - 20200301', NULL UNION ALL 
Select '20200405', '20200405', '2020', '20200405', '20190407', 'Previous Week 2020 - 20200405', NULL UNION ALL 
Select '20200503', '20200503', '2020', '20200503', '20190505', 'Previous Week 2020 - 20200503', NULL UNION ALL 
Select '20200607', '20200607', '2020', '20200607', '20190609', 'Previous Week 2020 - 20200607', NULL UNION ALL 
Select '20200705', '20200705', '2020', '20200705', '20190707', 'Previous Week 2020 - 20200705', NULL UNION ALL 
Select '20200726', '20200726', '2020', '20200726', '20190804', 'Current Week 2020 - 20200726', NULL


/*
	SELECT 
		--REPORT_DATE,
 ReportingPeriodKey as REPORT_DATE

		--REPORT_DATE as 'Report Date',
,ReportingPeriodKey as 'Report Date'
		
		--REPORTING_YEAR as 'Report Year', 
,cast(ReportingYearNo as varchar(12)) as 'Report Year'
		--EXTRACT_DATE as 'Extract Date', 
,convert(varchar(10), ReportingDate, 112) as 'Extract Date'
		--WEEK_LAST_YEAR as 'Week Last Year', 
,convert(varchar(10), ReportingPeriodKeyLastYear, 112) as 'Week Last Year' 
		--CASE
		--	WHEN EXTRACT_DATE = (SELECT max(convert(varchar(10), cast(EXTRACT_DATE as varchar(10)), 102)) 
		--						FROM REPORT_DATE)
		--	THEN 'Current Week ' + cast(REPORTING_YEAR as varchar(4))
		--	ELSE 'Previous Week ' + cast(REPORTING_YEAR as varchar(4)) + ' - ' + cast(EXTRACT_DATE as varchar(10)) 
		--END AS 'Current Week' ,
,CASE
WHEN ReportingDate = (SELECT max(ReportingDate) FROM compliance.AvetmissReportingPeriod rp where left(ReportingYear, 2) = 'CY' and rp.ReportingDate <= getdate())
	THEN 'Current Week ' + cast(ReportingYearNo as varchar(4))
WHEN ReportingPeriodKey = (SELECT max(ReportingPeriodKeyLastYear)
						from compliance.AvetmissReportingPeriod
						WHERE left(ReportingYear, 2) = 'CY'
						and ReportingDate = (SELECT max(ReportingDate) FROM compliance.AvetmissReportingPeriod rp where left(reportingyear, 2) = 'CY' and rp.ReportingDate <= getdate()))
	THEN 'Current Week Last Year ' + cast(ReportingYearNo as varchar(4))
WHEN ReportingDate = (SELECT max(dateadd(week, -1, ReportingDate))
						from compliance.AvetmissReportingPeriod
						WHERE left(ReportingYear, 2) = 'CY'
						and ReportingDate = (SELECT max(ReportingDate) FROM compliance.AvetmissReportingPeriod rp where left(reportingyear, 2) = 'CY' and rp.ReportingDate <= getdate()))
	THEN 'Current Week Last Week CY ' + cast(ReportingYearNo as varchar(4))
ELSE 'Previous Week ' + cast(ReportingYearNo as varchar(4)) + ' - ' + cast(ReportingPeriodKey as varchar(8)) 
	END AS 'Current Week'


		--CASE
		--	WHEN EXTRACT_DATE = (SELECT max(convert(varchar(10), cast(EXTRACT_DATE as varchar(10)), 102)) 
		--						FROM REPORT_DATE)
		--	THEN 1
		--	ELSE null
		--END AS 'Current Week Flag'

--Note this  'Current Week Flag' only produces null when run on the old enrolment DB. Need to see ig it is a requirement
,NULL AS 'Current Week Flag'


	--FROM REPORT_DATE


from compliance.AvetmissReportingPeriod rp
where left(ReportingYear, 2) = 'CY' 
and rp.ReportingDate <= '2020-07-26'


--Re-Add this once vwUnit_UnitEnrolments is complete
--	WHERE REPORT_DATE IN (SELECT distinct REPORT_DATE FROM Unit.vwUnit_UnitEnrolments)


	UNION 
	SELECT 
	'20161' as REPORT_DATE,
	'20161' as 'Report Date', 
	'2016' as 'Reporting Year', 
	'2016' as 'Extract Date',
	NULL as 'Week Last Year', 
	'Final Week 2016' as 'Current Week', 
	NULL as 'Current Week Flag'
	
	--from REPORT_DATE 
--Removed the from in the Union as is is not needed. 

		










*/
GO
PRINT N'Refreshing View [compliance].[vwAvetmissCourseEnrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissCourseEnrolment]';


GO
PRINT N'Refreshing View [compliance].[vwAvetmissUnitCourseEnrolment]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[vwAvetmissUnitCourseEnrolment]';


GO
PRINT N'Refreshing Procedure [UMD].[USP_RefreshUMDDataModel]...';


GO
EXECUTE sp_refreshsqlmodule N'[UMD].[USP_RefreshUMDDataModel]';


GO
PRINT N'Refreshing Procedure [compliance].[PopulateAvetmissFeeRecord]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[PopulateAvetmissFeeRecord]';


GO
PRINT N'Refreshing Procedure [compliance].[PopulatePeopleUnitLinks]...';


GO
EXECUTE sp_refreshsqlmodule N'[compliance].[PopulatePeopleUnitLinks]';


GO
--This SP will drop any masking from the Production environment.
EXEC dbo.spDropAllMasking
GO

GO
PRINT N'Update complete.';


GO
