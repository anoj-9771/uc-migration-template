{
	"name": "SQL script_Grant_Access",
	"properties": {
		"content": {
			"query": "----------Sample--------\n\n--  CREATE USER [bob@contoso.com] FROM EXTERNAL PROVIDER;\n--  CREATE USER [alice@fabrikam.onmicrosoft.com] FROM EXTERNAL PROVIDER;\n\n--  CREATE USER [ad group] FROM EXTERNAL PROVIDER;\n-- GO\n \n-- -- add user to role(s) in db \n-- EXEC sp_addrolemember 'db_datareader' , ' ad group '\n-- EXEC sp_addrolemember 'db_datawriter' , ' ad group '\n\n--------------------------------------\n\n\n\nCREATE USER [oyae@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'oyae@sydneywater.com.au'\n\nCREATE USER [otob@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'otob@sydneywater.com.au'\n\nCREATE USER [oydm@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'oydm@sydneywater.com.au'\n\nCREATE USER [opd4@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'opd4@sydneywater.com.au'\n\n\nCREATE USER [ozqc@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'ozqc@sydneywater.com.au'\n\nCREATE USER [oq5s@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'oq5s@sydneywater.com.au'\n\nCREATE USER [oe3y@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'oe3y@sydneywater.com.au'\n\nCREATE USER [e3y@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'e3y@sydneywater.com.au'\n\nCREATE USER [y2o@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'y2o@sydneywater.com.au'\n-------- Add AD Groups-------------------------\nCREATE USER [A-Azure-DAF Databricks and Synapse Users DEV] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'A-Azure-DAF Databricks and Synapse Users DEV'\nEXEC sp_addrolemember 'db_datawriter' , 'A-Azure-DAF Databricks and Synapse Users DEV'\n\n--Preprod\nCREATE USER [A-Azure-rg-swcprod01-preprod-daf-01-DataAdmin] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'A-Azure-rg-swcprod01-preprod-daf-01-DataAdmin'\nCREATE USER [A-Azure-rg-swcprod01-preprod-daf-01-DataDeveloper] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'A-Azure-rg-swcprod01-preprod-daf-01-DataDeveloper'\nCREATE USER [A-Azure-rg-swcprod01-preprod-daf-01-DataAnalystStdUsr] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'A-Azure-rg-swcprod01-preprod-daf-01-DataAnalystStdUsr'\nCREATE USER [A-Azure-rg-swcprod01-preprod-daf-01-DataAnalystAdvUsr] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'A-Azure-rg-swcprod01-preprod-daf-01-DataAnalystAdvUsrr'\n--Prod\nCREATE USER [A-Azure-rg-swcprod01-prod-daf-01-DataAdmin] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'A-Azure-rg-swcprod01-prod-daf-01-DataAdmin'\nCREATE USER [A-Azure-rg-swcprod01-prod-daf-01-DataDeveloper] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_owner' , 'A-Azure-rg-swcprod01-prod-daf-01-DataDeveloper'\nCREATE USER [A-Azure-rg-swcprod01-prod-daf-01-DataAnalystStdUsr] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'A-Azure-rg-swcprod01-prod-daf-01-DataAnalystStdUsr'\nCREATE USER [A-Azure-rg-swcprod01-prod-daf-01-DataAnalystAdvUsr] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'A-Azure-rg-swcprod01-prod-daf-01-DataAnalystAdvUsr'\n\n\n\nCREATE USER [ub0@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'ub0@sydneywater.com.au'\nEXEC sp_addrolemember 'db_datawriter' , 'ub0@sydneywater.com.au'\n\nCREATE USER [ub0@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'ub0@sydneywater.com.au'\nEXEC sp_addrolemember 'db_datawriter' , 'ub0@sydneywater.com.au'\n\nCREATE USER [yce@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'yce@sydneywater.com.au'\nEXEC sp_addrolemember 'db_datawriter' , 'yce@sydneywater.com.au'\n\nCREATE USER [enl@sydneywater.com.au] FROM EXTERNAL PROVIDER;\nEXEC sp_addrolemember 'db_datareader' , 'enl@sydneywater.com.au'\nEXEC sp_addrolemember 'db_datawriter' , 'enl@sydneywater.com.au'\n \n\n\n\n--Create SQL Atuthentication user------\n--Create SQL Server Login in the Master Database\n--USE MASTER\nCREATE LOGIN svc_synapse1 WITH PASSWORD = 'add password';\n--Create User in the desired Data Warehouse\nCREATE USER svc_synapse1 FROM LOGIN svc_synapse1;\n--Assign User to the desired role in the Data Warehouse\nEXEC sp_addrolemember 'db_owner', 'svc_synapse1'\n\nCREATE LOGIN svc_collibra WITH PASSWORD = 'add password'; -- in master DB\n--Create User in the desired Data Warehouse\nCREATE USER svc_collibra FROM LOGIN svc_collibra;\n--Assign User to the desired role in the Data Warehouse\nEXEC sp_addrolemember 'db_datareader', 'svc_collibra'\n\n\n--Serverless\n\n-- To grant access to a user to a single serverless SQL database, follow the steps in this example:\n\n-- Create LOGIN\n\n-- use master\n-- go\n-- CREATE LOGIN [alias@domain.com] FROM EXTERNAL PROVIDER;\n-- go\n\n-- Create USER\n\n-- use yourdb -- Use your database name\n-- go\n-- CREATE USER alias FROM LOGIN [alias@domain.com];\n\n-- Add USER to members of the specified role\n\n-- use yourdb -- Use your database name\n-- go\n-- alter role db_owner Add member alias -- Type USER name from step 2\n\n-- Workspace-scoped permission\n-- To grant full access to all serverless SQL pools in the workspace, use the script in this example:\n\n-- use master\n-- go\n-- CREATE LOGIN [alias@domain.com] FROM EXTERNAL PROVIDER;\n-- ALTER SERVER ROLE sysadmin ADD MEMBER [alias@domain.com];\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "syndwdev01",
				"poolName": "syndwdev01"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}